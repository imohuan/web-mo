import{c as x,o as v,a as c,d as me,r as D,b as G,e as Qe,f as sn,g as H,h as Q,t as de,n as te,u as I,T as Fl,w as Hl,F as Re,i as Te,j as Ke,k as ql,l as Ul,m as Gt,p as Xo,q as Wl,s as zl,v as Vl,x as St,y as Rs,z as Ve,A as At,B as Jt,C as fs,D as Rt,E as Go,G as Jl,H as Hr,I as Kl,J as Ql,K as Xl,L as Gl}from"./vendor-BKss3er8.js";import{l as Le,e as et,m as Yl,U as Zl,K as qr,a as Ur}from"./monaco-B_-qTA8n.js";import{d as ps,a as hs,H as Wr}from"./utils-MLaGY8ml.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const eu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function tu(e,t){return v(),x("svg",eu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 9-7 7-7-7"},null,-1)])])}const er={render:tu},nu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function su(e,t){return v(),x("svg",nu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m5 13 4 4L19 7"},null,-1)])])}const ru={render:su},ou={class:"relative"},iu={class:"flex-1 text-left"},au={class:"text-sm font-medium text-gray-900"},lu={key:0,class:"absolute top-full left-0 mt-2 w-[300px] bg-white border border-gray-200 rounded-xl shadow-lg z-50 py-2"},uu={class:"max-h-80 overflow-y-auto"},cu=["onClick"],du={class:"flex-1"},fu={class:"flex items-center gap-2"},pu={class:"text-sm font-medium text-gray-900"},hu={class:"text-xs text-gray-500 mt-1"},mu={class:"flex items-center gap-2"},gu={key:0,class:"w-4 h-4 text-blue-500"},bu=me({__name:"ModelSelector",props:{modelValue:{},models:{default:()=>[]}},emits:["update:modelValue","model-change"],setup(e,{emit:t}){const n=e,s=t,r=D(!1),o=[{label:"2.5 Flash",value:"gemini-2.5-flash",description:"快速提供分析的帮助"},{label:"2.5 Pro",value:"gemini-2.5-pro",description:"推理、数学和编程"}],i=G(()=>n.models.length>0?n.models:o),a=G(()=>i.value.find(h=>h.value===n.modelValue)||i.value[0]||{label:"2.5 Flash",description:"快速提供分析的帮助",value:"gemini-2.5-flash"}),l=()=>{r.value=!r.value},u=()=>{r.value=!1},f=b=>{s("update:modelValue",b),s("model-change",b),u()},d=b=>{b.key==="Escape"&&r.value&&u()};return Qe(()=>{document.addEventListener("keydown",d)}),sn(()=>{document.removeEventListener("keydown",d)}),(b,h)=>(v(),x("div",ou,[c("button",{onClick:l,class:"flex items-center gap-3 px-4 py-3 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors shadow-sm"},[c("div",iu,[c("div",au,de(a.value.label),1)]),c("div",{class:te(["w-4 h-4 text-gray-400 transition-transform",{"rotate-180":r.value}])},[H(I(er),{class:"w-4 h-4"})],2)]),H(Fl,{"enter-active-class":"transition ease-out duration-200","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition ease-in duration-150","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:Hl(()=>[r.value?(v(),x("div",lu,[h[0]||(h[0]=c("div",{class:"px-4 py-2 text-sm font-medium text-gray-700 border-b border-gray-100"}," 选择模型 ",-1)),c("div",uu,[(v(!0),x(Re,null,Te(i.value,_=>(v(),x("div",{key:_.value,onClick:g=>f(_.value),class:te(["px-4 py-3 hover:bg-gray-50 cursor-pointer flex items-center justify-between group",{"bg-blue-50":n.modelValue===_.value}])},[c("div",du,[c("div",fu,[c("span",pu,de(_.label),1)]),c("div",hu,de(_.description),1)]),c("div",mu,[n.modelValue===_.value?(v(),x("div",gu,[H(I(ru),{class:"w-4 h-4 text-blue-500"})])):Q("",!0)])],10,cu))),128))])])):Q("",!0)]),_:1}),r.value?(v(),x("div",{key:0,onClick:u,class:"fixed inset-0 z-40"})):Q("",!0)]))}});function yu(e){return ql()?(Ul(e),!0):!1}const vu=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const wu=Object.prototype.toString,xu=e=>wu.call(e)==="[object Object]",_u=()=>{};function ku(...e){if(e.length!==1)return Wl(...e);const t=e[0];return typeof t=="function"?Xo(zl(()=>({get:t,set:_u}))):D(t)}function Cu(e,t){function n(...s){return new Promise((r,o)=>{Promise.resolve(e(()=>t.apply(this,s),{fn:t,thisArg:this,args:s})).then(r).catch(o)})}return n}const Yo=e=>e();function $u(e=Yo,t={}){const{initialState:n="active"}=t,s=ku(n==="active");function r(){s.value=!1}function o(){s.value=!0}const i=(...a)=>{s.value&&e(...a)};return{isActive:Xo(s),pause:r,resume:o,eventFilter:i}}function ms(e){return Array.isArray(e)?e:[e]}function Su(e){return Vl()}function Au(e,t,n={}){const{eventFilter:s=Yo,...r}=n;return Ke(e,Cu(s,t),r)}function Iu(e,t,n={}){const{eventFilter:s,initialState:r="active",...o}=n,{eventFilter:i,pause:a,resume:l,isActive:u}=$u(s,{initialState:r});return{stop:Au(e,t,{...o,eventFilter:i}),pause:a,resume:l,isActive:u}}function Mu(e,t=!0,n){Su()?Qe(e,n):t?e():Gt(e)}function Eu(e,t,n){return Ke(e,t,{...n,immediate:!0})}const Rn=vu?window:void 0;function Ru(e){var t;const n=St(e);return(t=n?.$el)!=null?t:n}function Ts(...e){const t=[],n=()=>{t.forEach(a=>a()),t.length=0},s=(a,l,u,f)=>(a.addEventListener(l,u,f),()=>a.removeEventListener(l,u,f)),r=G(()=>{const a=ms(St(e[0])).filter(l=>l!=null);return a.every(l=>typeof l!="string")?a:void 0}),o=Eu(()=>{var a,l;return[(l=(a=r.value)==null?void 0:a.map(u=>Ru(u)))!=null?l:[Rn].filter(u=>u!=null),ms(St(r.value?e[1]:e[0])),ms(I(r.value?e[2]:e[1])),St(r.value?e[3]:e[2])]},([a,l,u,f])=>{if(n(),!a?.length||!l?.length||!u?.length)return;const d=xu(f)?{...f}:f;t.push(...a.flatMap(b=>l.flatMap(h=>u.map(_=>s(b,h,_,d)))))},{flush:"post"}),i=()=>{o(),n()};return yu(n),i}const un=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},cn="__vueuse_ssr_handlers__",Tu=Ou();function Ou(){return cn in un||(un[cn]=un[cn]||{}),un[cn]}function Pu(e,t){return Tu[e]||t}function Lu(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const Du={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},zr="vueuse-storage";function ju(e,t,n,s={}){var r;const{flush:o="pre",deep:i=!0,listenToStorageChanges:a=!0,writeDefaults:l=!0,mergeDefaults:u=!1,shallow:f,window:d=Rn,eventFilter:b,onError:h=O=>{console.error(O)},initOnMounted:_}=s,g=(f?Rs:D)(typeof t=="function"?t():t),A=G(()=>St(e));if(!n)try{n=Pu("getDefaultStorage",()=>{var O;return(O=Rn)==null?void 0:O.localStorage})()}catch(O){h(O)}if(!n)return g;const $=St(t),C=Lu($),z=(r=s.serializer)!=null?r:Du[C],{pause:Y,resume:ne}=Iu(g,O=>R(O),{flush:o,deep:i,eventFilter:b});Ke(A,()=>T(),{flush:o});let ae=!1;const J=O=>{_&&!ae||T(O)},ee=O=>{_&&!ae||Z(O)};d&&a&&(n instanceof Storage?Ts(d,"storage",J,{passive:!0}):Ts(d,zr,ee)),_?Mu(()=>{ae=!0,T()}):T();function se(O,j){if(d){const q={key:A.value,oldValue:O,newValue:j,storageArea:n};d.dispatchEvent(n instanceof Storage?new StorageEvent("storage",q):new CustomEvent(zr,{detail:q}))}}function R(O){try{const j=n.getItem(A.value);if(O==null)se(j,null),n.removeItem(A.value);else{const q=z.write(O);j!==q&&(n.setItem(A.value,q),se(j,q))}}catch(j){h(j)}}function S(O){const j=O?O.newValue:n.getItem(A.value);if(j==null)return l&&$!=null&&n.setItem(A.value,z.write($)),$;if(!O&&u){const q=z.read(j);return typeof u=="function"?u(q,$):C==="object"&&!Array.isArray(q)?{...$,...q}:q}else return typeof j!="string"?j:z.read(j)}function T(O){if(!(O&&O.storageArea!==n)){if(O&&O.key==null){g.value=$;return}if(!(O&&O.key!==A.value)){Y();try{const j=z.write(g.value);(O===void 0||O?.newValue!==j)&&(g.value=S(O))}catch(j){h(j)}finally{O?Gt(ne):ne()}}}}function Z(O){T(O.detail)}return g}function Yt(e,t,n={}){const{window:s=Rn}=n;return ju(e,t,s?.localStorage,n)}const Nu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"w-4 h-4",viewBox:"0 0 24 24"};function Bu(e,t){return v(),x("svg",Nu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18 18 6M6 6l12 12"},null,-1)])])}const Tt={render:Bu},Fu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Hu(e,t){return v(),x("svg",Fu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0"},null,-1)])])}const Tn={render:Hu},qu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Uu(e,t){return v(),x("svg",qu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0-3-3m3 3 3-3m2 8H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5.586a1 1 0 0 1 .707.293l5.414 5.414a1 1 0 0 1 .293.707V19a2 2 0 0 1-2 2"},null,-1)])])}const Wu={render:Uu},zu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Vu(e,t){return v(),x("svg",zu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 0 1-.88-7.903A5 5 0 1 1 15.9 6h.1a5 5 0 0 1 1 9.9M9 19l3 3m0 0 3-3m-3 3V10"},null,-1)])])}const Ju={render:Vu},Ku={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Qu(e,t){return v(),x("svg",Ku,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"},null,-1)])])}const Xu={render:Qu},Gu={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",class:"w-4 h-4",viewBox:"0 0 24 24"};function Yu(e,t){return v(),x("svg",Gu,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 5H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1M8 5a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2M8 5a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2m0 0h2a2 2 0 0 1 2 2v3m2 4H10m0 0 3-3m-3 3 3 3"},null,-1)])])}const Zu={render:Yu},ec={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function tc(e,t){return v(),x("svg",ec,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-5m-1.414-9.414a2 2 0 1 1 2.828 2.828L11.828 15H9v-2.828z"},null,-1)])])}const nc={render:tc},sc={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function rc(e,t){return v(),x("svg",sc,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 7-.867 12.142A2 2 0 0 1 16.138 21H7.862a2 2 0 0 1-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v3M4 7h16"},null,-1)])])}const Vr={render:rc},oc={class:"space-y-2"},ic={key:0,class:"space-y-2"},ac={class:"relative"},lc=["type","value","placeholder","required"],uc={key:0,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},cc={key:1,class:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},dc={key:1,class:"space-y-2"},fc=["value","placeholder","required"],pc={key:2,class:"space-y-2"},hc=["value","required"],mc=["value"],gc={key:3,class:"flex items-center justify-end"},bc=me({__name:"BasicConfigItem",props:{config:{},value:{}},emits:["update"],setup(e){const t=e,n=D(!1),s=G(()=>t.config.key.toLowerCase().includes("key")||t.config.key.toLowerCase().includes("password"));return(r,o)=>(v(),x("div",oc,[r.config.type==="input"?(v(),x("div",ic,[c("div",ac,[c("input",{type:s.value&&!n.value?"password":"text",value:r.value,onInput:o[0]||(o[0]=i=>r.$emit("update",i.target.value)),placeholder:r.config.placeholder,required:r.config.required,class:te(["w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",s.value?"pr-10":""])},null,42,lc),s.value?(v(),x("button",{key:0,type:"button",onClick:o[1]||(o[1]=i=>n.value=!n.value),class:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600"},[n.value?(v(),x("svg",uc,[...o[5]||(o[5]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"},null,-1)])])):(v(),x("svg",cc,[...o[6]||(o[6]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"},null,-1),c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"},null,-1)])]))])):Q("",!0)])])):r.config.type==="textarea"?(v(),x("div",dc,[c("textarea",{value:r.value,onInput:o[2]||(o[2]=i=>r.$emit("update",i.target.value)),placeholder:r.config.placeholder,required:r.config.required,rows:"4",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,fc)])):r.config.type==="select"?(v(),x("div",pc,[c("select",{value:r.value,onChange:o[3]||(o[3]=i=>r.$emit("update",i.target.value)),required:r.config.required,class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[(v(!0),x(Re,null,Te(r.config.options,i=>(v(),x("option",{key:i.value,value:i.value},de(i.label),9,mc))),128))],40,hc)])):r.config.type==="switch"?(v(),x("div",gc,[c("button",{onClick:o[4]||(o[4]=i=>r.$emit("update",!r.value)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value?"translate-x-5":"translate-x-0"])},null,2)],2)])):Q("",!0)]))}}),yc={class:"space-y-4 p-4 bg-gray-50 rounded-lg"},vc={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},wc={class:"space-y-2"},xc=["value"],_c={class:"flex items-center justify-between"},kc={class:"flex items-center justify-between"},Cc={class:"flex items-center justify-between"},$c={class:"flex items-center justify-between"},Sc={class:"flex items-center justify-between"},Ac=me({__name:"MessagesConfigItem",props:{config:{},value:{}},emits:["update"],setup(e,{emit:t}){const n=e,s=t,r=D({maxMessages:50,enableAutoScroll:!0,showTimestamp:!0,enableMarkdown:!0,codeHighlight:!0,messageAnimation:!0}),o=(i,a)=>{r.value[i]=a,s("update",{...r.value})};return Ke(()=>n.value,i=>{i&&(r.value={...i})},{immediate:!0,deep:!0}),Qe(()=>{n.value?r.value={...n.value}:n.config.defaultValue&&(r.value={...n.config.defaultValue},s("update",r.value))}),(i,a)=>(v(),x("div",yc,[c("div",vc,[c("div",wc,[a[6]||(a[6]=c("label",{class:"block text-sm font-medium text-gray-700"}," 最大消息数量 ",-1)),c("input",{type:"number",value:r.value.maxMessages,onInput:a[0]||(a[0]=l=>o("maxMessages",parseInt(l.target.value))),min:"10",max:"200",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,xc)]),c("div",_c,[a[7]||(a[7]=c("label",{class:"block text-sm font-medium text-gray-700"}," 自动滚动 ",-1)),c("button",{onClick:a[1]||(a[1]=l=>o("enableAutoScroll",!r.value.enableAutoScroll)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value.enableAutoScroll?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value.enableAutoScroll?"translate-x-5":"translate-x-0"])},null,2)],2)]),c("div",kc,[a[8]||(a[8]=c("label",{class:"block text-sm font-medium text-gray-700"}," 显示时间戳 ",-1)),c("button",{onClick:a[2]||(a[2]=l=>o("showTimestamp",!r.value.showTimestamp)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value.showTimestamp?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value.showTimestamp?"translate-x-5":"translate-x-0"])},null,2)],2)]),c("div",Cc,[a[9]||(a[9]=c("label",{class:"block text-sm font-medium text-gray-700"}," 启用 Markdown ",-1)),c("button",{onClick:a[3]||(a[3]=l=>o("enableMarkdown",!r.value.enableMarkdown)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value.enableMarkdown?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value.enableMarkdown?"translate-x-5":"translate-x-0"])},null,2)],2)]),c("div",$c,[a[10]||(a[10]=c("label",{class:"block text-sm font-medium text-gray-700"}," 代码高亮 ",-1)),c("button",{onClick:a[4]||(a[4]=l=>o("codeHighlight",!r.value.codeHighlight)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value.codeHighlight?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value.codeHighlight?"translate-x-5":"translate-x-0"])},null,2)],2)]),c("div",Sc,[a[11]||(a[11]=c("label",{class:"block text-sm font-medium text-gray-700"}," 消息动画 ",-1)),c("button",{onClick:a[5]||(a[5]=l=>o("messageAnimation",!r.value.messageAnimation)),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",r.value.messageAnimation?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",r.value.messageAnimation?"translate-x-5":"translate-x-0"])},null,2)],2)])])]))}}),Ic={xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200",class:"icon",viewBox:"0 0 1024 1024"};function Mc(e,t){return v(),x("svg",Ic,[...t[0]||(t[0]=[c("path",{fill:"#272636",d:"m534.6 403.5 294.2 294.2c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L557.3 335.6c-25-25-65.5-25-90.5 0L150 652.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l294.1-294.2c12.5-12.5 32.7-12.5 45.2 0"},null,-1)])])}const Os={render:Mc},Ec={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Rc(e,t){return v(),x("svg",Ec,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12a8 8 0 0 1-8 8 8.96 8.96 0 0 1-4.906-1.476L3 21l2.476-5.094A8.96 8.96 0 0 1 3 12a8 8 0 0 1 16 0z"},null,-1)])])}const On={render:Rc},Tc={class:"space-y-4 p-4 bg-gray-50 rounded-lg"},Oc={class:"space-y-4"},Pc={class:"flex items-center justify-between mb-3"},Lc={class:"flex items-center gap-2"},Dc=["value","onChange"],jc=["onClick"],Nc={class:"flex items-center gap-2"},Bc=["onClick","disabled"],Fc=["onClick","disabled"],Hc=["onClick"],qc={class:"grid grid-cols-1 gap-3"},Uc=["value","onInput"],Wc={key:0,class:"text-center py-8 text-gray-500"},zc=me({__name:"PromptsConfigItem",props:{config:{},value:{}},emits:["update"],setup(e,{emit:t}){const n=e,s=t,r=D([]),o=()=>{const u={role:"system",content:"",enabled:!0};r.value.push(u),s("update",[...r.value])},i=(u,f,d)=>{r.value[u]&&(r.value[u][f]=d,s("update",[...r.value]))},a=u=>{confirm("确定要删除这个提示词吗？")&&(r.value.splice(u,1),s("update",[...r.value]))},l=(u,f)=>{const d=u+f;if(d>=0&&d<r.value.length){const b=r.value.splice(u,1)[0];r.value.splice(d,0,b),s("update",[...r.value])}};return Ke(()=>n.value,u=>{u&&Array.isArray(u)&&(r.value=[...u])},{immediate:!0,deep:!0}),Qe(()=>{n.value&&Array.isArray(n.value)?r.value=[...n.value]:n.config.defaultValue&&Array.isArray(n.config.defaultValue)&&(r.value=[...n.config.defaultValue],s("update",r.value))}),(u,f)=>(v(),x("div",Tc,[c("div",{class:"flex items-center justify-between"},[f[0]||(f[0]=c("h4",{class:"text-sm font-medium text-gray-900"},"预设提示词",-1)),c("button",{onClick:o,class:"px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"}," 添加提示词 ")]),c("div",Oc,[(v(!0),x(Re,null,Te(r.value,(d,b)=>(v(),x("div",{key:b,class:"bg-white p-4 rounded-lg border border-gray-200"},[c("div",Pc,[c("div",Lc,[c("select",{value:d.role,onChange:h=>i(b,"role",h.target.value),class:"px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},[...f[1]||(f[1]=[c("option",{value:"system"},"System",-1),c("option",{value:"user"},"User",-1),c("option",{value:"assistant"},"Assistant",-1)])],40,Dc),f[2]||(f[2]=c("span",{class:"pl-2 text-xs"},"启用",-1)),c("button",{onClick:h=>i(b,"enabled",!d.enabled),class:te(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",d.enabled?"bg-blue-600":"bg-gray-200"])},[c("span",{class:te(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",d.enabled?"translate-x-5":"translate-x-0"])},null,2)],10,jc)]),c("div",Nc,[c("button",{onClick:h=>l(b,-1),disabled:b===0,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"上移"},[H(I(Os),{class:"w-4 h-4"})],8,Bc),c("button",{onClick:h=>l(b,1),disabled:b===r.value.length-1,class:"p-1 text-gray-400 hover:text-gray-600 disabled:opacity-50",title:"下移"},[H(I(er),{class:"w-4 h-4"})],8,Fc),c("button",{onClick:h=>a(b),class:"p-1 text-red-400 hover:text-red-600",title:"删除"},[H(I(Tt),{class:"w-4 h-4"})],8,Hc)])]),c("div",qc,[c("div",null,[f[3]||(f[3]=c("label",{class:"block text-xs font-medium text-gray-700 mb-1"}," 提示词内容 ",-1)),c("textarea",{value:d.content,onInput:h=>i(b,"content",h.target.value),placeholder:"输入提示词内容...",rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,40,Uc)])])]))),128)),r.value.length===0?(v(),x("div",Wc,[H(I(On),{class:"w-12 h-12 mx-auto mb-4 text-gray-300"}),f[4]||(f[4]=c("p",{class:"text-sm"},"暂无预设提示词",-1)),f[5]||(f[5]=c("p",{class:"text-xs text-gray-400 mt-1"},'点击"添加提示词"按钮开始配置',-1))])):Q("",!0)])]))}}),Vc={key:0,class:"fixed inset-0 z-500 flex items-center justify-center"},Jc={class:"relative z-500 bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4 h-[80vh] flex flex-col overflow-hidden"},Kc={class:"flex items-center justify-between p-6 border-b border-b-gray-200 flex-shrink-0"},Qc={class:"flex-1 h-full p-6 pl-1 pr-1 overflow-hidden"},Xc={class:"w-full h-full overflow-y-auto px-5"},Gc={class:"space-y-6"},Yc={class:"space-y-4 p-4 bg-gray-50 rounded-lg"},Zc={class:"flex items-center justify-between gap-2"},ed={class:"flex gap-1 items-center"},td={class:"relative group"},nd={class:"flex items-center gap-2"},sd={key:0,class:"space-y-2"},rd=["onClick"],od={class:"flex items-center justify-between"},id={class:"text-xs text-gray-500"},ad={class:"flex items-center gap-1 ml-3"},ld=["onClick"],ud=["onClick"],cd=["onClick"],dd={key:1,class:"text-center py-8"},fd={class:"flex items-center gap-2"},pd={class:"text-lg font-medium text-gray-900"},hd={key:0,class:"relative group"},md={class:"absolute left-0 top-6 w-64 p-2 bg-gray-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10"},gd={class:"flex items-center justify-end gap-3 p-6 border-t border-t-gray-200 bg-gray-50 flex-shrink-0"},bd={key:0,class:"absolute inset-0 z-600 flex items-center justify-center"},yd={class:"bg-white rounded-lg p-6 w-96 shadow-xl border border-gray-200"},vd={class:"space-y-4"},wd={class:"flex justify-end gap-2"},xd=["disabled"],_d={key:1,class:"absolute inset-0 z-600 flex items-center justify-center"},kd={class:"bg-white rounded-lg p-6 w-96 shadow-xl border border-gray-200"},Cd={class:"space-y-4"},$d={class:"flex justify-end gap-2"},Sd=["disabled"],Ad={key:2,class:"absolute inset-0 z-600 flex items-center justify-center"},Id={class:"bg-white rounded-lg p-6 w-96 shadow-xl border border-gray-200"},Md={class:"space-y-4"},Ed={class:"flex justify-end gap-2"},Rd={key:3,class:"absolute inset-0 z-600 flex items-center justify-center"},Td={class:"bg-white rounded-lg p-6 w-96 shadow-xl border border-gray-200"},Od={class:"space-y-4"},Pd={class:"flex justify-end gap-2"},Ld=["disabled"],Dd=me({__name:"SettingsModal",props:{visible:{type:Boolean}},emits:["close","save"],setup(e,{emit:t}){const n=t,s=Yt("app-settings",{}),r=Yt("app-presets",[]),o=D(""),i=D(!1),a=D(!1),l=D(!1),u=D(!1),f=D(""),d=D(""),b=D(""),h=D(""),_=D(),g=D([{key:"aiBaseUrl",title:"Base Url",description:"OpenAI 服务的基础 URL 地址",type:"input",placeholder:"https://api.openai.com/v1",defaultValue:"https://api.openai.com/v1",required:!0},{key:"aiApiKey",title:"API Key",description:"OpenAI 服务的 API 密钥",type:"input",placeholder:"请输入您的 API Key",defaultValue:"sk-.....",required:!0},{key:"systemPrompts",title:"预设提示词",description:"配置系统和用户的预设提示词，用于OpenAI请求中的message对象",type:"prompts",defaultValue:[{role:"system",content:"你是一位资深的Web前端工程师和代码架构师，精通Vue 3 (Composition API with `< script setup >`) 和Tailwind CSS。请根据用户需求，高质量地创建新代码或高效地修改现有代码。",enabled:!0},{role:"user",content:"请确保代码遵循最佳实践，使用Vue 3 Composition API语法，样式使用Tailwind CSS，代码要清晰易读。",enabled:!1}]}]),A=k=>{const p=g.value.find(y=>y.key===k);return s.value[k]??p?.defaultValue},$=(k,p)=>{s.value[k]=p},C=k=>{switch(k){case"messages":return Ac;case"prompts":return zc;default:return bc}},z=()=>{if(o.value)confirm(`是否同时更新预设"${o.value}"？`)&&Y();else if(confirm("是否将当前配置保存为新预设？")){i.value=!0;return}n("save",s.value),n("close")},Y=()=>{if(!o.value)return;const k=r.value.findIndex(p=>p.name===o.value);k!==-1&&(r.value[k].settings={...s.value},r.value[k].updatedAt=new Date().toISOString())},ne=()=>{if(confirm("确定要重置所有设置为默认值吗？")){const k={};g.value.forEach(p=>{p.defaultValue!==void 0&&(k[p.key]=p.defaultValue)}),s.value=k}},ae=G(()=>r.value.sort((k,p)=>k.name.localeCompare(p.name)));G(()=>o.value?r.value.find(k=>k.name===o.value):null);const J=k=>new Date(k).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),ee=()=>{if(!f.value.trim())return;const k=f.value.trim(),p=r.value.findIndex(w=>w.name===k),y=new Date().toISOString(),P={name:k,settings:{...s.value},createdAt:p===-1?y:r.value[p].createdAt,updatedAt:y};if(p!==-1)if(confirm(`预设"${k}"已存在，是否覆盖？`))r.value[p]=P,o.value=k;else return;else r.value.push(P),o.value=k;f.value="",i.value=!1,n("save",s.value),n("close")},se=k=>{if(!k){ne(),o.value="";return}const p=r.value.find(y=>y.name===k);p&&(Object.keys(s.value).forEach(y=>{delete s.value[y]}),Object.assign(s.value,p.settings),o.value=k)},R=k=>{if(confirm(`确定要删除预设"${k}"吗？`)){const p=r.value.findIndex(y=>y.name===k);p!==-1&&(r.value.splice(p,1),o.value===k&&(o.value="",ne()))}},S=k=>{k&&(b.value=k,d.value=k,a.value=!0)},T=()=>{const k=b.value;if(!d.value.trim()||!k)return;const p=d.value.trim();if(r.value.some(P=>P.name===p&&P.name!==k)){alert(`预设名称"${p}"已存在！`);return}const y=r.value.findIndex(P=>P.name===k);y!==-1&&(r.value[y].name=p,r.value[y].updatedAt=new Date().toISOString(),o.value===k&&(o.value=p)),d.value="",b.value="",a.value=!1},Z=k=>{const p=r.value.find(L=>L.name===k);if(!p)return;let y=`${k}_副本`,P=1;for(;r.value.some(L=>L.name===y);)y=`${k}_副本${P}`,P++;const w=new Date().toISOString(),E={name:y,settings:{...p.settings},createdAt:w,updatedAt:w};r.value.push(E),o.value=y,Object.keys(s.value).forEach(L=>{delete s.value[L]}),Object.assign(s.value,E.settings)},O=()=>{const k={version:"1.0",exportDate:new Date().toISOString(),presets:r.value},p=new Blob([JSON.stringify(k,null,2)],{type:"application/json"}),y=URL.createObjectURL(p),P=document.createElement("a");P.href=y,P.download=`settings-presets-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(y)},j=k=>{const y=k.target.files?.[0];if(!y)return;const P=new FileReader;P.onload=w=>{try{const E=w.target?.result,L=JSON.parse(E);if(!L.presets||!Array.isArray(L.presets)){alert("无效的预设文件格式！");return}let W=0,ce=0;L.presets.forEach(re=>{if(!re.name||!re.settings)return;const fe=r.value.findIndex(qe=>qe.name===re.name);fe!==-1?(r.value[fe]={...re,updatedAt:new Date().toISOString()},ce++):(r.value.push(re),W++)}),alert(`导入完成！新增 ${W} 个预设，覆盖 ${ce} 个预设。`),l.value=!1,_.value&&(_.value.value="")}catch(E){alert("文件解析失败，请确保文件格式正确！"),console.error("Import error:",E)}},P.readAsText(y)},q=()=>{if(!h.value.trim())return;const k=h.value.trim(),p=r.value.findIndex(w=>w.name===k),y=new Date().toISOString(),P={name:k,settings:{...s.value},createdAt:p===-1?y:r.value[p].createdAt,updatedAt:y};if(p!==-1)if(confirm(`预设"${k}"已存在，是否覆盖？`))r.value[p]=P,o.value=k;else return;else r.value.push(P),o.value=k;h.value="",u.value=!1};return Qe(()=>{g.value.forEach(k=>{k.defaultValue!==void 0&&s.value[k.key]===void 0&&(s.value[k.key]=k.defaultValue)})}),(k,p)=>k.visible?(v(),x("div",Vc,[c("div",{class:"absolute inset-0 bg-black opacity-20",onClick:p[0]||(p[0]=y=>k.$emit("close"))}),c("div",Jc,[c("div",Kc,[p[12]||(p[12]=c("h2",{class:"text-xl font-semibold text-gray-900"},"设置",-1)),c("button",{onClick:p[1]||(p[1]=y=>k.$emit("close")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},[H(I(Tt),{class:"w-5 h-5 text-gray-500"})])]),c("div",Qc,[c("div",Xc,[c("div",Gc,[c("div",Yc,[c("div",Zc,[c("div",ed,[p[14]||(p[14]=c("label",{class:"text-sm font-medium text-gray-700"},"当前预设",-1)),c("div",td,[H(I(Tn),{class:"w-4 h-4 text-gray-400 cursor-help"}),p[13]||(p[13]=c("div",{class:"absolute left-0 top-6 w-64 p-2 bg-gray-800 text-white text-xs rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10"},[Ve(" 管理和切换不同的配置预设 "),c("div",{class:"absolute -top-1 left-2 w-2 h-2 bg-gray-800 transform rotate-45"})],-1))])]),c("div",nd,[c("button",{onClick:O,class:"px-3 py-1 text-sm bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-1",title:"导出所有预设"},[H(I(Wu),{class:"w-4 h-4"}),p[15]||(p[15]=Ve(" 导出 ",-1))]),c("button",{onClick:p[2]||(p[2]=y=>l.value=!0),class:"px-3 py-1 text-sm bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center gap-1",title:"导入预设"},[H(I(Ju),{class:"w-4 h-4"}),p[16]||(p[16]=Ve(" 导入 ",-1))]),c("button",{onClick:p[3]||(p[3]=y=>u.value=!0),class:"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-1",title:"添加新预设"},[H(I(Xu),{class:"w-4 h-4"}),p[17]||(p[17]=Ve(" 添加 ",-1))])])]),I(r).length>0?(v(),x("div",sd,[(v(!0),x(Re,null,Te(ae.value,y=>(v(),x("div",{key:y.name,class:te(["flex items-center justify-between p-3 bg-white rounded-lg border transition-colors",o.value===y.name?"border-blue-200 bg-blue-50":"border-gray-200 hover:border-gray-300"])},[c("div",{class:"flex-1 cursor-pointer",onClick:P=>se(y.name)},[c("div",od,[c("span",{class:te(["font-medium text-sm",o.value===y.name?"text-blue-700":"text-gray-900"])},de(y.name),3),c("span",id,de(J(y.updatedAt)),1)])],8,rd),c("div",ad,[c("button",{onClick:P=>Z(y.name),class:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"复制预设"},[H(I(Zu),{class:"w-4 h-4"})],8,ld),c("button",{onClick:P=>S(y.name),class:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"重命名预设"},[H(I(nc),{class:"w-4 h-4"})],8,ud),c("button",{onClick:P=>R(y.name),class:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"删除预设"},[H(I(Vr),{class:"w-4 h-4"})],8,cd)])],2))),128))])):(v(),x("div",dd,[H(I(Vr),{class:"w-12 h-12 mx-auto mb-4 text-gray-300"}),p[18]||(p[18]=c("p",{class:"text-sm text-gray-500"},"暂无保存的预设",-1)),p[19]||(p[19]=c("p",{class:"text-xs text-gray-400 mt-1"},' 配置完成后点击右下角"保存设置"时会提示保存为预设 ',-1))]))]),(v(!0),x(Re,null,Te(g.value,(y,P)=>(v(),x("div",{key:P,class:"space-y-4"},[c("div",fd,[c("h3",pd,de(y.title),1),y.description?(v(),x("div",hd,[H(I(Tn),{class:"w-4 h-4 text-gray-400 cursor-help"}),c("div",md,[Ve(de(y.description)+" ",1),p[20]||(p[20]=c("div",{class:"absolute -top-1 left-2 w-2 h-2 bg-gray-800 transform rotate-45"},null,-1))])])):Q("",!0)]),(v(),Rt(Go(C(y.type)),{config:y,value:A(y.key),onUpdate:w=>$(y.key,w)},null,40,["config","value","onUpdate"]))]))),128))])])]),c("div",gd,[c("button",{onClick:ne,class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," 重置默认 "),c("button",{onClick:p[4]||(p[4]=y=>k.$emit("close")),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"}," 取消 "),c("button",{onClick:z,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 transition-colors"}," 保存设置 ")])]),i.value?(v(),x("div",bd,[c("div",yd,[p[22]||(p[22]=c("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"保存预设",-1)),c("div",vd,[c("div",null,[p[21]||(p[21]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"预设名称",-1)),At(c("input",{"onUpdate:modelValue":p[5]||(p[5]=y=>f.value=y),type:"text",placeholder:"输入预设名称...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:fs(ee,["enter"])},null,544),[[Jt,f.value]])]),c("div",wd,[c("button",{onClick:p[6]||(p[6]=y=>i.value=!1),class:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"}," 取消 "),c("button",{onClick:ee,disabled:!f.value.trim(),class:"px-4 py-2 text-sm text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," 保存 ",8,xd)])])])])):Q("",!0),a.value?(v(),x("div",_d,[c("div",kd,[p[24]||(p[24]=c("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"重命名预设",-1)),c("div",Cd,[c("div",null,[p[23]||(p[23]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"新名称",-1)),At(c("input",{"onUpdate:modelValue":p[7]||(p[7]=y=>d.value=y),type:"text",placeholder:"输入新的预设名称...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:fs(T,["enter"])},null,544),[[Jt,d.value]])]),c("div",$d,[c("button",{onClick:p[8]||(p[8]=y=>a.value=!1),class:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"}," 取消 "),c("button",{onClick:T,disabled:!d.value.trim(),class:"px-4 py-2 text-sm text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," 重命名 ",8,Sd)])])])])):Q("",!0),l.value?(v(),x("div",Ad,[c("div",Id,[p[27]||(p[27]=c("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"导入预设",-1)),c("div",Md,[c("div",null,[p[25]||(p[25]=c("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," 选择预设文件 (.json) ",-1)),c("input",{ref_key:"fileInput",ref:_,type:"file",accept:".json",onChange:j,class:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,544)]),p[26]||(p[26]=c("div",{class:"text-xs text-gray-500"},[c("p",null,"• 支持导入之前导出的预设文件"),c("p",null,"• 重名预设将被覆盖")],-1)),c("div",Ed,[c("button",{onClick:p[9]||(p[9]=y=>l.value=!1),class:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"}," 取消 ")])])])])):Q("",!0),u.value?(v(),x("div",Rd,[c("div",Td,[p[30]||(p[30]=c("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"添加新预设",-1)),c("div",Od,[c("div",null,[p[28]||(p[28]=c("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"预设名称",-1)),At(c("input",{"onUpdate:modelValue":p[10]||(p[10]=y=>h.value=y),type:"text",placeholder:"输入预设名称...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",onKeyup:fs(q,["enter"])},null,544),[[Jt,h.value]])]),p[29]||(p[29]=c("div",{class:"text-xs text-gray-500"},[c("p",null,"• 将基于当前配置创建新预设"),c("p",null,"• 如果名称已存在将提示覆盖")],-1)),c("div",Pd,[c("button",{onClick:p[11]||(p[11]=y=>u.value=!1),class:"px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors"}," 取消 "),c("button",{onClick:q,disabled:!h.value.trim(),class:"px-4 py-2 text-sm text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," 添加 ",8,Ld)])])])])):Q("",!0)])):Q("",!0)}}),Xe=(e,t)=>{const n=e.__vccOpts||e;for(const[s,r]of t)n[s]=r;return n},jd=Xe(Dd,[["__scopeId","data-v-f393d7a4"]]),Nd={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Bd(e,t){return v(),x("svg",Nd,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m10 20 4-16m4 4 4 4-4 4M6 16l-4-4 4-4"},null,-1)])])}const tr={render:Bd},Fd={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Hd(e,t){return v(),x("svg",Fd,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065"},null,-1),c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0"},null,-1)])])}const Zo={render:Hd},qd={key:0,class:"fixed inset-0 z-500 flex items-center justify-center"},Ud={class:"relative bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 h-[80vh] flex flex-col overflow-hidden"},Wd={class:"flex items-center justify-between p-6 border-b flex-shrink-0 border-b-gray-200"},zd={class:"flex flex-1 min-h-0 pr-1"},Vd={class:"w-64 border-r border-r-gray-200 bg-gray-50 p-4 flex-shrink-0"},Jd={class:"space-y-2"},Kd=["onClick"],Qd={class:"flex-1 p-6 overflow-y-auto"},Xd={key:0,class:"prose max-w-none"},Gd={class:"text-lg font-semibold text-gray-900 mb-4"},Yd=["innerHTML"],Zd=me({__name:"HelpModal",props:{visible:{type:Boolean}},emits:["close"],setup(e){const t=D("getting-started"),n=[{id:"getting-started",title:"快速开始",icon:On,content:`
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">欢迎使用 AI Chat & Code Editor</h4>
        <p class="text-gray-600">这是一个集成了 AI 对话和代码编辑功能的智能开发工具。</p>
        
        <h5 class="font-medium text-gray-900 mt-6">主要功能：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>AI 对话</strong>：与 AI 助手进行自然语言交流</li>
          <li><strong>代码生成</strong>：根据需求自动生成代码</li>
          <li><strong>实时预览</strong>：即时查看代码运行效果</li>
          <li><strong>历史记录</strong>：管理多个对话会话</li>
          <li><strong>代码编辑</strong>：内置 Monaco 编辑器</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">快速开始步骤：</h5>
        <ol class="list-decimal list-inside space-y-2 text-gray-600">
          <li>在左侧对话区输入您的问题或需求</li>
          <li>AI 会根据您的需求生成相应的代码</li>
          <li>代码会自动显示在右侧编辑器中</li>
          <li>点击预览按钮查看运行效果</li>
        </ol>
      </div>
    `},{id:"chat-features",title:"对话功能",icon:On,content:`
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">对话功能详解</h4>
        
        <h5 class="font-medium text-gray-900 mt-6">消息类型：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>文本消息</strong>：支持 Markdown 格式</li>
          <li><strong>图片消息</strong>：可上传图片进行分析</li>
          <li><strong>代码消息</strong>：自动识别和高亮代码块</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">操作功能：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>重新生成</strong>：重新请求 AI 回答</li>
          <li><strong>删除消息</strong>：删除不需要的消息</li>
          <li><strong>复制代码</strong>：一键复制代码块</li>
          <li><strong>应用代码</strong>：将代码应用到编辑器</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">会话管理：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>新建对话</strong>：创建新的对话会话</li>
          <li><strong>切换对话</strong>：在不同会话间切换</li>
          <li><strong>删除对话</strong>：删除不需要的会话</li>
          <li><strong>清空对话</strong>：清空当前会话内容</li>
        </ul>
      </div>
    `},{id:"code-editor",title:"代码编辑",icon:tr,content:`
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">代码编辑器功能</h4>
        
        <h5 class="font-medium text-gray-900 mt-6">编辑器特性：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>语法高亮</strong>：支持多种编程语言</li>
          <li><strong>智能提示</strong>：代码自动完成</li>
          <li><strong>错误检查</strong>：实时语法检查</li>
          <li><strong>代码格式化</strong>：自动格式化代码</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">预览功能：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>实时预览</strong>：即时查看代码效果</li>
          <li><strong>响应式预览</strong>：支持不同屏幕尺寸</li>
          <li><strong>错误提示</strong>：显示运行时错误</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">历史记录：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>版本控制</strong>：保存代码修改历史</li>
          <li><strong>撤销重做</strong>：支持撤销和重做操作</li>
          <li><strong>版本切换</strong>：快速切换到历史版本</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">快捷键：</h5>
        <div class="bg-gray-50 p-4 rounded-lg">
          <ul class="list-none space-y-1 text-sm text-gray-600">
            <li><kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + S</kbd> - 保存代码</li>
            <li><kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + Z</kbd> - 撤销</li>
            <li><kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + Y</kbd> - 重做</li>
            <li><kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + F</kbd> - 查找</li>
            <li><kbd class="bg-gray-200 px-2 py-1 rounded">Ctrl + H</kbd> - 替换</li>
          </ul>
        </div>
      </div>
    `},{id:"settings",title:"设置配置",icon:Zo,content:`
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">设置配置说明</h4>
        
        <h5 class="font-medium text-gray-900 mt-6">AI 配置：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>Base URL</strong>：AI 服务的 API 地址</li>
          <li><strong>API Key</strong>：访问 AI 服务的密钥</li>
          <li><strong>模型选择</strong>：选择不同的 AI 模型</li>
        </ul>

        <h5 class="font-medium text-gray-900 mt-6">消息设置：</h5>
        <ul class="list-disc list-inside space-y-2 text-gray-600">
          <li><strong>最大消息数量</strong>：限制对话历史长度</li>
          <li><strong>自动滚动</strong>：新消息时自动滚动</li>
          <li><strong>显示时间戳</strong>：显示消息发送时间</li>
          <li><strong>启用 Markdown</strong>：支持 Markdown 渲染</li>
          <li><strong>代码高亮</strong>：启用代码语法高亮</li>
          <li><strong>消息动画</strong>：启用消息动画效果</li>
        </ul>

        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
          <h6 class="font-medium text-yellow-800">注意事项：</h6>
          <ul class="list-disc list-inside space-y-1 text-sm text-yellow-700 mt-2">
            <li>API Key 会安全存储在本地，不会上传到服务器</li>
            <li>修改设置后需要刷新页面才能完全生效</li>
            <li>重置设置会清除所有自定义配置</li>
          </ul>
        </div>
      </div>
    `},{id:"faq",title:"常见问题",icon:Tn,content:`
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">常见问题解答</h4>
        
        <div class="space-y-6">
          <div>
            <h5 class="font-medium text-gray-900">Q: 如何获取 API Key？</h5>
            <p class="text-gray-600 mt-2">
              您需要注册相应的 AI 服务提供商账户（如 OpenAI、Google Gemini 等），
              然后在其开发者控制台中生成 API Key。
            </p>
          </div>

          <div>
            <h5 class="font-medium text-gray-900">Q: 为什么 AI 不响应？</h5>
            <p class="text-gray-600 mt-2">
              请检查：1) API Key 是否正确配置；2) Base URL 是否可访问；
              3) 网络连接是否正常；4) 是否超出了 API 调用限制。
            </p>
          </div>

          <div>
            <h5 class="font-medium text-gray-900">Q: 代码预览不显示怎么办？</h5>
            <p class="text-gray-600 mt-2">
              确保代码是有效的 HTML/CSS/JavaScript，检查浏览器控制台是否有错误信息，
              尝试刷新预览或重新生成代码。
            </p>
          </div>

          <div>
            <h5 class="font-medium text-gray-900">Q: 如何保存我的工作？</h5>
            <p class="text-gray-600 mt-2">
              所有对话和代码都会自动保存在浏览器本地存储中。
              您也可以手动复制代码到外部文件进行备份。
            </p>
          </div>

          <div>
            <h5 class="font-medium text-gray-900">Q: 支持哪些编程语言？</h5>
            <p class="text-gray-600 mt-2">
              主要支持 Web 开发相关语言：HTML、CSS、JavaScript、TypeScript、Vue、React 等。
              编辑器还支持语法高亮和基本的代码提示功能。
            </p>
          </div>

          <div>
            <h5 class="font-medium text-gray-900">Q: 如何提高 AI 回答质量？</h5>
            <p class="text-gray-600 mt-2">
              1) 提供清晰具体的需求描述；2) 包含相关的上下文信息；
              3) 指定期望的技术栈和框架；4) 提供示例或参考资料。
            </p>
          </div>
        </div>

        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mt-8">
          <h6 class="font-medium text-blue-800">需要更多帮助？</h6>
          <p class="text-sm text-blue-700 mt-2">
            如果您遇到其他问题，可以在对话中直接询问 AI 助手，
            或查看项目的 GitHub 仓库获取更多技术支持。
          </p>
        </div>
      </div>
    `}];return(s,r)=>s.visible?(v(),x("div",qd,[c("div",{class:"absolute inset-0 bg-black opacity-20",onClick:r[0]||(r[0]=o=>s.$emit("close"))}),c("div",Ud,[c("div",Wd,[r[2]||(r[2]=c("h2",{class:"text-xl font-semibold text-gray-900"},"帮助文档",-1)),c("button",{onClick:r[1]||(r[1]=o=>s.$emit("close")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},[H(I(Tt),{class:"w-5 h-5 text-gray-500"})])]),c("div",zd,[c("div",Vd,[c("nav",Jd,[(v(),x(Re,null,Te(n,o=>c("button",{key:o.id,onClick:i=>t.value=o.id,class:te(["w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors",t.value===o.id?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100"])},[(v(),Rt(Go(o.icon),{class:"w-4 h-4 inline-block mr-2"})),Ve(" "+de(o.title),1)],10,Kd)),64))])]),c("div",Qd,[(v(),x(Re,null,Te(n,o=>c("div",{key:o.id},[t.value===o.id?(v(),x("div",Xd,[c("h3",Gd,de(o.title),1),c("div",{innerHTML:o.content},null,8,Yd)])):Q("",!0)])),64))])])])])):Q("",!0)}}),ef=Xe(Zd,[["__scopeId","data-v-5fca379e"]]),tf={class:"px-6 py-4 flex items-center justify-between z-10"},nf={class:"flex items-center gap-2"},sf=me({__name:"AppHeader",props:{title:{default:"AI Chat & Code Editor"},selectedModel:{default:"gemini-2.5-flash"}},setup(e){const t=e,n=D(t.selectedModel),s=D(!1),r=D(!1),o=[{label:"2.5 Flash",value:"gemini-2.5-flash",description:"快速提供分析的帮助"},{label:"2.5 Pro",value:"gemini-2.5-pro",description:"推理、数学和编程"}];G(()=>{const a=o.find(l=>l.value===t.selectedModel);return a?a.label:"Gemini 2.5 Flash"});const i=a=>{console.log("设置已保存:",a)};return(a,l)=>(v(),x("header",tf,[H(bu,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=u=>n.value=u),models:o,onModelChange:l[1]||(l[1]=u=>a.$emit("model-change",u))},null,8,["modelValue"]),c("div",nf,[c("button",{onClick:l[2]||(l[2]=u=>s.value=!0),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-600",title:"设置"},[H(I(Zo),{class:"w-5 h-5 text-gray-600"})]),c("button",{onClick:l[3]||(l[3]=u=>r.value=!0),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-600",title:"帮助"},[H(I(Tn),{class:"w-5 h-5 text-gray-600"})])]),H(jd,{visible:s.value,onClose:l[4]||(l[4]=u=>s.value=!1),onSave:i},null,8,["visible"]),H(ef,{visible:r.value,onClose:l[5]||(l[5]=u=>r.value=!1)},null,8,["visible"])]))}}),rf={class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},of=["d"],af={key:0,class:"text-lg font-semibold text-gray-800"},lf={class:"p-4 flex items-center justify-center"},uf=["title"],cf={key:0},df={key:0,class:"flex-1 overflow-y-auto"},ff={class:"px-4 py-2"},pf={class:"space-y-1"},hf=["onClick"],mf={class:"truncate"},gf=["onClick"],bf=me({__name:"ChatSidebar",props:{collapsed:{type:Boolean},chatHistory:{},currentChatId:{}},emits:["toggle","new-chat","select-chat","delete-chat"],setup(e){return(t,n)=>(v(),x("div",{class:te(["bg-white border-r border-gray-200 transition-all duration-300 ease-in-out flex flex-col truncate",t.collapsed?"w-18":"w-[280px]"])},[c("div",{class:te(["p-4 border-b border-gray-200 flex items-center",t.collapsed?"justify-center":"justify-between"])},[c("button",{onClick:n[0]||(n[0]=s=>t.$emit("toggle")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors flex-shrink-0"},[(v(),x("svg",rf,[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:t.collapsed?"M4 6h16M4 12h16M4 18h16":"M6 18L18 6M6 6l12 12"},null,8,of)]))]),t.collapsed?Q("",!0):(v(),x("h1",af,"MO"))],2),c("div",lf,[c("button",{onClick:n[1]||(n[1]=s=>t.$emit("new-chat")),class:te(["py-2  bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",t.collapsed?"w-8 h-8":"w-full px-4"]),title:t.collapsed?"新建对话":""},[n[2]||(n[2]=c("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),t.collapsed?Q("",!0):(v(),x("span",cf,"新对话"))],10,uf)]),t.collapsed?Q("",!0):(v(),x("div",df,[c("div",ff,[n[4]||(n[4]=c("h3",{class:"text-sm font-medium text-gray-500 mb-2"},"近期对话",-1)),c("div",pf,[(v(!0),x(Re,null,Te(t.chatHistory,s=>(v(),x("div",{key:s.id,onClick:r=>t.$emit("select-chat",s.id),class:te(["p-2 rounded-lg cursor-pointer transition-colors truncate text-sm relative group flex items-center justify-between",t.currentChatId===s.id?"bg-blue-100 text-blue-800":"hover:bg-gray-100 text-gray-700"])},[c("span",mf,de(s.title||"新对话"),1),s.id!==-1?(v(),x("button",{key:0,onClick:Jl(r=>t.$emit("delete-chat",s.id),["stop"]),class:"absolute right-2 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-gray-200 hidden group-hover:block flex-shrink-0",title:"删除对话"},[...n[3]||(n[3]=[c("svg",{class:"w-4 h-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[c("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})],-1)])],8,gf)):Q("",!0)],10,hf))),128))])])]))],2))}}),Jr={aiBaseUrl:"https://api.openai.com/v1",aiApiKey:"sk-.....",messageSettings:{maxMessages:50,enableAutoScroll:!0,showTimestamp:!0,enableMarkdown:!0,codeHighlight:!0,messageAnimation:!0},systemPrompts:[{role:"system",content:"你是一位资深的Web前端工程师和代码架构师，精通Vue 3 (Composition API with `< script setup >`) 和Tailwind CSS。请根据用户需求，高质量地创建新代码或高效地修改现有代码。",enabled:!0},{role:"user",content:"请确保代码遵循最佳实践，使用Vue 3 Composition API语法，样式使用Tailwind CSS，代码要清晰易读。",enabled:!1}]};function nr(){const e=Yt("app-settings",{}),t=l=>e.value[l]??Jr[l],n=(l,u)=>{e.value[l]=u},s=()=>{e.value={...Jr}},r=G(()=>({baseUrl:t("aiBaseUrl"),apiKey:t("aiApiKey")})),o=G(()=>t("messageSettings")),i=G(()=>t("systemPrompts")),a=G(()=>i.value.filter(l=>l.enabled));return{settings:e,getSettingValue:t,updateSetting:n,resetToDefault:s,aiSettings:r,messageSettings:o,systemPrompts:i,enabledPrompts:a}}const yf={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function vf(e,t){return v(),x("svg",yf,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m4 16 4.586-4.586a2 2 0 0 1 2.828 0L16 16m-2-2 1.586-1.586a2 2 0 0 1 2.828 0L20 14m-6-6h.01M6 20h12a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2"},null,-1)])])}const wf={render:vf},xf={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function _f(e,t){return v(),x("svg",xf,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m12 19 9 2-9-18-9 18zm0 0v-8"},null,-1)])])}const kf={render:_f},Cf={class:"relative"},$f={class:"bg-white border border-gray-300 rounded-xl shadow-sm"},Sf={key:0,class:"p-4 border-b border-gray-200"},Af={class:"flex flex-wrap gap-3"},If=["src"],Mf=["onClick"],Ef={class:"flex flex-col p-4 gap-3"},Rf={class:"flex-1"},Tf=["disabled"],Of={class:"flex items-center gap-2"},Pf=["disabled"],Lf=["disabled"],Df={class:"mt-2 text-xs text-gray-500 text-center hidden"},jf=me({__name:"ChatInput",props:{disabled:{type:Boolean,default:!1},isStreaming:{type:Boolean,default:!1}},emits:["send","stop"],setup(e,{emit:t}){const n=e,s=t,r=D(""),o=D([]),i=D(),a=()=>{Gt(()=>{i.value&&(i.value.style.height="auto",i.value.style.height=i.value.scrollHeight+"px")})},l=g=>{g.ctrlKey&&g.key==="Enter"&&(g.preventDefault(),n.isStreaming||u())},u=()=>{n.disabled||!r.value.trim()&&o.value.length===0||(s("send",{message:r.value.trim(),images:[...o.value]}),r.value="",o.value=[],Gt(()=>{i.value&&(i.value.style.height="auto")}))},f=async g=>{if(!g.clipboardData)return;const A=g.clipboardData.items;for(let $=0;$<A.length;$++)if(A[$].type.indexOf("image")!==-1){const C=A[$].getAsFile();if(C){const z=await b(C);z&&o.value.push(z)}}},d=async g=>{const A=g.target.files;if(A){for(let $=0;$<A.length;$++){const C=await b(A[$]);C&&o.value.push(C)}g.target.value=""}},b=g=>new Promise(A=>{const $=new FileReader;$.onload=C=>A(C.target?.result),$.onerror=()=>A(null),$.readAsDataURL(g)}),h=g=>{o.value.splice(g,1)},_=()=>{s("stop")};return(g,A)=>(v(),x("div",Cf,[c("div",$f,[o.value.length>0?(v(),x("div",Sf,[c("div",Af,[(v(!0),x(Re,null,Te(o.value,($,C)=>(v(),x("div",{key:C,class:"relative group"},[c("img",{src:$,alt:"上传的图片",class:"w-20 h-20 object-cover rounded-lg border border-gray-200"},null,8,If),c("button",{onClick:z=>h(C),class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"},[H(I(Tt))],8,Mf)]))),128))])])):Q("",!0),c("div",Ef,[c("div",Rf,[At(c("textarea",{ref_key:"textareaRef",ref:i,"onUpdate:modelValue":A[0]||(A[0]=$=>r.value=$),onKeydown:l,onPaste:f,onInput:a,disabled:g.disabled,placeholder:"有什么可以帮您的？",class:"w-full resize-none border-0 outline-none placeholder-gray-400 text-gray-900 text-base leading-6",rows:"1",style:{"max-height":"200px"}},null,40,Tf),[[Jt,r.value]])]),c("div",Of,[c("label",{class:te(["p-2 hover:bg-gray-100 rounded-lg cursor-pointer transition-colors",{"opacity-50 pointer-events-none":g.isStreaming}])},[H(I(wf),{class:"w-5 h-5 text-gray-500"}),c("input",{type:"file",onChange:d,accept:"image/*",multiple:"",class:"hidden",disabled:g.isStreaming},null,40,Pf)],2),c("button",{onClick:A[1]||(A[1]=$=>g.isStreaming?_():u()),disabled:!g.isStreaming&&(g.disabled||!r.value.trim()&&o.value.length===0),class:te(["p-2 rounded-lg transition-all duration-200",g.isStreaming?"bg-red-500 text-white hover:bg-red-600 shadow-sm":g.disabled||!r.value.trim()&&o.value.length===0?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-500 text-white hover:bg-blue-600 shadow-sm"])},[g.isStreaming?(v(),Rt(I(Tt),{key:0,class:"w-5 h-5"})):(v(),Rt(I(kf),{key:1,class:"w-5 h-5"}))],10,Lf)])])]),c("div",Df,de(g.isStreaming?"点击停止按钮终止生成":"按 Ctrl+Enter 发送消息，支持直接粘贴图片"),1)]))}}),Nf=Xe(jf,[["__scopeId","data-v-17174aac"]]),Bf={class:"w-full h-10/12 flex items-center justify-center"},Ff={class:"text-center py-12"},Hf={class:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4"},qf=me({__name:"WelcomeScreen",setup(e){return(t,n)=>(v(),x("div",Bf,[c("div",Ff,[c("div",Hf,[H(I(On),{class:"w-8 h-8 text-blue-500"})]),n[0]||(n[0]=c("h3",{class:"text-lg font-medium text-gray-800 mb-2"},"欢迎使用AI代码编辑器",-1)),n[1]||(n[1]=c("p",{class:"text-gray-600"},"您可以在下方输入框中描述您的需求，AI将为您生成代码",-1))])]))}}),Uf={xmlns:"http://www.w3.org/2000/svg",width:"200",height:"200",class:"icon",viewBox:"0 0 1024 1024"};function Wf(e,t){return v(),x("svg",Uf,[...t[0]||(t[0]=[c("path",{fill:"#262626",d:"M876.864 782.592c3.264 0 6.272-3.2 6.272-6.656s-3.008-6.592-6.272-6.592-6.272 3.2-6.272 6.592c0 3.456 3.008 6.656 6.272 6.656M736.32 935.936c2.304 2.432 5.568 3.84 8.768 3.84a12.16 12.16 0 0 0 8.832-3.84 13.76 13.76 0 0 0 0-18.56 12.22 12.22 0 0 0-8.832-3.84 12.16 12.16 0 0 0-8.768 3.84 13.696 13.696 0 0 0 0 18.56m-184 82.304c3.456 3.648 8.32 5.76 13.184 5.76a18.37 18.37 0 0 0 13.184-5.76 20.61 20.61 0 0 0 0-27.968 18.37 18.37 0 0 0-13.184-5.824 18.37 18.37 0 0 0-13.184 5.76 20.61 20.61 0 0 0 0 28.032m-198.336-5.76c4.608 4.8 11.072 7.68 17.6 7.68a24.45 24.45 0 0 0 17.536-7.68 27.456 27.456 0 0 0 0-37.248 24.45 24.45 0 0 0-17.536-7.68 24.45 24.45 0 0 0-17.6 7.68 27.52 27.52 0 0 0 0 37.184zm-175.68-91.84c5.76 6.08 13.824 9.6 21.952 9.6a30.6 30.6 0 0 0 22.016-9.6 34.37 34.37 0 0 0 0-46.592 30.6 30.6 0 0 0-22.016-9.6 30.6 30.6 0 0 0-21.952 9.6 34.37 34.37 0 0 0 0 46.592M57.152 761.28c6.912 7.36 16.64 11.648 26.368 11.648a36.74 36.74 0 0 0 26.432-11.584 41.28 41.28 0 0 0 0-55.936 36.74 36.74 0 0 0-26.432-11.584 36.8 36.8 0 0 0-26.368 11.52 41.28 41.28 0 0 0 0 56zM12.736 564.672a42.88 42.88 0 0 0 30.784 13.44 42.88 42.88 0 0 0 30.784-13.44 48.13 48.13 0 0 0 0-65.216 42.88 42.88 0 0 0-30.72-13.44 42.88 42.88 0 0 0-30.848 13.44 48.13 48.13 0 0 0 0 65.216M52.544 369.28a48.96 48.96 0 0 0 35.2 15.36 48.96 48.96 0 0 0 35.2-15.36 54.976 54.976 0 0 0 0-74.56 48.96 48.96 0 0 0-35.2-15.424 48.96 48.96 0 0 0-35.2 15.424 54.976 54.976 0 0 0 0 74.56m115.776-156.8c10.368 11.008 24.96 17.408 39.68 17.408 14.592 0 29.184-6.4 39.552-17.408a61.89 61.89 0 0 0 0-83.84 55.1 55.1 0 0 0-39.616-17.408c-14.656 0-29.248 6.4-39.616 17.408a61.89 61.89 0 0 0 0 83.84m169.024-87.68c11.52 12.16 27.712 19.264 43.968 19.264s32.448-7.04 43.968-19.264a68.67 68.67 0 0 0 0-93.184 61.25 61.25 0 0 0-43.968-19.264 61.25 61.25 0 0 0-43.968 19.264 68.736 68.736 0 0 0 0 93.184m189.632-1.088c12.672 13.44 30.528 21.248 48.448 21.248s35.712-7.808 48.384-21.248a75.584 75.584 0 0 0 0-102.464A67.4 67.4 0 0 0 575.36 0c-17.92 0-35.776 7.808-48.448 21.248a75.584 75.584 0 0 0 0 102.464zM700.8 210.304c13.824 14.592 33.28 23.104 52.736 23.104 19.584 0 39.04-8.512 52.8-23.104a82.43 82.43 0 0 0 0-111.744 73.47 73.47 0 0 0-52.8-23.168c-19.52 0-38.912 8.512-52.736 23.168a82.43 82.43 0 0 0 0 111.744m124.032 158.528c14.976 15.872 36.032 25.088 57.216 25.088 21.12 0 42.24-9.216 57.152-25.088a89.344 89.344 0 0 0 0-121.088 79.62 79.62 0 0 0-57.152-25.088c-21.184 0-42.24 9.216-57.216 25.088a89.344 89.344 0 0 0 0 121.088m50.432 204.032c16.128 17.088 38.784 27.008 61.632 27.008 22.784 0 45.44-9.92 61.568-27.008a96.256 96.256 0 0 0 0-130.432 85.76 85.76 0 0 0-61.568-27.072c-22.848 0-45.44 9.984-61.632 27.072a96.19 96.19 0 0 0 0 130.432"},null,-1)])])}const zf={render:Wf},Vf={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function Jf(e,t){return v(),x("svg",Vf,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 0 0 4.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 0 1-15.357-2m15.357 2H15"},null,-1)])])}const ei={render:Jf},Kf={class:"h-full space-y-6 overflow-y-auto pr-2 pb-2"},Qf={key:0,class:"text-center py-2"},Xf={class:"inline-block px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded-full"},Gf={key:0,class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0"},Yf={key:0,class:"relative"},Zf=["innerHTML"],ep={key:1,class:"whitespace-pre-wrap"},tp={key:1,class:"whitespace-pre-wrap"},np={key:2,class:"mt-3 flex flex-wrap gap-2"},sp=["src","onClick"],rp={class:"w-full flex justify-between items-center"},op={key:0,class:"text-xs opacity-70"},ip={key:1},ap={key:2,class:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},lp=["onClick"],up=["onClick"],cp={key:3,class:"flex items-center"},dp={key:1,class:"w-8 h-8 bg-gradient-to-r from-gray-600 to-gray-800 rounded-full flex items-center justify-center text-white text-sm font-medium flex-shrink-0"},fp=me({__name:"MessageList",props:{messages:{},renderMarkdown:{type:Function},formatTime:{type:Function}},emits:["delete-message","retry-message"],setup(e,{emit:t}){const n=e,s=t,{messageSettings:r}=nr(),o=G(()=>{const u=r.value.maxMessages;return n.messages.length<=u?n.messages:n.messages.slice(-u)}),i=u=>{window.open(u,"_blank")},a=u=>{confirm("确定要删除这条消息吗？")&&s("delete-message",u)},l=u=>{s("retry-message",u)};return(u,f)=>(v(),x("div",Kf,[n.messages.length>I(r).maxMessages?(v(),x("div",Qf,[c("div",Xf," 显示最近 "+de(I(r).maxMessages)+" 条消息，共 "+de(n.messages.length)+" 条 ",1)])):Q("",!0),(v(!0),x(Re,null,Te(o.value,d=>(v(),x("div",{key:d.id,class:te(["flex gap-4 group",d.role==="user"?"justify-end":"justify-start",I(r).messageAnimation?"message-enter-active":""])},[d.role==="assistant"?(v(),x("div",Gf," G ")):Q("",!0),c("div",{class:te(["max-w-3xl rounded-lg px-4 py-3 shadow-sm overflow-x-hidden min-w-32 flex flex-col gap-2",d.role==="user"?"bg-blue-500 text-white":"w-11/12 bg-white text-gray-800 border border-gray-200"])},[d.role==="assistant"?(v(),x("div",Yf,[I(r).enableMarkdown?(v(),x("div",{key:0,innerHTML:u.renderMarkdown(d.content),class:te(["markdown-body",I(r).codeHighlight?"":"no-highlight"])},null,10,Zf)):(v(),x("div",ep,de(d.content),1))])):(v(),x("div",tp,de(d.content),1)),d.images&&d.images.length>0?(v(),x("div",np,[(v(!0),x(Re,null,Te(d.images,(b,h)=>(v(),x("img",{key:h,src:b,class:"max-w-xs rounded-lg border shadow-sm cursor-pointer hover:shadow-md transition-shadow",alt:"上传的图片",onClick:_=>i(b)},null,8,sp))),128))])):Q("",!0),c("div",rp,[!d.isStreaming&&I(r).showTimestamp?(v(),x("div",op,de(u.formatTime(d.timestamp)),1)):!d.isStreaming&&!I(r).showTimestamp?(v(),x("div",ip)):Q("",!0),d.isStreaming?Q("",!0):(v(),x("div",ap,[d.role==="assistant"?(v(),x("button",{key:0,onClick:b=>l(d),class:"p-1.5 text-gray-400 hover:text-blue-500 hover:bg-blue-50 rounded transition-all",title:"重新生成"},[H(I(ei),{class:"w-4 h-4"})],8,lp)):Q("",!0),c("button",{onClick:b=>a(d),class:"p-1.5 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded transition-all",title:"删除消息"},[H(I(Tt),{class:"w-4 h-4"})],8,up)])),d.role==="assistant"&&d.isStreaming?(v(),x("div",cp,[H(I(zf),{class:"w-4 h-4 animate-spin"})])):Q("",!0)])],2),d.role==="user"?(v(),x("div",dp," U ")):Q("",!0)],2))),128))]))}}),pp=Xe(fp,[["__scopeId","data-v-a30cbbec"]]),hp={class:"w-[600px] flex flex-col max-w-4xl min-w-0 pl-6 pb-4"},mp={class:"border-t border-gray-200 pr-2"},gp=me({__name:"ChatWindow",props:{messages:{},isLoading:{type:Boolean},renderMarkdown:{},formatTime:{}},emits:["send-message","stop-streaming","delete-message","retry-message","model-change","clear-chat"],setup(e,{expose:t,emit:n}){const s=G(()=>r.messages.some(l=>l.isStreaming)),r=e,{messageSettings:o}=nr(),i=D(),a=()=>{Gt(()=>{i.value&&o.value.enableAutoScroll&&(i.value.scrollTop=i.value.scrollHeight)})};return Ke(()=>r.messages,()=>{o.value.enableAutoScroll&&a()},{deep:!0}),t({scrollToBottom:a}),(l,u)=>(v(),x("div",hp,[c("div",{class:"flex-1 h-full overflow-y-hidden space-y-6 pb-6",ref_key:"chatContainer",ref:i},[l.messages.length===0?(v(),Rt(qf,{key:0})):Q("",!0),H(pp,{messages:l.messages,"render-markdown":l.renderMarkdown,"format-time":l.formatTime,onDeleteMessage:u[0]||(u[0]=f=>l.$emit("delete-message",f)),onRetryMessage:u[1]||(u[1]=f=>l.$emit("retry-message",f))},null,8,["messages","render-markdown","format-time"])],512),c("div",mp,[H(Nf,{onSend:u[2]||(u[2]=f=>l.$emit("send-message",f)),onStop:u[3]||(u[3]=f=>l.$emit("stop-streaming")),disabled:l.isLoading,isStreaming:s.value},null,8,["disabled","isStreaming"])])]))}});function Kr(e){return new Worker("/web-mo/assets/editor.worker-CdtUXE0K.js",{type:"module",name:e?.name})}function bp(e){return new Worker("/web-mo/assets/ts.worker-B7gZmlIA.js",{type:"module",name:e?.name})}function yp(e){return new Worker("/web-mo/assets/html.worker-6VJ_s7f0.js",{type:"module",name:e?.name})}function vp(e){return new Worker("/web-mo/assets/tailwindcss.worker-CyO4pYLQ.js",{type:"module",name:e?.name})}function wp(e){return new Worker("/web-mo/assets/css.worker-DRKv8b94.js",{type:"module",name:e?.name})}function xp(e){return new Worker("/web-mo/assets/json.worker-C21G4-GD.js",{type:"module",name:e?.name})}function He(e){return e>47&&e<58}function Qn(e,t,n){return t=t||65,n=n||90,e&=-33,e>=t&&e<=n}function ti(e){return He(e)||Xn(e)}function Xn(e){return e===95||Qn(e)}function _p(e){return e===196||e==214||e===220||e===228||e===246||e===252}function kp(e){return e===32||e===9||e===160}function sr(e){return kp(e)||e===10||e===13}function rr(e){return e===39||e===34}class Gn{constructor(t,n,s){s==null&&typeof t=="string"&&(s=t.length),this.string=t,this.pos=this.start=n||0,this.end=s||0}eof(){return this.pos>=this.end}limit(t,n){return new Gn(this.string,t,n)}peek(){return this.string.charCodeAt(this.pos)}next(){if(this.pos<this.string.length)return this.string.charCodeAt(this.pos++)}eat(t){const n=this.peek(),s=typeof t=="function"?t(n):n===t;return s&&this.next(),s}eatWhile(t){const n=this.pos;for(;!this.eof()&&this.eat(t););return this.pos!==n}backUp(t){this.pos-=t||1}current(){return this.substring(this.start,this.pos)}substring(t,n){return this.string.slice(t,n)}error(t,n=this.pos){return new or(`${t} at ${n+1}`,n,this.string)}}class or extends Error{constructor(t,n,s){super(t),this.pos=n,this.string=s}}function Cp(e){return{tokens:e,start:0,pos:0,size:e.length}}function ut(e){return e.tokens[e.pos]}function ir(e){return e.tokens[e.pos++]}function It(e,t=e.start,n=e.pos){return e.tokens.slice(t,n)}function nt(e){return e.pos<e.size}function xe(e,t){const n=ut(e);return n&&t(n)?(e.pos++,!0):!1}function ar(e,t,n=ut(e)){n&&n.start!=null&&(t+=` at ${n.start}`);const s=new Error(t);return s.pos=n&&n.start,s}function $p(e,t={}){const n=Cp(e),s=ni(n,t);if(nt(n))throw ar(n,"Unexpected character");return s}function ni(e,t){const n={type:"TokenGroup",elements:[]};let s=n,r;const o=[];for(;nt(e)&&(r=Ap(e,t)||Sp(e,t));)if(s.elements.push(r),xe(e,Hp))o.push(s),s=r;else{if(xe(e,qp))continue;if(xe(e,Yr))do o.length&&(s=o.pop());while(xe(e,Yr))}return n}function Sp(e,t){if(xe(e,Bp)){const n=ni(e,t),s=ir(e);return Ne(s,"group",!1)&&(n.repeat=Ep(e)),n}}function Ap(e,t){let n;const s={type:"TokenElement",name:void 0,attributes:void 0,value:void 0,repeat:void 0,selfClose:!1,elements:[]};for(Rp(e,t)&&(s.name=It(e));nt(e);)if(e.start=e.pos,!s.repeat&&!gs(s)&&xe(e,Ln))s.repeat=e.tokens[e.pos-1];else if(!s.value&&si(e))s.value=ri(e);else if(n=Qr(e,"id",t)||Qr(e,"class",t)||Ip(e))s.attributes?s.attributes=s.attributes.concat(n):s.attributes=Array.isArray(n)?n.slice():[n];else{!gs(s)&&xe(e,Up)&&(s.selfClose=!0,!s.repeat&&xe(e,Ln)&&(s.repeat=e.tokens[e.pos-1]));break}return gs(s)?void 0:s}function Ip(e){if(xe(e,Dp)){const t=[];let n;for(;nt(e);)if(n=Mp(e))t.push(n);else{if(xe(e,jp))break;if(!xe(e,oi))throw ar(e,`Unexpected "${ut(e).type}" token`)}return t}}function Qr(e,t,n){if(st(ut(e),t)){e.pos++;let s=1;for(;st(ut(e),t);)e.pos++,s++;const r={name:[Fp(t)]};return s>1&&(r.multiple=!0),n.jsx&&si(e)?(r.value=ri(e),r.expression=!0):r.value=Ps(e)?It(e):void 0,r}}function Mp(e){if(Xr(e))return{value:It(e)};if(Ps(e,!0)){const t=It(e);let n;return xe(e,Tp)&&(Xr(e)||Ps(e,!0))&&(n=It(e)),{name:t,value:n}}}function Ep(e){return Ln(ut(e))?e.tokens[e.pos++]:void 0}function Xr(e){const t=e.pos,n=ut(e);if(Pn(n)){for(e.pos++;nt(e);)if(Pn(ir(e),n.single))return e.start=t,!0;throw ar(e,"Unclosed quote",n)}return!1}function Ps(e,t){const n=e.pos,s={attribute:0,expression:0,group:0};for(;nt(e);){const r=ut(e);if(s.expression)Ne(r,"expression")&&(s[r.context]+=r.open?1:-1);else{if(Pn(r)||st(r)||oi(r)||Ln(r))break;if(Ne(r)){if(!t)break;if(r.open)s[r.context]++;else if(s[r.context])s[r.context]--;else break}}e.pos++}return n!==e.pos?(e.start=n,!0):!1}function Rp(e,t){const n=e.pos;if(t.jsx&&xe(e,Gr))for(;nt(e);){const{pos:s}=e;if(!xe(e,Lp)||!xe(e,Gr)){e.pos=s;break}}for(;nt(e)&&xe(e,Pp););return e.pos!==n?(e.start=n,!0):!1}function si(e){const t=e.pos;if(xe(e,Np)){let n=0;for(;nt(e);){const s=ir(e);if(Ne(s,"expression"))if(s.open)n++;else if(n)n--;else break}return e.start=t,!0}return!1}function ri(e){let t=e.start,n=e.pos;return Ne(e.tokens[t],"expression",!0)&&t++,Ne(e.tokens[n-1],"expression",!1)&&n--,It(e,t,n)}function Ne(e,t,n){return!!(e&&e.type==="Bracket"&&(!t||e.context===t)&&(n==null||e.open===n))}function st(e,t){return!!(e&&e.type==="Operator"&&(!t||e.operator===t))}function Pn(e,t){return!!(e&&e.type==="Quote"&&(t==null||e.single===t))}function oi(e){return!!(e&&e.type==="WhiteSpace")}function Tp(e){return st(e,"equal")}function Ln(e){return!!(e&&e.type==="Repeater")}function Op(e){return e.type==="Literal"}function Gr(e){if(Op(e)){const t=e.value.charCodeAt(0);return t>=65&&t<=90}return!1}function Pp(e){return e.type==="Literal"||e.type==="RepeaterNumber"||e.type==="RepeaterPlaceholder"}function Lp(e){return st(e,"class")}function Dp(e){return Ne(e,"attribute",!0)}function jp(e){return Ne(e,"attribute",!1)}function Np(e){return Ne(e,"expression",!0)}function Bp(e){return Ne(e,"group",!0)}function Fp(e){return{type:"Literal",value:e}}function gs(e){return!e.name&&!e.value&&!e.attributes}function Hp(e){return st(e,"child")}function qp(e){return st(e,"sibling")}function Yr(e){return st(e,"climb")}function Up(e){return st(e,"close")}var K;(function(e){e[e.CurlyBracketOpen=123]="CurlyBracketOpen",e[e.CurlyBracketClose=125]="CurlyBracketClose",e[e.Escape=92]="Escape",e[e.Equals=61]="Equals",e[e.SquareBracketOpen=91]="SquareBracketOpen",e[e.SquareBracketClose=93]="SquareBracketClose",e[e.Asterisk=42]="Asterisk",e[e.Hash=35]="Hash",e[e.Dollar=36]="Dollar",e[e.Dash=45]="Dash",e[e.Dot=46]="Dot",e[e.Slash=47]="Slash",e[e.Colon=58]="Colon",e[e.Excl=33]="Excl",e[e.At=64]="At",e[e.Underscore=95]="Underscore",e[e.RoundBracketOpen=40]="RoundBracketOpen",e[e.RoundBracketClose=41]="RoundBracketClose",e[e.Sibling=43]="Sibling",e[e.Child=62]="Child",e[e.Climb=94]="Climb",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote"})(K||(K={}));function Wp(e){return e.eat(K.Escape)?(e.start=e.pos,e.eof()||e.pos++,!0):!1}function zp(e){const t=new Gn(e),n=[],s={group:0,attribute:0,expression:0,quote:0};let r=0,o;for(;!t.eof();)if(r=t.peek(),o=Vp(t,s),o)n.push(o),o.type==="Quote"?s.quote=r===s.quote?0:r:o.type==="Bracket"&&(s[o.context]+=o.open?1:-1);else throw t.error("Unexpected character");return n}function Vp(e,t){return th(e,t)||Zp(e)||eh(e)||Yp(e)||Kp(e)||Jp(e,t)||Gp(e)||Qp(e)||Xp(e)}function Jp(e,t){const n=e.pos,s=t.expression;let r="";for(;!e.eof();){if(Wp(e)){r+=e.current();continue}const o=e.peek();if(o===K.Slash&&!t.quote&&!t.expression&&!t.attribute){const i=e.string.charCodeAt(e.pos-1),a=e.string.charCodeAt(e.pos+1);if(He(i)&&He(a)){r+=e.string[e.pos++];continue}}if(o===t.quote||o===K.Dollar||nh(o,t))break;if(s){if(o===K.CurlyBracketOpen)t.expression++;else if(o===K.CurlyBracketClose)if(t.expression>s)t.expression--;else break}else if(!t.quote&&(!t.attribute&&!ih(o)||sh(o,t)||rh(o,t)||rr(o)||ii(o)))break;r+=e.string[e.pos++]}if(n!==e.pos)return e.start=n,{type:"Literal",value:r,start:n,end:e.pos}}function Kp(e){const t=e.pos;if(e.eatWhile(sr))return{type:"WhiteSpace",start:t,end:e.pos,value:e.substring(t,e.pos)}}function Qp(e){const t=e.peek();if(rr(t))return{type:"Quote",single:t===K.SingleQuote,start:e.pos++,end:e.pos}}function Xp(e){const t=e.peek(),n=ii(t);if(n)return{type:"Bracket",open:oh(t),context:n,start:e.pos++,end:e.pos}}function Gp(e){const t=ai(e.peek());if(t)return{type:"Operator",operator:t,start:e.pos++,end:e.pos}}function Yp(e){const t=e.pos;if(e.eat(K.Asterisk)){e.start=e.pos;let n=1,s=!1;return e.eatWhile(He)?n=Number(e.current()):s=!0,{type:"Repeater",count:n,value:0,implicit:s,start:t,end:e.pos}}}function Zp(e){const t=e.pos;if(e.eat(K.Dollar)&&e.eat(K.Hash))return{type:"RepeaterPlaceholder",value:void 0,start:t,end:e.pos};e.pos=t}function eh(e){const t=e.pos;if(e.eatWhile(K.Dollar)){const n=e.pos-t;let s=!1,r=1,o=0;if(e.eat(K.At)){for(;e.eat(K.Climb);)o++;s=e.eat(K.Dash),e.start=e.pos,e.eatWhile(He)&&(r=Number(e.current()))}return e.start=t,{type:"RepeaterNumber",size:n,reverse:s,base:r,parent:o,start:t,end:e.pos}}}function th(e,t){const n=e.pos;if((t.expression||t.attribute)&&e.eat(K.Dollar)&&e.eat(K.CurlyBracketOpen)){e.start=e.pos;let s,r="";if(e.eatWhile(He)?(s=Number(e.current()),r=e.eat(K.Colon)?Zr(e):""):Qn(e.peek())&&(r=Zr(e)),e.eat(K.CurlyBracketClose))return{type:"Field",index:s,name:r,start:n,end:e.pos};throw e.error("Expecting }")}e.pos=n}function Zr(e){const t=[];for(e.start=e.pos;!e.eof();)if(e.eat(K.CurlyBracketOpen))t.push(e.pos);else if(e.eat(K.CurlyBracketClose)){if(!t.length){e.pos--;break}t.pop()}else e.pos++;if(t.length)throw e.pos=t.pop(),e.error("Expecting }");return e.current()}function nh(e,t){const n=ai(e);return!n||t.quote||t.expression?!1:!t.attribute||n==="equal"}function sh(e,t){return sr(e)&&!t.expression}function rh(e,t){return e===K.Asterisk&&!t.attribute&&!t.expression}function ii(e){if(e===K.RoundBracketOpen||e===K.RoundBracketClose)return"group";if(e===K.SquareBracketOpen||e===K.SquareBracketClose)return"attribute";if(e===K.CurlyBracketOpen||e===K.CurlyBracketClose)return"expression"}function ai(e){return e===K.Child&&"child"||e===K.Sibling&&"sibling"||e===K.Climb&&"climb"||e===K.Dot&&"class"||e===K.Hash&&"id"||e===K.Slash&&"close"||e===K.Equals&&"equal"||void 0}function oh(e){return e===K.CurlyBracketOpen||e===K.SquareBracketOpen||e===K.RoundBracketOpen}function ih(e){return ti(e)||_p(e)||e===K.Dash||e===K.Colon||e===K.Excl}const ah={child:">",class:".",climb:"^",id:"#",equal:"=",close:"/",sibling:"+"},eo={Literal(e){return e.value},Quote(e){return e.single?"'":'"'},Bracket(e){return e.context==="attribute"?e.open?"[":"]":e.context==="expression"?e.open?"{":"}":e.open?"(":"}"},Operator(e){return ah[e.operator]},Field(e,t){return e.index!=null?e.name?`\${${e.index}:${e.name}}`:`\${${e.index}`:e.name?t.getVariable(e.name):""},RepeaterPlaceholder(e,t){let n;for(let s=t.repeaters.length-1;s>=0;s--)if(t.repeaters[s].implicit){n=t.repeaters[s];break}return t.inserted=!0,t.getText(n&&n.value)},RepeaterNumber(e,t){let n=1;const s=t.repeaters.length-1,r=t.repeaters[s];if(r&&(n=e.reverse?e.base+r.count-r.value-1:e.base+r.value,e.parent)){const i=Math.max(0,s-e.parent);if(i!==s){const a=t.repeaters[i];n+=r.count*a.value}}let o=String(n);for(;o.length<e.size;)o="0"+o;return o},WhiteSpace(e){return e.value}};function li(e,t){if(!eo[e.type])throw new Error(`Unknown token ${e.type}`);return eo[e.type](e,t)}const lh=/^((https?:|ftp:|file:)?\/\/|(www|ftp)\.)[^ ]*$/,uh=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,5}$/;function ch(e,t={}){let n=!1,s;t.text&&(Array.isArray(t.text)?s=t.text.filter(o=>o.trim()):s=t.text);const r={type:"Abbreviation",children:Ls(e,{inserted:!1,repeaters:[],text:t.text,cleanText:s,repeatGuard:t.maxRepeat||Number.POSITIVE_INFINITY,getText(o){var i;n=!0;let a;if(Array.isArray(t.text)){if(o!==void 0&&o>=0&&o<s.length)return s[o];a=o!==void 0?t.text[o]:t.text.join(`
`)}else a=(i=t.text)!==null&&i!==void 0?i:"";return a},getVariable(o){return(t.variables&&t.variables[o])??o}})};if(t.text!=null&&!n){const o=lr(Ot(r.children));if(o){const i=Array.isArray(t.text)?t.text.join(`
`):t.text;pi(o,i),o.name==="a"&&t.href&&fh(o,i)}}return r}function ui(e,t){let n=[];if(e.repeat){const s=e.repeat,r=Object.assign({},s);r.count=r.implicit&&Array.isArray(t.text)?t.cleanText.length:r.count||1;let o;t.repeaters.push(r);for(let i=0;i<r.count;i++){if(r.value=i,e.repeat=r,o=no(e)?Ls(e,t):to(e,t),r.implicit&&!t.inserted){const a=Ot(o),l=a&&lr(a);l&&pi(l,t.getText(r.value))}if(n=n.concat(o),--t.repeatGuard<=0)break}t.repeaters.pop(),e.repeat=s,r.implicit&&(t.inserted=!0)}else n=n.concat(no(e)?Ls(e,t):to(e,t));return n}function to(e,t){let n=[];const s={type:"AbbreviationNode",name:e.name&&ci(e.name,t),value:e.value&&di(e.value,t),attributes:void 0,children:n,repeat:e.repeat&&Object.assign({},e.repeat),selfClosing:e.selfClose};let r=[s];for(const o of e.elements)n=n.concat(ui(o,t));if(e.attributes){s.attributes=[];for(const o of e.attributes)s.attributes.push(dh(o,t))}return!s.name&&!s.attributes&&s.value&&!s.value.some(fi)?r=r.concat(n):s.children=n,r}function Ls(e,t){let n=[];for(const s of e.elements)n=n.concat(ui(s,t));return e.repeat&&(n=ph(n,e.repeat)),n}function dh(e,t){let n=!1,s=!1,r=e.expression?"expression":"raw",o;const i=e.name&&ci(e.name,t);if(i&&i[0]==="!"&&(n=!0),i&&i[i.length-1]==="."&&(s=!0),e.value){const a=e.value.slice();if(Pn(a[0])){const l=a.shift();a.length&&Ot(a).type===l.type&&a.pop(),r=l.single?"singleQuote":"doubleQuote"}else Ne(a[0],"expression",!0)&&(r="expression",a.shift(),Ne(Ot(a),"expression",!1)&&a.pop());o=di(a,t)}return{name:s||n?i.slice(n?1:0,s?-1:void 0):i,value:o,boolean:s,implied:n,valueType:r,multiple:e.multiple}}function ci(e,t){let n="";for(let s=0;s<e.length;s++)n+=li(e[s],t);return n}function di(e,t){const n=[];let s="";for(let r=0,o;r<e.length;r++)o=e[r],fi(o)?(s&&(n.push(s),s=""),n.push(o)):s+=li(o,t);return s&&n.push(s),n}function no(e){return e.type==="TokenGroup"}function fi(e){return typeof e=="object"&&e.type==="Field"&&e.index!=null}function Ot(e){return e[e.length-1]}function lr(e){return e.children.length?lr(Ot(e.children)):e}function pi(e,t){e.value?typeof Ot(e.value)=="string"?e.value[e.value.length-1]+=t:e.value.push(t):e.value=[t]}function fh(e,t){var n;let s="";lh.test(t)?(s=t,!/\w+:/.test(s)&&!s.startsWith("//")&&(s=`http://${s}`)):uh.test(t)&&(s=`mailto:${t}`);const r=(n=e.attributes)===null||n===void 0?void 0:n.find(o=>o.name==="href");r?r.value||(r.value=[s]):(e.attributes||(e.attributes=[]),e.attributes.push({name:"href",value:[s],valueType:"doubleQuote"}))}function ph(e,t){for(const n of e)n.repeat||(n.repeat=Object.assign({},t));return e}function hi(e,t){try{const n=typeof e=="string"?zp(e):e;return ch($p(n,t),t)}catch(n){throw n instanceof or&&typeof e=="string"&&(n.message+=`
${e}
${"-".repeat(n.pos)}^`),n}}var Pe;(function(e){e.Sibling="+",e.Important="!",e.ArgumentDelimiter=",",e.ValueDelimiter="-",e.PropertyDelimiter=":"})(Pe||(Pe={}));var ie;(function(e){e[e.Hash=35]="Hash",e[e.Dollar=36]="Dollar",e[e.Dash=45]="Dash",e[e.Dot=46]="Dot",e[e.Colon=58]="Colon",e[e.Comma=44]="Comma",e[e.Excl=33]="Excl",e[e.At=64]="At",e[e.Percent=37]="Percent",e[e.Underscore=95]="Underscore",e[e.RoundBracketOpen=40]="RoundBracketOpen",e[e.RoundBracketClose=41]="RoundBracketClose",e[e.CurlyBracketOpen=123]="CurlyBracketOpen",e[e.CurlyBracketClose=125]="CurlyBracketClose",e[e.Sibling=43]="Sibling",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Transparent=116]="Transparent",e[e.Slash=47]="Slash"})(ie||(ie={}));function hh(e,t){let n=0,s;const r=new Gn(e),o=[];for(;!r.eof();){if(s=mh(r,n===0&&!t),!s)throw r.error("Unexpected character");if(s.type==="Bracket"&&(!n&&s.open&&Rh(r,o),n+=s.open?1:-1,n<0))throw r.error("Unexpected bracket",s.start);o.push(s),Eh(s)&&(s=mi(r))&&o.push(s)}return o}function mh(e,t){return gh(e)||_h(e)||yh(e)||wh(e)||vh(e)||kh(e)||mi(e)||xh(e)||bh(e,t)}function gh(e){const t=e.pos;if(e.eat(ie.Dollar)&&e.eat(ie.CurlyBracketOpen)){e.start=e.pos;let n,s="";if(e.eatWhile(He)?(n=Number(e.current()),s=e.eat(ie.Colon)?so(e):""):Qn(e.peek())&&(s=so(e)),e.eat(ie.CurlyBracketClose))return{type:"Field",index:n,name:s,start:t,end:e.pos};throw e.error("Expecting }")}e.pos=t}function so(e){const t=[];for(e.start=e.pos;!e.eof();)if(e.eat(ie.CurlyBracketOpen))t.push(e.pos);else if(e.eat(ie.CurlyBracketClose)){if(!t.length){e.pos--;break}t.pop()}else e.pos++;if(t.length)throw e.pos=t.pop(),e.error("Expecting }");return e.current()}function bh(e,t){const n=e.pos;if(e.eat($h)?e.eatWhile(n?Ds:ys):e.eat(Xn)?e.eatWhile(t?ys:Ds):(e.eat(ie.Dot),e.eatWhile(ys)),n!==e.pos)return e.start=n,ur(e,e.start=n)}function ur(e,t=e.start,n=e.pos){return{type:"Literal",value:e.substring(t,n),start:t,end:n}}function yh(e){const t=e.pos;if(Ch(e)){e.start=t;const n=e.current();return e.start=e.pos,e.eat(ie.Percent)||e.eatWhile(Xn),{type:"NumberValue",value:Number(n),rawValue:n,unit:e.current(),start:t,end:e.pos}}}function vh(e){const t=e.peek(),n=e.pos;let s=!1;if(rr(t)){for(e.pos++;!e.eof();)if(e.eat(t)){s=!0;break}else e.pos++;return e.start=n,{type:"StringValue",value:e.substring(n+1,e.pos-(s?1:0)),quote:t===ie.SingleQuote?"single":"double",start:n,end:e.pos}}}function wh(e){const t=e.pos;if(e.eat(ie.Hash)){const n=e.pos;let s="",r="";if(e.eatWhile(Ah)?(s=e.substring(n,e.pos),r=bs(e)):e.eat(ie.Transparent)?(s="0",r=bs(e)||"0"):r=bs(e),s||r||e.eof()){const{r:o,g:i,b:a,a:l}=Mh(s,r);return{type:"ColorValue",r:o,g:i,b:a,a:l,raw:e.substring(t+1,e.pos),start:t,end:e.pos}}else return ur(e,t)}e.pos=t}function bs(e){const t=e.pos;return e.eat(ie.Dot)?(e.start=t,e.eatWhile(He)?e.current():"1"):""}function xh(e){const t=e.pos;if(e.eatWhile(sr))return{type:"WhiteSpace",start:t,end:e.pos}}function _h(e){const t=e.pos;if(e.eat(ie.Dash)&&e.eat(ie.Dash))return e.start=t,e.eatWhile(Ds),{type:"CustomProperty",value:e.current(),start:t,end:e.pos};e.pos=t}function kh(e){const t=e.peek();if(Ih(t))return{type:"Bracket",open:t===ie.RoundBracketOpen,start:e.pos++,end:e.pos}}function mi(e){const t=Sh(e.peek());if(t)return{type:"Operator",operator:t,start:e.pos++,end:e.pos}}function Ch(e){const t=e.pos;e.eat(ie.Dash);const n=e.pos,s=e.eatWhile(He),r=e.pos;if(e.eat(ie.Dot)){const o=e.eatWhile(He);!s&&!o&&(e.pos=r)}return e.pos===n&&(e.pos=t),e.pos!==t}function $h(e){return e===ie.At||e===ie.Dollar}function Sh(e){return e===ie.Sibling&&Pe.Sibling||e===ie.Excl&&Pe.Important||e===ie.Comma&&Pe.ArgumentDelimiter||e===ie.Colon&&Pe.PropertyDelimiter||e===ie.Dash&&Pe.ValueDelimiter||void 0}function Ah(e){return He(e)||Qn(e,65,70)}function Ds(e){return ti(e)||e===ie.Dash}function Ih(e){return e===ie.RoundBracketOpen||e===ie.RoundBracketClose}function ys(e){return Xn(e)||e===ie.Percent||e===ie.Slash}function Mh(e,t){let n="0",s="0",r="0",o=Number(t!=null&&t!==""?t:1);if(e==="t")o=0;else switch(e.length){case 0:break;case 1:n=s=r=e+e;break;case 2:n=s=r=e;break;case 3:n=e[0]+e[0],s=e[1]+e[1],r=e[2]+e[2];break;default:e+=e,n=e.slice(0,2),s=e.slice(2,4),r=e.slice(4,6)}return{r:parseInt(n,16),g:parseInt(s,16),b:parseInt(r,16),a:o}}function Eh(e){return e.type==="ColorValue"||e.type==="NumberValue"&&!e.unit}function Rh(e,t){let n=0,s=0;for(;t.length;){const r=Th(t);if(r.type==="Literal"||r.type==="NumberValue")n=r.start,s||(s=r.end),t.pop();else break}n!==s&&t.push(ur(e,n,s))}function Th(e){return e[e.length-1]}function Oh(e){return{tokens:e,start:0,pos:0,size:e.length}}function Yn(e){return e.tokens[e.pos]}function Zn(e){return e.pos<e.size}function tt(e,t){return t(Yn(e))?(e.pos++,!0):!1}function gi(e,t,n=Yn(e)){n&&n.start!=null&&(t+=` at ${n.start}`);const s=new Error(t);return s.pos=n&&n.start,s}function Ph(e,t={}){const n=Oh(e),s=[];let r;for(;Zn(n);)if(r=Lh(n,t))s.push(r);else if(!tt(n,Bh))throw gi(n,"Unexpected token");return s}function Lh(e,t){let n,s=!1,r;const o=[],i=Yn(e),a=!!t.value;for(!a&&cr(i)&&!Uh(e)&&(e.pos++,n=i.value,tt(e,wi)),a&&tt(e,dr);Zn(e);)if(tt(e,Hh))s=!0;else if(r=bi(e,a))o.push(r);else if(!tt(e,Fh))break;if(n||o.length||s)return{name:n,value:o,important:s}}function bi(e,t){const n=[];let s,r;for(;Zn(e);)if(s=Yn(e),qh(s))e.pos++,cr(s)&&(r=Dh(e))?n.push({type:"FunctionCall",name:s.value,arguments:r}):n.push(s);else if(wi(s)||t&&dr(s))e.pos++;else break;return n.length?{type:"CSSValue",value:n}:void 0}function Dh(e){const t=e.pos;if(tt(e,jh)){const n=[];let s;for(;Zn(e)&&!tt(e,Nh);)if(s=bi(e,!0))n.push(s);else if(!tt(e,dr)&&!tt(e,vi))throw gi(e,"Unexpected token");return e.start=t,n}}function cr(e){return e&&e.type==="Literal"}function yi(e,t){return e&&e.type==="Bracket"&&(t==null||e.open===t)}function jh(e){return yi(e,!0)}function Nh(e){return yi(e,!1)}function dr(e){return e&&e.type==="WhiteSpace"}function Zt(e,t){return e&&e.type==="Operator"&&(!t||e.operator===t)}function Bh(e){return Zt(e,Pe.Sibling)}function vi(e){return Zt(e,Pe.ArgumentDelimiter)}function Fh(e){return vi(e)}function Hh(e){return Zt(e,Pe.Important)}function qh(e){return e.type==="StringValue"||e.type==="ColorValue"||e.type==="NumberValue"||e.type==="Literal"||e.type==="Field"||e.type==="CustomProperty"}function wi(e){return Zt(e,Pe.PropertyDelimiter)||Zt(e,Pe.ValueDelimiter)}function Uh(e){const t=e.tokens[e.pos],n=e.tokens[e.pos+1];return t&&n&&cr(t)&&n.type==="Bracket"}function xi(e,t){try{const n=typeof e=="string"?hh(e,t&&t.value):e;return Ph(n,t)}catch(n){throw n instanceof or&&typeof e=="string"&&(n.message+=`
${e}
${"-".repeat(n.pos)}^`),n}}function Wh(e,t){if(!e.attributes)return;const n=[],s={};for(const r of e.attributes)if(r.name){const o=r.name;if(o in s){const i=s[o];o==="class"?i.value=zh(i.value,r.value," "):Vh(i,r,t)}else n.push(s[o]=Object.assign({},r))}else n.push(r);e.attributes=n}function zh(e,t,n){if(e&&t){e.length&&n&&ro(e,n);for(const r of t)ro(e,r);return e}const s=e||t;return s&&s.slice()}function Vh(e,t,n){return e.name=t.name,n.options["output.reverseAttributes"]||(e.value=t.value),e.implied||(e.implied=t.implied),e.boolean||(e.boolean=t.boolean),e.valueType!=="expression"&&(e.valueType=t.valueType),e}function ro(e,t){const n=e.length-1;typeof e[n]=="string"&&typeof t=="string"?e[n]+=t:e.push(t)}function Jh(e,t,n){const s=[e],r=o=>{t(o,s,n),s.push(o),o.children.forEach(r),s.pop()};e.children.forEach(r)}function _i(e,t){for(let n=0;n<e.children.length;n++){const s=e.children[n];if(t(s))return s;const r=_i(s,t);if(r)return r}}function Kh(e){let t;for(;e.children.length;)t=e,e=e.children[e.children.length-1];return{parent:t,node:e}}function ki(e){return e.type==="AbbreviationNode"}function Qh(e,t){const n=[],s=t.options["output.reverseAttributes"],r=o=>{const i=o.name&&t.snippets[o.name];if(!i||n.includes(i))return null;const a=hi(i,t);n.push(i),Dn(a,r),n.pop();for(const l of a.children){if(o.attributes){const u=l.attributes||[],f=o.attributes||[];l.attributes=s?f.concat(u):u.concat(f)}Xh(o,l)}return a};return Dn(e,r),e}function Dn(e,t,n){let s=[];for(const r of e.children){const o=t(r);if(o){s=s.concat(o.children);const i=Kh(o);ki(i.node)&&(i.node.children=i.node.children.concat(Dn(r,t)))}else s.push(r),r.children=Dn(r,t)}return e.children=s}function Xh(e,t){e.selfClosing&&(t.selfClosing=!0),e.value!=null&&(t.value=e.value),e.repeat&&(t.repeat=e.repeat)}const js="{",Ns="}";function Ci(e,t=0){return{options:e,value:"",level:t,offset:0,line:0,column:0}}function pe(e,t){const n=e.options["output.text"];Ai(e,n(t,e.offset,e.line,e.column))}function ue(e,t){const n=em(t);for(let s=0,r=n.length-1;s<=r;s++)pe(e,n[s]),s!==r&&ze(e,!0)}function ze(e,t){const n=e.options["output.baseIndent"],s=e.options["output.newline"];pe(e,s+n),e.line++,e.column=n.length,t&&Gh(e,t===!0?e.level:t)}function Gh(e,t=e.level){const n=e.options["output.indent"];pe(e,n.repeat(Math.max(t,0)))}function fr(e,t,n){const s=e.options["output.field"];Ai(e,s(t,n,e.offset,e.line,e.column))}function Yh(e,t){return Ii(e,t.options["output.tagCase"])}function $i(e,t){return Ii(e,t.options["output.attributeCase"])}function jn(e,t,n){return e.valueType==="expression"?n?js:Ns:t.options["output.attributeQuotes"]==="single"?"'":'"'}function Si(e,t){return e.boolean||t.options["output.booleanAttributes"].includes((e.name||"").toLowerCase())}function Zh(e){switch(e.options["output.selfClosingStyle"]){case"xhtml":return" /";case"xml":return"/";default:return""}}function Mt(e,t){return typeof e=="string"?t.options.inlineElements.includes(e.toLowerCase()):e.name?Mt(e.name,t):!!(e.value&&!e.attributes)}function em(e){return e.split(/\r\n|\r|\n/g)}function Ai(e,t){e.value+=t,e.offset+=t.length,e.column+=t.length}function Ii(e,t){return t?t==="upper"?e.toUpperCase():e.toLowerCase():e}const tm={p:"span",ul:"li",ol:"li",table:"tr",tr:"td",tbody:"tr",thead:"tr",tfoot:"tr",colgroup:"col",select:"option",optgroup:"option",audio:"source",video:"source",object:"param",map:"area"};function nm(e,t,n){!e.name&&e.attributes&&Mi(e,t,n)}function Mi(e,t,n){const s=rm(t),r=n.context?n.context.name:"",o=sm(s?s.name:r);e.name=tm[o]||(Mt(o,n)?"span":"div")}function sm(e){return(e||"").toLowerCase()}function rm(e){for(let t=e.length-1;t>=0;t--){const n=e[t];if(ki(n))return n}}var om={common:["lorem","ipsum","dolor","sit","amet","consectetur","adipisicing","elit"],words:["exercitationem","perferendis","perspiciatis","laborum","eveniet","sunt","iure","nam","nobis","eum","cum","officiis","excepturi","odio","consectetur","quasi","aut","quisquam","vel","eligendi","itaque","non","odit","tempore","quaerat","dignissimos","facilis","neque","nihil","expedita","vitae","vero","ipsum","nisi","animi","cumque","pariatur","velit","modi","natus","iusto","eaque","sequi","illo","sed","ex","et","voluptatibus","tempora","veritatis","ratione","assumenda","incidunt","nostrum","placeat","aliquid","fuga","provident","praesentium","rem","necessitatibus","suscipit","adipisci","quidem","possimus","voluptas","debitis","sint","accusantium","unde","sapiente","voluptate","qui","aspernatur","laudantium","soluta","amet","quo","aliquam","saepe","culpa","libero","ipsa","dicta","reiciendis","nesciunt","doloribus","autem","impedit","minima","maiores","repudiandae","ipsam","obcaecati","ullam","enim","totam","delectus","ducimus","quis","voluptates","dolores","molestiae","harum","dolorem","quia","voluptatem","molestias","magni","distinctio","omnis","illum","dolorum","voluptatum","ea","quas","quam","corporis","quae","blanditiis","atque","deserunt","laboriosam","earum","consequuntur","hic","cupiditate","quibusdam","accusamus","ut","rerum","error","minus","eius","ab","ad","nemo","fugit","officia","at","in","id","quos","reprehenderit","numquam","iste","fugiat","sit","inventore","beatae","repellendus","magnam","recusandae","quod","explicabo","doloremque","aperiam","consequatur","asperiores","commodi","optio","dolor","labore","temporibus","repellat","veniam","architecto","est","esse","mollitia","nulla","a","similique","eos","alias","dolore","tenetur","deleniti","porro","facere","maxime","corrupti"]},im={common:["далеко-далеко","за","словесными","горами","в стране","гласных","и согласных","живут","рыбные","тексты"],words:["вдали","от всех","они","буквенных","домах","на берегу","семантика","большого","языкового","океана","маленький","ручеек","даль","журчит","по всей","обеспечивает","ее","всеми","необходимыми","правилами","эта","парадигматическая","страна","которой","жаренные","предложения","залетают","прямо","рот","даже","всемогущая","пунктуация","не","имеет","власти","над","рыбными","текстами","ведущими","безорфографичный","образ","жизни","однажды","одна","маленькая","строчка","рыбного","текста","имени","lorem","ipsum","решила","выйти","большой","мир","грамматики","великий","оксмокс","предупреждал","о","злых","запятых","диких","знаках","вопроса","коварных","точках","запятой","но","текст","дал","сбить","себя","толку","он","собрал","семь","своих","заглавных","букв","подпоясал","инициал","за","пояс","пустился","дорогу","взобравшись","первую","вершину","курсивных","гор","бросил","последний","взгляд","назад","силуэт","своего","родного","города","буквоград","заголовок","деревни","алфавит","подзаголовок","своего","переулка","грустный","реторический","вопрос","скатился","его","щеке","продолжил","свой","путь","дороге","встретил","рукопись","она","предупредила","моей","все","переписывается","несколько","раз","единственное","что","меня","осталось","это","приставка","возвращайся","ты","лучше","свою","безопасную","страну","послушавшись","рукописи","наш","продолжил","свой","путь","вскоре","ему","повстречался","коварный","составитель","рекламных","текстов","напоивший","языком","речью","заманивший","свое","агентство","которое","использовало","снова","снова","своих","проектах","если","переписали","то","живет","там","до","сих","пор"]},am={common:["mujer","uno","dolor","más","de","poder","mismo","si"],words:["ejercicio","preferencia","perspicacia","laboral","paño","suntuoso","molde","namibia","planeador","mirar","demás","oficinista","excepción","odio","consecuencia","casi","auto","chicharra","velo","elixir","ataque","no","odio","temporal","cuórum","dignísimo","facilismo","letra","nihilista","expedición","alma","alveolar","aparte","león","animal","como","paria","belleza","modo","natividad","justo","ataque","séquito","pillo","sed","ex","y","voluminoso","temporalidad","verdades","racional","asunción","incidente","marejada","placenta","amanecer","fuga","previsor","presentación","lejos","necesariamente","sospechoso","adiposidad","quindío","pócima","voluble","débito","sintió","accesorio","falda","sapiencia","volutas","queso","permacultura","laudo","soluciones","entero","pan","litro","tonelada","culpa","libertario","mosca","dictado","reincidente","nascimiento","dolor","escolar","impedimento","mínima","mayores","repugnante","dulce","obcecado","montaña","enigma","total","deletéreo","décima","cábala","fotografía","dolores","molesto","olvido","paciencia","resiliencia","voluntad","molestias","magnífico","distinción","ovni","marejada","cerro","torre","y","abogada","manantial","corporal","agua","crepúsculo","ataque","desierto","laboriosamente","angustia","afortunado","alma","encefalograma","materialidad","cosas","o","renuncia","error","menos","conejo","abadía","analfabeto","remo","fugacidad","oficio","en","almácigo","vos","pan","represión","números","triste","refugiado","trote","inventor","corchea","repelente","magma","recusado","patrón","explícito","paloma","síndrome","inmune","autoinmune","comodidad","ley","vietnamita","demonio","tasmania","repeler","apéndice","arquitecto","columna","yugo","computador","mula","a","propósito","fantasía","alias","rayo","tenedor","deleznable","ventana","cara","anemia","corrupto"]};const oo={ru:im,sp:am,latin:om},lm=/^lorem([a-z]*)(\d*)(-\d*)?$/i;function um(e,t,n){let s;if(e.name&&(s=e.name.match(lm))){const r=oo[s[1]]||oo.latin,o=s[2]?Math.max(1,Number(s[2])):30,i=s[3]?Math.max(o,Number(s[3].slice(1))):o,a=lt(o,i),l=e.repeat||hm(t);e.name=e.attributes=void 0,e.value=[pm(r,a,!l||l.value===0)],e.repeat&&t.length>1&&Mi(e,t,n)}}function lt(e,t){return Math.floor(Math.random()*(t-e)+e)}function cm(e,t){const n=e.length,s=Math.min(n,t),r=[];for(;r.length<s;){const o=e[lt(0,n)];r.includes(o)||r.push(o)}return r}function dm(e){return e[lt(0,e.length-1)]}function io(e,t){return e.length&&(e=[fm(e[0])].concat(e.slice(1))),e.join(" ")+(t||dm("?!..."))}function fm(e){return e[0].toUpperCase()+e.slice(1)}function ao(e){if(e.length<2)return e;e=e.slice();const t=e.length,n=/,$/;let s=0;t>3&&t<=6?s=lt(0,1):t>6&&t<=12?s=lt(0,2):s=lt(1,4);for(let r=0,o;r<s;r++)o=lt(0,t-2),n.test(e[o])||(e[o]+=",");return e}function pm(e,t,n){const s=[];let r=0,o;for(n&&e.common&&(o=e.common.slice(0,t),r+=o.length,s.push(io(ao(o),".")));r<t;)o=cm(e.words,Math.min(lt(2,30),t-r)),r+=o.length,s.push(io(ao(o)));return s.join(" ")}function hm(e){for(let t=e.length-1;t>=0;t--){const n=e[t];if(n.type==="AbbreviationNode"&&n.repeat)return n.repeat}}function mm(e){bm(e.name)&&e.attributes&&(e.children.length||e.value)&&(e.attributes=e.attributes.filter(gm))}function gm(e){return e.name!=="select"}function bm(e){return e==="xsl:variable"||e==="xsl:with-param"}const Ei=/^(-+)([a-z0-9]+[a-z0-9-]*)/i,Ri=/^(_+)([a-z0-9]+[a-z0-9-_]*)/i,ym=e=>/^[a-z]\-/i.test(e),vm=e=>/^[a-z]/i.test(e);function wm(e,t,n){xm(e),_m(e,t,n)}function xm(e){const t=pr(e),n=[];for(const s of t.classNames){const r=s.indexOf("_");r>0&&!s.startsWith("-")?(n.push(s.slice(0,r)),n.push(s.slice(r))):n.push(s)}n.length&&(t.classNames=n.filter(Li),t.block=Oi(t.classNames),Pi(e,t.classNames.join(" ")))}function _m(e,t,n){const s=pr(e),r=[],{options:o}=n,i=t.slice(1).concat(e);for(let l of s.classNames){let u="",f;const d=l;(f=l.match(Ei))&&(u=lo(i,f[1].length,n.context)+o["bem.element"]+f[2],r.push(u),l=l.slice(f[0].length)),(f=l.match(Ri))&&(u||(u=lo(i,f[1].length),r.push(u)),r.push(`${u}${o["bem.modifier"]}${f[2]}`),l=l.slice(f[0].length)),l===d&&r.push(d)}const a=r.filter(Li);a.length&&Pi(e,a.join(" "))}function pr(e){if(!e._bem){let t="";if(e.attributes){for(const n of e.attributes)if(n.name==="class"&&n.value){t=Cm(n.value);break}}e._bem=Ti(t)}return e._bem}function km(e){return e._bem||(e._bem=Ti(e.attributes&&e.attributes.class||"")),e._bem}function Ti(e){const t=e?e.split(/\s+/):[];return{classNames:t,block:Oi(t)}}function lo(e,t=0,n){let s=Math.max(e.length-t,0);do{const r=e[s];if(r){const o=pr(r);if(o.block)return o.block}}while(0<s--);if(n){const r=km(n);if(r.block)return r.block}return""}function Oi(e){return uo(e,ym)||uo(e,vm)||void 0}function uo(e,t){for(const n of e){if(Ei.test(n)||Ri.test(n))break;if(t(n))return n}}function Pi(e,t){for(const n of e.attributes)if(n.name==="class"){n.value=[t];break}}function Cm(e){let t="";for(const n of e)t+=typeof n=="string"?n:n.name;return t}function Li(e,t,n){return!!e&&n.indexOf(e)===t}function $m(e){if(e.name==="label"){const t=_i(e,n=>n.name==="input"||n.name==="textarea");t&&(e.attributes&&(e.attributes=e.attributes.filter(n=>!(n.name==="for"&&co(n)))),t.attributes&&(t.attributes=t.attributes.filter(n=>!(n.name==="id"&&co(n)))))}}function co(e){if(!e.value)return!0;if(e.value.length===1){const t=e.value[0];if(t&&typeof t!="string"&&!t.name)return!0}return!1}function Di(e,t,n){const s=(o,i,a)=>{const{parent:l,current:u}=n;n.parent=u,n.current=o,t(o,i,a,n,r),n.current=u,n.parent=l},r=(o,i,a)=>{n.ancestors.push(n.current),s(o,i,a),n.ancestors.pop()};e.children.forEach(s)}function ji(e){return{current:null,parent:void 0,ancestors:[],config:e,field:1,out:Ci(e.options)}}const es=[{type:"Field",index:0,name:""}];function ht(e){return e?!e.name&&!e.attributes:!1}function fo(e,t){return e?Mt(e,t):!1}function Ni(e){return typeof e=="object"&&e.type==="Field"}function je(e,t){const{out:n}=t;let s=-1;for(const r of e)typeof r=="string"?ue(n,r):(fr(n,t.field+r.index,r.name),r.index>s&&(s=r.index));s!==-1&&(t.field+=s+1)}function Sm(e){const t=[];let n=[];for(const s of e)if(typeof s=="string"){const r=s.split(/\r\n?|\n/g);for(n.push(r.shift()||"");r.length;)t.push(n),n=[r.shift()||""]}else n.push(s);return n.length&&t.push(n),t}function Bi(e){return!e.implied||e.valueType!=="raw"||!!e.value&&e.value.length>0}var bt;(function(e){e[e.Start=91]="Start",e[e.End=93]="End",e[e.Underscore=95]="Underscore",e[e.Dash=45]="Dash"})(bt||(bt={}));function po(e){const t=[],n={pos:0,text:e};let s,r=n.pos,o=n.pos;for(;n.pos<n.text.length;)o=n.pos,(s=Am(n))?(r!==n.pos&&t.push(e.slice(r,o)),t.push(s),r=n.pos):n.pos++;return r!==n.pos&&t.push(e.slice(r)),t}function Am(e){if(vs(e)===bt.Start){const t=++e.pos;let n=t,s=t,r=1;for(;e.pos<e.text.length;){const o=vs(e);if(Fi(o)){for(n=e.pos;Im(vs(e));)e.pos++;s=e.pos}else{if(o===bt.Start)r++;else if(o===bt.End&&--r===0)return{before:e.text.slice(t,n),after:e.text.slice(s,e.pos++),name:e.text.slice(n,s)};e.pos++}}}}function vs(e,t=e.pos){return e.text.charCodeAt(t)}function Fi(e){return e>=65&&e<=90}function Im(e){return Fi(e)||e>47&&e<58||e===bt.Underscore||e===bt.Dash}function Mm(e){const{options:t}=e;return{enabled:t["comment.enabled"],trigger:t["comment.trigger"],before:t["comment.before"]?po(t["comment.before"]):void 0,after:t["comment.after"]?po(t["comment.after"]):void 0}}function Em(e,t){Hi(e,t)&&t.comment.before&&qi(e,t.comment.before,t)}function Rm(e,t){Hi(e,t)&&t.comment.after&&qi(e,t.comment.after,t)}function Hi(e,t){const{comment:n}=t;if(!n.enabled||!n.trigger||!e.name||!e.attributes)return!1;for(const s of e.attributes)if(s.name&&n.trigger.includes(s.name))return!0;return!1}function qi(e,t,n){const s={},{out:r}=n;for(const o of e.attributes)o.name&&o.value&&(s[o.name.toUpperCase()]=o.value);for(const o of t)typeof o=="string"?ue(r,o):s[o.name]&&(ue(r,o.before),je(s[o.name],n),ue(r,o.after))}const Tm=/^<([\w\-:]+)[\s>]/,Om=new Set(["for","while","of","async","await","const","let","var","continue","break","debugger","do","export","import","in","instanceof","new","return","switch","this","throw","try","catch","typeof","void","with","yield"]);function Ui(e,t){const n=ji(t);return n.comment=Mm(t),Di(e,Pm,n),n.out.value}function Pm(e,t,n,s,r){const{out:o,config:i}=s,a=Wi(e,t,n,s),l=Dm(s);if(o.level+=l,a&&ze(o,!0),e.name){const u=Yh(e.name,i);if(Em(e,s),ue(o,`<${u}`),e.attributes)for(const f of e.attributes)Bi(f)&&Lm(f,s);if(e.selfClosing&&!e.children.length&&!e.value)ue(o,`${Zh(i)}>`);else{if(ue(o,">"),!ho(e,s,r)){if(e.value){const f=e.value.some(zi)||jm(e.value,i);f&&ze(s.out,++o.level),je(e.value,s),f&&ze(s.out,--o.level)}if(e.children.forEach(r),!e.value&&!e.children.length){const f=i.options["output.formatLeafNode"]||i.options["output.formatForce"].includes(e.name);f&&ze(s.out,++o.level),je(es,s),f&&ze(s.out,--o.level)}}ue(o,`</${u}>`),Rm(e,s)}}else!ho(e,s,r)&&e.value&&(je(e.value,s),e.children.forEach(r));if(a&&t===n.length-1&&s.parent){const u=ht(s.parent)?0:1;ze(o,o.level-u)}o.level-=l}function Lm(e,t){const{out:n,config:s}=t;if(e.name){const r=s.options["markup.attributes"],o=s.options["markup.valuePrefix"];let{name:i,value:a}=e,l=jn(e,s,!0),u=jn(e,s);r&&(i=mo(i,r,e.multiple)||i),i=$i(i,s),s.options["jsx.enabled"]&&e.multiple&&(l=js,u=Ns);const f=o?mo(e.name,o,e.multiple):null;if(f&&a?.length===1&&typeof a[0]=="string"){const d=a[0];a=[Nm(d)?`${f}.${d}`:`${f}['${d}']`],s.options["jsx.enabled"]&&(l=js,u=Ns)}Si(e,s)&&!a?s.options["output.compactBoolean"]||(a=[i]):a||(a=es),ue(n," "+i),a?(ue(n,"="+l),je(a,t),ue(n,u)):s.options["output.selfClosingStyle"]!=="html"&&ue(n,"="+l+u)}}function ho(e,t,n){if(e.value&&e.children.length){const s=e.value.findIndex(Ni);if(s!==-1){je(e.value.slice(0,s),t);const r=t.out.line;let o=s+1;return e.children.forEach(n),t.out.line!==r&&typeof e.value[o]=="string"&&ue(t.out,e.value[o++].trimLeft()),je(e.value.slice(o),t),!0}}return!1}function Wi(e,t,n,s){const{config:r,parent:o}=s;if(!r.options["output.format"]||t===0&&!o||o&&ht(o)&&n.length===1)return!1;if(ht(e)&&(ht(n[t-1])||ht(n[t+1])||e.value.some(zi)||e.value.some(Ni)&&e.children.length))return!0;if(Mt(e,r)){if(t===0){for(let i=0;i<n.length;i++)if(!Mt(n[i],r))return!0}else if(!Mt(n[t-1],r))return!0;if(r.options["output.inlineBreak"]){let i=1,a=t,l=t;for(;fo(n[--a],r);)i++;for(;fo(n[++l],r);)i++;if(i>=r.options["output.inlineBreak"])return!0}for(let i=0,a=e.children.length;i<a;i++)if(Wi(e.children[i],i,e.children,s))return!0;return!1}return!0}function Dm(e){const{config:t,parent:n}=e;return!n||ht(n)||n.name&&t.options["output.formatSkip"].includes(n.name)?0:1}function zi(e){return typeof e=="string"&&/\r|\n/.test(e)}function jm(e,t){if(e.length&&typeof e[0]=="string"){const n=Tm.exec(e[0]);if(n!=null&&n.length&&!t.options.inlineElements.includes(n[1].toLowerCase()))return!0}return!1}function mo(e,t,n){return n&&t[`${e}*`]||t[e]}function Nm(e){return!Om.has(e)&&/^[a-zA-Z_$][\w_$]*$/.test(e)}function hr(e,t,n){const s=ji(t);return s.options=n||{},Di(e,Bm,s),s.out.value}function Bm(e,t,n,s,r){const{out:o,options:i}=s,{primary:a,secondary:l}=Fm(e),u=s.parent?1:0;o.level+=u,Vm(e,t,n,s)&&ze(o,!0),e.name&&(e.name!=="div"||!a.length)&&ue(o,(i.beforeName||"")+e.name+(i.afterName||"")),Hm(a,s),qm(l.filter(Bi),s),e.selfClosing&&!e.value&&!e.children.length?s.options.selfClose&&ue(o,s.options.selfClose):(Um(e,s),e.children.forEach(r)),o.level-=u}function Fm(e){const t=[],n=[];if(e.attributes)for(const s of e.attributes)Wm(s)?t.push(s):n.push(s);return{primary:t,secondary:n}}function Hm(e,t){for(const n of e)if(n.value)if(n.name==="class"){ue(t.out,".");const s=n.value.map(r=>typeof r=="string"?r.replace(/\s+/g,"."):r);je(s,t)}else ue(t.out,"#"),je(n.value,t)}function qm(e,t){if(e.length){const{out:n,config:s,options:r}=t;r.beforeAttribute&&ue(n,r.beforeAttribute);for(let o=0;o<e.length;o++){const i=e[o];ue(n,$i(i.name||"",s)),Si(i,s)&&!i.value?!s.options["output.compactBoolean"]&&r.booleanValue&&ue(n,"="+r.booleanValue):(ue(n,"="+jn(i,s,!0)),je(i.value||es,t),ue(n,jn(i,s))),o!==e.length-1&&r.glueAttribute&&ue(n,r.glueAttribute)}r.afterAttribute&&ue(n,r.afterAttribute)}}function Um(e,t){if(!e.value&&e.children.length)return;const n=e.value||es,s=Sm(n),{out:r,options:o}=t;if(s.length===1)(e.name||e.attributes)&&pe(r," "),je(n,t);else{const i=[];let a=0;for(const l of s){const u=zm(l);i.push(u),u>a&&(a=u)}r.level++;for(let l=0;l<s.length;l++)ze(r,!0),o.beforeTextLine&&pe(r,o.beforeTextLine),je(s[l],t),o.afterTextLine&&(pe(r," ".repeat(a-i[l])),pe(r,o.afterTextLine));r.level--}}function Wm(e){return e.name==="class"||e.name==="id"}function zm(e){let t=0;for(const n of e)t+=typeof n=="string"?n.length:n.name.length;return t}function Vm(e,t,n,s){return!s.parent&&t===0?!1:!ht(e)}function Jm(e,t){return hr(e,t,{beforeName:"%",beforeAttribute:"(",afterAttribute:")",glueAttribute:" ",afterTextLine:" |",booleanValue:"true",selfClose:"/"})}function Km(e,t){return hr(e,t,{beforeAttribute:" ",glueAttribute:" ",beforeTextLine:"| ",selfClose:"/"})}function Qm(e,t){return hr(e,t,{beforeAttribute:"(",afterAttribute:")",glueAttribute:", ",beforeTextLine:"| ",selfClose:t.options["output.selfClosingStyle"]==="xml"?"/":""})}const Xm={html:Ui,haml:Jm,slim:Km,pug:Qm};function Gm(e,t){let n;if(typeof e=="string"){const s=Object.assign({},t);t.options["jsx.enabled"]&&(s.jsx=!0),t.options["markup.href"]&&(s.href=!0),e=hi(e,s),n=t.text,t.text=void 0}return e=Qh(e,t),Jh(e,Zm,t),t.text=n??t.text,e}function Ym(e,t){return(Xm[t.syntax]||Ui)(e,t)}function Zm(e,t,n){nm(e,t,n),Wh(e,n),um(e,t,n),n.syntax==="xsl"&&mm(e),n.type==="markup"&&$m(e),n.options["bem.enabled"]&&wm(e,t,n)}var rt;(function(e){e.Raw="Raw",e.Property="Property"})(rt||(rt={}));const eg=/^([a-z-]+)(?:\s*:\s*([^\n\r;]+?);*)?$/,tg={value:!0};function ng(e,t){const n=t.match(eg);if(n){const s={},r=n[2]?n[2].split("|").map(og):[];for(const o of r)for(const i of o)ag(i,s);return{type:rt.Property,key:e,property:n[1],value:r,keywords:s,dependencies:[]}}return{type:rt.Raw,key:e,value:t}}function sg(e){e=e.slice().sort(rg);const t=[];let n;for(const s of e.filter(ig)){for(;t.length;){if(n=t[t.length-1],s.property.startsWith(n.property)&&s.property.charCodeAt(n.property.length)===45){n.dependencies.push(s),t.push(s);break}t.pop()}t.length||t.push(s)}return e}function rg(e,t){return e.key===t.key?0:e.key<t.key?-1:1}function og(e){return xi(e.trim(),tg)[0].value}function ig(e){return e.type===rt.Property}function ag(e,t){for(const n of e.value)if(n.type==="Literal")t[n.value]=n;else if(n.type==="FunctionCall")t[n.name]=n;else if(n.type==="Field"){const s=n.name.trim();s&&(t[s]={type:"Literal",value:s})}}function lg(e,t,n=!1){if(e=e.toLowerCase(),t=t.toLowerCase(),e===t)return 1;if(!e||!t||e.charCodeAt(0)!==t.charCodeAt(0))return 0;const s=e.length,r=t.length;if(!n&&s>r)return 0;const o=Math.min(s,r),i=Math.max(s,r);let a=1,l=1,u=i,f=0,d=0,b=!1,h=!1;for(;a<s;){for(f=e.charCodeAt(a),b=!1,h=!1;l<r;){if(d=t.charCodeAt(l),f===d){b=!0,u+=i-(h?a:l);break}h=d===45,l++}if(!b){if(!n)return 0;break}a++}const _=a/i,g=i-o,A=go(i)-go(g);return u*_/A}function go(e){return e*(e+1)/2}function Vi(e,t){return!e.r&&!e.g&&!e.b&&!e.a?"transparent":e.a===1?ug(e,t):cg(e)}function ug(e,t){const n=t&&ws(e.r)&&ws(e.g)&&ws(e.b)?dg:fg;return"#"+n(e.r)+n(e.g)+n(e.b)}function cg(e){const t=[e.r,e.g,e.b];return e.a!==1&&t.push(Ji(e.a,8)),`${t.length===3?"rgb":"rgba"}(${t.join(", ")})`}function Ji(e,t=4){return e.toFixed(t).replace(/\.?0+$/,"")}function ws(e){return!(e%17)}function dg(e){return(e>>4).toString(16)}function fg(e){return pg(e.toString(16),2)}function pg(e,t){for(;e.length<t;)e="0"+e;return e}const Nn={Section:"@@section",Property:"@@property",Value:"@@value"};function hg(e,t){var n;const s=Ci(t.options),r=t.options["output.format"];((n=t.context)===null||n===void 0?void 0:n.name)===Nn.Section&&(e=e.filter(o=>o.snippet));for(let o=0;o<e.length;o++)r&&o!==0&&ze(s,!0),mg(e[o],s,t);return s.value}function mg(e,t,n){const s=n.options["stylesheet.json"];if(e.name){const r=s?yg(e.name):e.name;ue(t,r+n.options["stylesheet.between"]),e.value.length?gg(e,t,n):fr(t,0,""),s?pe(t,","):(bo(e,t,!0),pe(t,n.options["stylesheet.after"]))}else{for(const r of e.value)for(const o of r.value)Qi(o,t,n);bo(e,t,e.value.length>0)}}function gg(e,t,n){const s=n.options["stylesheet.json"],r=s?bg(e):null;if(r&&(!r.unit||r.unit==="px"))pe(t,String(r.value));else{const o=vg(n);s&&pe(t,o);for(let i=0;i<e.value.length;i++)i!==0&&pe(t,", "),Ki(e.value[i],t,n);s&&pe(t,o)}}function bo(e,t,n){e.important&&(n&&pe(t," "),pe(t,"!important"))}function Ki(e,t,n){for(let s=0,r=-1;s<e.value.length;s++){const o=e.value[s];s!==0&&(o.type!=="Field"||o.start!==r)&&pe(t," "),Qi(o,t,n),r=o.end}}function Qi(e,t,n){if(e.type==="ColorValue")pe(t,Vi(e,n.options["stylesheet.shortHex"]));else if(e.type==="Literal"||e.type==="CustomProperty")ue(t,e.value);else if(e.type==="NumberValue")ue(t,Ji(e.value,4)+e.unit);else if(e.type==="StringValue"){const s=e.quote==="double"?'"':"'";ue(t,s+e.value+s)}else if(e.type==="Field")fr(t,e.index,e.name);else if(e.type==="FunctionCall"){pe(t,e.name+"(");for(let s=0;s<e.arguments.length;s++)s&&pe(t,", "),Ki(e.arguments[s],t,n);pe(t,")")}}function bg(e){if(e.value.length===1){const t=e.value[0];if(t.value.length===1&&t.value[0].type==="NumberValue")return t.value[0]}}function yg(e){return e.replace(/\-(\w)/g,(t,n)=>n.toUpperCase())}function vg(e){return e.options["stylesheet.jsonDoubleQuotes"]?'"':"'"}const yo="lg";function wg(e,t){var n;const s=((n=t.cache)===null||n===void 0?void 0:n.stylesheetSnippets)||xg(t.snippets);t.cache&&(t.cache.stylesheetSnippets=s),typeof e=="string"&&(e=xi(e,{value:Zi(t)}));const r=Mg(s,t);for(const o of e)_g(o,r,t);return e}function xg(e){const t=[];for(const n of Object.keys(e))t.push(ng(n,e[n]));return sg(t)}function _g(e,t,n){if(!kg(e,n)){const s=n.options["stylesheet.fuzzySearchMinScore"];if(Zi(n)){const r=n.context.name,o=t.find(i=>i.type===rt.Property&&i.property===r);Xi(e,n,o,s),e.snippet=o}else if(e.name){const r=xn(e.name,t,s,!0);e.snippet=r,r&&(r.type===rt.Property?Cg(e,r,n):$g(e,r))}}return(e.name||n.context)&&Ig(e,n),e}function kg(e,t){let n=null;const s=e.value.length===1?e.value[0]:null;if(s&&s.value.length===1){const r=s.value[0];r.type==="FunctionCall"&&r.name===yo&&(n=r)}return n||e.name===yo?(n?n=Object.assign(Object.assign({},n),{name:"linear-gradient"}):n={type:"FunctionCall",name:"linear-gradient",arguments:[Bn(ft(0,""))]},t.context||(e.name="background-image"),e.value=[Bn(n)],!0):!1}function Cg(e,t,n){const s=e.name,r=Ag(s,t.key);if(r){if(e.value.length)return e;const o=Bs(r,n,t);if(!o)return e;e.value.push(Bn(o))}if(e.name=t.property,e.value.length)Xi(e,n,t);else if(t.value.length){const o=t.value[0];e.value=t.value.length===1||o.some(Gi)?o:o.map(i=>Yi(i,n))}return e}function Xi(e,t,n,s){for(const r of e.value){const o=[];for(const i of r.value)if(i.type==="Literal")o.push(Bs(i.value,t,n,s)||i);else if(i.type==="FunctionCall"){const a=Bs(i.name,t,n,s);a&&a.type==="FunctionCall"?o.push(Object.assign(Object.assign({},a),{arguments:i.arguments.concat(a.arguments.slice(i.arguments.length))})):o.push(i)}else o.push(i);r.value=o}}function $g(e,t){let n=0,s;const r=/\$\{(\d+)(:[^}]+)?\}/g,o=e.value[0],i=[];for(;s=r.exec(t.value);)n!==s.index&&i.push(Et(t.value.slice(n,s.index))),n=s.index+s[0].length,o&&o.value.length?i.push(o.value.shift()):i.push(ft(Number(s[1]),s[2]?s[2].slice(1):""));const a=t.value.slice(n);return a&&i.push(Et(a)),e.name=void 0,e.value=[Bn(...i)],e}function xn(e,t,n=0,s=!1){let r=null,o=0;for(const i of t){const a=lg(e,Sg(i),s);if(a===1)return i;a&&a>=o&&(o=a,r=i)}return o>=n?r:null}function Sg(e){return typeof e=="string"?e:e.key}function Ag(e,t){for(let n=0,s=0;n<e.length;n++){if(s=t.indexOf(e[n],s),s===-1)return e.slice(n);s++}return""}function Bs(e,t,n,s){let r;if(n){if(r=xn(e,Object.keys(n.keywords),s))return n.keywords[r];for(const o of n.dependencies)if(r=xn(e,Object.keys(o.keywords),s))return o.keywords[r]}return(r=xn(e,t.options["stylesheet.keywords"],s))?Et(r):null}function Ig(e,t){const n=t.options["stylesheet.unitAliases"],s=t.options["stylesheet.unitless"];for(const r of e.value)for(const o of r.value)o.type==="NumberValue"&&(o.unit?o.unit=n[o.unit]||o.unit:o.value!==0&&!s.includes(e.name)&&(o.unit=o.rawValue.includes(".")?t.options["stylesheet.floatUnit"]:t.options["stylesheet.intUnit"]))}function Bn(...e){return{type:"CSSValue",value:e}}function Et(e){return{type:"Literal",value:e}}function ft(e,t){return{type:"Field",index:e,name:t}}function Gi(e){for(const t of e.value)if(t.type==="Field"||t.type==="FunctionCall"&&t.arguments.some(Gi))return!0;return!1}function Yi(e,t,n={index:1}){let s=[];for(const r of e.value)switch(r.type){case"ColorValue":s.push(ft(n.index++,Vi(r,t.options["stylesheet.shortHex"])));break;case"Literal":s.push(ft(n.index++,r.value));break;case"NumberValue":s.push(ft(n.index++,`${r.value}${r.unit}`));break;case"StringValue":const o=r.quote==="single"?"'":'"';s.push(ft(n.index++,o+r.value+o));break;case"FunctionCall":s.push(ft(n.index++,r.name),Et("("));for(let i=0,a=r.arguments.length;i<a;i++)s=s.concat(Yi(r.arguments[i],t,n).value),i!==a-1&&s.push(Et(", "));s.push(Et(")"));break;default:s.push(r)}return Object.assign(Object.assign({},e),{value:s})}function Zi(e){return e.context?e.context.name===Nn.Value||!e.context.name.startsWith("@@"):!1}function Mg(e,t){if(t.context){if(t.context.name===Nn.Section)return e.filter(n=>n.type===rt.Raw);if(t.context.name===Nn.Property)return e.filter(n=>n.type===rt.Property)}return e}var Eg={a:"a[href]","a:blank":"a[href='http://${0}' target='_blank' rel='noopener noreferrer']","a:link":"a[href='http://${0}']","a:mail":"a[href='mailto:${0}']","a:tel":"a[href='tel:+${0}']",abbr:"abbr[title]","acr|acronym":"acronym[title]",base:"base[href]/",basefont:"basefont/",br:"br/",frame:"frame/",hr:"hr/",bdo:"bdo[dir]","bdo:r":"bdo[dir=rtl]","bdo:l":"bdo[dir=ltr]",col:"col/",link:"link[rel=stylesheet href]/","link:css":"link[href='${1:style}.css']","link:print":"link[href='${1:print}.css' media=print]","link:favicon":"link[rel='shortcut icon' type=image/x-icon href='${1:favicon.ico}']","link:mf|link:manifest":"link[rel='manifest' href='${1:manifest.json}']","link:touch":"link[rel=apple-touch-icon href='${1:favicon.png}']","link:rss":"link[rel=alternate type=application/rss+xml title=RSS href='${1:rss.xml}']","link:atom":"link[rel=alternate type=application/atom+xml title=Atom href='${1:atom.xml}']","link:im|link:import":"link[rel=import href='${1:component}.html']",meta:"meta/","meta:utf":"meta[http-equiv=Content-Type content='text/html;charset=UTF-8']","meta:vp":"meta[name=viewport content='width=${1:device-width}, initial-scale=${2:1.0}']","meta:compat":"meta[http-equiv=X-UA-Compatible content='${1:IE=7}']","meta:edge":"meta:compat[content='${1:ie=edge}']","meta:redirect":"meta[http-equiv=refresh content='0; url=${1:http://example.com}']","meta:refresh":"meta[http-equiv=refresh content='${1:5}']","meta:kw":"meta[name=keywords content]","meta:desc":"meta[name=description content]",style:"style",script:"script","script:src":"script[src]","script:module":"script[type=module src]",img:"img[src alt]/","img:s|img:srcset":"img[srcset src alt]","img:z|img:sizes":"img[sizes srcset src alt]",picture:"picture","src|source":"source/","src:sc|source:src":"source[src type]","src:s|source:srcset":"source[srcset]","src:t|source:type":"source[srcset type='${1:image/}']","src:z|source:sizes":"source[sizes srcset]","src:m|source:media":"source[media='(${1:min-width: })' srcset]","src:mt|source:media:type":"source:media[type='${2:image/}']","src:mz|source:media:sizes":"source:media[sizes srcset]","src:zt|source:sizes:type":"source[sizes srcset type='${1:image/}']",iframe:"iframe[src frameborder=0]",embed:"embed[src type]/",object:"object[data type]",param:"param[name value]/",map:"map[name]",area:"area[shape coords href alt]/","area:d":"area[shape=default]","area:c":"area[shape=circle]","area:r":"area[shape=rect]","area:p":"area[shape=poly]",form:"form[action]","form:get":"form[method=get]","form:post":"form[method=post]",label:"label[for]",input:"input[type=${1:text}]/",inp:"input[name=${1} id=${1}]","input:h|input:hidden":"input[type=hidden name]","input:t|input:text":"inp[type=text]","input:search":"inp[type=search]","input:email":"inp[type=email]","input:url":"inp[type=url]","input:p|input:password":"inp[type=password]","input:datetime":"inp[type=datetime]","input:date":"inp[type=date]","input:datetime-local":"inp[type=datetime-local]","input:month":"inp[type=month]","input:week":"inp[type=week]","input:time":"inp[type=time]","input:tel":"inp[type=tel]","input:number":"inp[type=number]","input:color":"inp[type=color]","input:c|input:checkbox":"inp[type=checkbox]","input:r|input:radio":"inp[type=radio]","input:range":"inp[type=range]","input:f|input:file":"inp[type=file]","input:s|input:submit":"input[type=submit value]","input:i|input:image":"input[type=image src alt]","input:b|input:btn|input:button":"input[type=button value]","input:reset":"input:button[type=reset]",isindex:"isindex/",select:"select[name=${1} id=${1}]","select:d|select:disabled":"select[disabled.]","opt|option":"option[value]",textarea:"textarea[name=${1} id=${1}]","tarea:c|textarea:cols":"textarea[name=${1} id=${1} cols=${2:30}]","tarea:r|textarea:rows":"textarea[name=${1} id=${1} rows=${3:10}]","tarea:cr|textarea:cols:rows":"textarea[name=${1} id=${1} cols=${2:30} rows=${3:10}]",marquee:"marquee[behavior direction]","menu:c|menu:context":"menu[type=context]","menu:t|menu:toolbar":"menu[type=toolbar]",video:"video[src]",audio:"audio[src]","html:xml":"html[xmlns=http://www.w3.org/1999/xhtml]",keygen:"keygen/",command:"command/","btn:s|button:s|button:submit":"button[type=submit]","btn:r|button:r|button:reset":"button[type=reset]","btn:b|button:b|button:button":"button[type=button]","btn:d|button:d|button:disabled":"button[disabled.]","fst:d|fset:d|fieldset:d|fieldset:disabled":"fieldset[disabled.]",bq:"blockquote",fig:"figure",figc:"figcaption",pic:"picture",ifr:"iframe",emb:"embed",obj:"object",cap:"caption",colg:"colgroup",fst:"fieldset",btn:"button",optg:"optgroup",tarea:"textarea",leg:"legend",sect:"section",art:"article",hdr:"header",ftr:"footer",adr:"address",dlg:"dialog",str:"strong",prog:"progress",mn:"main",tem:"template",fset:"fieldset",datal:"datalist",kg:"keygen",out:"output",det:"details",sum:"summary",cmd:"command",data:"data[value]",meter:"meter[value]",time:"time[datetime]","ri:d|ri:dpr":"img:s","ri:v|ri:viewport":"img:z","ri:a|ri:art":"pic>src:m+img","ri:t|ri:type":"pic>src:t+img","!!!":"{<!DOCTYPE html>}",doc:"html[lang=${lang}]>(head>meta[charset=${charset}]+meta:vp+title{${1:Document}})+body","!|html:5":"!!!+doc",c:"{<!-- ${0} -->}","cc:ie":"{<!--[if IE]>${0}<![endif]-->}","cc:noie":"{<!--[if !IE]><!-->${0}<!--<![endif]-->}"},Rg={"@f":`@font-face {
	font-family: \${1};
	src: url(\${2});
}`,"@ff":"@font-face {\n	font-family: '${1:FontName}';\n	src: url('${2:FileName}.eot');\n	src: url('${2:FileName}.eot?#iefix') format('embedded-opentype'),\n		 url('${2:FileName}.woff') format('woff'),\n		 url('${2:FileName}.ttf') format('truetype'),\n		 url('${2:FileName}.svg#${1:FontName}') format('svg');\n	font-style: ${3:normal};\n	font-weight: ${4:normal};\n}","@i|@import":"@import url(${0});","@kf":"@keyframes ${1:identifier} {\n	${2}\n}","@m|@media":"@media ${1:screen} {\n	${0}\n}",ac:"align-content:start|end|flex-start|flex-end|center|space-between|space-around|stretch|space-evenly",ai:"align-items:start|end|flex-start|flex-end|center|baseline|stretch",anim:"animation:${1:name} ${2:duration} ${3:timing-function} ${4:delay} ${5:iteration-count} ${6:direction} ${7:fill-mode}",animdel:"animation-delay:time",animdir:"animation-direction:normal|reverse|alternate|alternate-reverse",animdur:"animation-duration:${1:0}s",animfm:"animation-fill-mode:both|forwards|backwards",animic:"animation-iteration-count:1|infinite",animn:"animation-name",animps:"animation-play-state:running|paused",animtf:"animation-timing-function:linear|ease|ease-in|ease-out|ease-in-out|cubic-bezier(${1:0.1}, ${2:0.7}, ${3:1.0}, ${3:0.1})",ap:"appearance:none",as:"align-self:start|end|auto|flex-start|flex-end|center|baseline|stretch",b:"bottom",bd:"border:${1:1px} ${2:solid} ${3:#000}",bdb:"border-bottom:${1:1px} ${2:solid} ${3:#000}",bdbc:"border-bottom-color:${1:#000}",bdbi:"border-bottom-image:url(${0})",bdbk:"border-break:close",bdbli:"border-bottom-left-image:url(${0})|continue",bdblrs:"border-bottom-left-radius",bdbri:"border-bottom-right-image:url(${0})|continue",bdbrrs:"border-bottom-right-radius",bdbs:"border-bottom-style",bdbw:"border-bottom-width",bdc:"border-color:${1:#000}",bdci:"border-corner-image:url(${0})|continue",bdcl:"border-collapse:collapse|separate",bdf:"border-fit:repeat|clip|scale|stretch|overwrite|overflow|space",bdi:"border-image:url(${0})",bdl:"border-left:${1:1px} ${2:solid} ${3:#000}",bdlc:"border-left-color:${1:#000}",bdlen:"border-length",bdli:"border-left-image:url(${0})",bdls:"border-left-style",bdlw:"border-left-width",bdr:"border-right:${1:1px} ${2:solid} ${3:#000}",bdrc:"border-right-color:${1:#000}",bdri:"border-right-image:url(${0})",bdrs:"border-radius",bdrst:"border-right-style",bdrw:"border-right-width",bds:"border-style:none|hidden|dotted|dashed|solid|double|dot-dash|dot-dot-dash|wave|groove|ridge|inset|outset",bdsp:"border-spacing",bdt:"border-top:${1:1px} ${2:solid} ${3:#000}",bdtc:"border-top-color:${1:#000}",bdti:"border-top-image:url(${0})",bdtli:"border-top-left-image:url(${0})|continue",bdtlrs:"border-top-left-radius",bdtri:"border-top-right-image:url(${0})|continue",bdtrrs:"border-top-right-radius",bdts:"border-top-style",bdtw:"border-top-width",bdw:"border-width",bbs:"border-block-start",bbe:"border-block-end",bis:"border-inline-start",bie:"border-inline-end",bfv:"backface-visibility:hidden|visible",bg:"background:${1:#000}","bg:n":"background: none",bga:"background-attachment:fixed|scroll",bgbk:"background-break:bounding-box|each-box|continuous",bgc:"background-color:${1:#fff}",bgcp:"background-clip:padding-box|border-box|content-box|no-clip",bgi:"background-image:url(${0})",bgo:"background-origin:padding-box|border-box|content-box",bgp:"background-position:${1:0} ${2:0}",bgpx:"background-position-x",bgpy:"background-position-y",bgr:"background-repeat:no-repeat|repeat-x|repeat-y|space|round",bgsz:"background-size:contain|cover",bs:"block-size",bxsh:"box-shadow:${1:inset }${2:hoff} ${3:voff} ${4:blur} ${5:#000}|none",bxsz:"box-sizing:border-box|content-box|border-box",c:"color:${1:#000}",cr:"color:rgb(${1:0}, ${2:0}, ${3:0})",cra:"color:rgba(${1:0}, ${2:0}, ${3:0}, ${4:.5})",cl:"clear:both|left|right|none",cm:"/* ${0} */",cnt:"content:'${0}'|normal|open-quote|no-open-quote|close-quote|no-close-quote|attr(${0})|counter(${0})|counters(${0})",coi:"counter-increment",colm:"columns",colmc:"column-count",colmf:"column-fill",colmg:"column-gap",colmr:"column-rule",colmrc:"column-rule-color",colmrs:"column-rule-style",colmrw:"column-rule-width",colms:"column-span",colmw:"column-width",cor:"counter-reset",cp:"clip:auto|rect(${1:top} ${2:right} ${3:bottom} ${4:left})",cps:"caption-side:top|bottom",cur:"cursor:pointer|auto|default|crosshair|hand|help|move|pointer|text",d:"display:block|none|flex|inline-flex|inline|inline-block|grid|inline-grid|subgrid|list-item|run-in|contents|table|inline-table|table-caption|table-column|table-column-group|table-header-group|table-footer-group|table-row|table-row-group|table-cell|ruby|ruby-base|ruby-base-group|ruby-text|ruby-text-group",ec:"empty-cells:show|hide",f:"font:${1:1em} ${2:sans-serif}",fd:"font-display:auto|block|swap|fallback|optional",fef:"font-effect:none|engrave|emboss|outline",fem:"font-emphasize",femp:"font-emphasize-position:before|after",fems:"font-emphasize-style:none|accent|dot|circle|disc",ff:"font-family:serif|sans-serif|cursive|fantasy|monospace",fft:'font-family:"Times New Roman", Times, Baskerville, Georgia, serif',ffa:'font-family:Arial, "Helvetica Neue", Helvetica, sans-serif',ffv:"font-family:Verdana, Geneva, sans-serif",fl:"float:left|right|none",fs:"font-style:italic|normal|oblique",fsm:"font-smoothing:antialiased|subpixel-antialiased|none",fst:"font-stretch:normal|ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",fv:"font-variant:normal|small-caps",fvs:"font-variation-settings:normal|inherit|initial|unset",fw:"font-weight:normal|bold|bolder|lighter",fx:"flex",fxb:"flex-basis:fill|max-content|min-content|fit-content|content",fxd:"flex-direction:row|row-reverse|column|column-reverse",fxf:"flex-flow",fxg:"flex-grow",fxsh:"flex-shrink",fxw:"flex-wrap:nowrap|wrap|wrap-reverse",fsz:"font-size",fsza:"font-size-adjust",g:"gap",gtc:"grid-template-columns:repeat(${0})|minmax()",gtr:"grid-template-rows:repeat(${0})|minmax()",gta:"grid-template-areas",gt:"grid-template",gg:"grid-gap",gcg:"grid-column-gap",grg:"grid-row-gap",gac:"grid-auto-columns:auto|minmax()",gar:"grid-auto-rows:auto|minmax()",gaf:"grid-auto-flow:row|column|dense|inherit|initial|unset",gd:"grid",gc:"grid-column",gcs:"grid-column-start",gce:"grid-column-end",gr:"grid-row",grs:"grid-row-start",gre:"grid-row-end",ga:"grid-area",h:"height",is:"inline-size",jc:"justify-content:start|end|stretch|flex-start|flex-end|center|space-between|space-around|space-evenly",ji:"justify-items:start|end|center|stretch",js:"justify-self:start|end|center|stretch",l:"left",lg:"background-image:linear-gradient(${1})",lh:"line-height",lis:"list-style",lisi:"list-style-image",lisp:"list-style-position:inside|outside",list:"list-style-type:disc|circle|square|decimal|decimal-leading-zero|lower-roman|upper-roman",lts:"letter-spacing:normal",m:"margin",mah:"max-height",mar:"max-resolution",maw:"max-width",mb:"margin-bottom",mih:"min-height",mir:"min-resolution",miw:"min-width",ml:"margin-left",mr:"margin-right",mt:"margin-top",mbs:"margin-block-start",mbe:"margin-block-end",mis:"margin-inline-start",mie:"margin-inline-end",ol:"outline",olc:"outline-color:${1:#000}|invert",olo:"outline-offset",ols:"outline-style:none|dotted|dashed|solid|double|groove|ridge|inset|outset",olw:"outline-width:thin|medium|thick","op|opa":"opacity",ord:"order",ori:"orientation:landscape|portrait",orp:"orphans",ov:"overflow:hidden|visible|hidden|scroll|auto",ovs:"overflow-style:scrollbar|auto|scrollbar|panner|move|marquee",ovx:"overflow-x:hidden|visible|hidden|scroll|auto",ovy:"overflow-y:hidden|visible|hidden|scroll|auto",p:"padding",pb:"padding-bottom",pgba:"page-break-after:auto|always|left|right",pgbb:"page-break-before:auto|always|left|right",pgbi:"page-break-inside:auto|avoid",pl:"padding-left",pos:"position:relative|absolute|relative|fixed|static",pr:"padding-right",pt:"padding-top",pbs:"padding-block-start",pbe:"padding-block-end",pis:"padding-inline-start",pie:"padding-inline-end",spbs:"scroll-padding-block-start",spbe:"scroll-padding-block-end",spis:"scroll-padding-inline-start",spie:"scroll-padding-inline-end",q:"quotes",qen:"quotes:'\\201C' '\\201D' '\\2018' '\\2019'",qru:"quotes:'\\00AB' '\\00BB' '\\201E' '\\201C'",r:"right",rsz:"resize:none|both|horizontal|vertical",t:"top",ta:"text-align:left|center|right|justify",tal:"text-align-last:left|center|right",tbl:"table-layout:fixed",td:"text-decoration:none|underline|overline|line-through",te:"text-emphasis:none|accent|dot|circle|disc|before|after",th:"text-height:auto|font-size|text-size|max-size",ti:"text-indent",tj:"text-justify:auto|inter-word|inter-ideograph|inter-cluster|distribute|kashida|tibetan",to:"text-outline:${1:0} ${2:0} ${3:#000}",tov:"text-overflow:ellipsis|clip",tr:"text-replace",trf:"transform:${1}|skewX(${1:angle})|skewY(${1:angle})|scale(${1:x}, ${2:y})|scaleX(${1:x})|scaleY(${1:y})|scaleZ(${1:z})|scale3d(${1:x}, ${2:y}, ${3:z})|rotate(${1:angle})|rotateX(${1:angle})|rotateY(${1:angle})|rotateZ(${1:angle})|translate(${1:x}, ${2:y})|translateX(${1:x})|translateY(${1:y})|translateZ(${1:z})|translate3d(${1:tx}, ${2:ty}, ${3:tz})",trfo:"transform-origin",trfs:"transform-style:preserve-3d",trs:"transition:${1:prop} ${2:time}",trsde:"transition-delay:${1:time}",trsdu:"transition-duration:${1:time}",trsp:"transition-property:${1:prop}",trstf:"transition-timing-function:${1:fn}",tsh:"text-shadow:${1:hoff} ${2:voff} ${3:blur} ${4:#000}",tt:"text-transform:uppercase|lowercase|capitalize|none",tw:"text-wrap:none|normal|unrestricted|suppress",us:"user-select:none",v:"visibility:hidden|visible|collapse",va:"vertical-align:top|super|text-top|middle|baseline|bottom|text-bottom|sub","w|wid":"width",whs:"white-space:nowrap|pre|pre-wrap|pre-line|normal",whsc:"white-space-collapse:normal|keep-all|loose|break-strict|break-all",wido:"widows",wm:"writing-mode:lr-tb|lr-tb|lr-bt|rl-tb|rl-bt|tb-rl|tb-lr|bt-lr|bt-rl",wob:"word-break:normal|keep-all|break-all",wos:"word-spacing",wow:"word-wrap:none|unrestricted|suppress|break-word|normal",z:"z-index",zom:"zoom:1"},Tg={"tm|tmatch":"xsl:template[match mode]","tn|tname":"xsl:template[name]",call:"xsl:call-template[name]",ap:"xsl:apply-templates[select mode]",api:"xsl:apply-imports",imp:"xsl:import[href]",inc:"xsl:include[href]",ch:"xsl:choose","wh|xsl:when":"xsl:when[test]",ot:"xsl:otherwise",if:"xsl:if[test]",par:"xsl:param[name]",pare:"xsl:param[name select]",var:"xsl:variable[name]",vare:"xsl:variable[name select]",wp:"xsl:with-param[name select]",key:"xsl:key[name match use]",elem:"xsl:element[name]",attr:"xsl:attribute[name]",attrs:"xsl:attribute-set[name]",cp:"xsl:copy[select]",co:"xsl:copy-of[select]",val:"xsl:value-of[select]","for|each":"xsl:for-each[select]",tex:"xsl:text",com:"xsl:comment",msg:"xsl:message[terminate=no]",fall:"xsl:fallback",num:"xsl:number[value]",nam:"namespace-alias[stylesheet-prefix result-prefix]",pres:"xsl:preserve-space[elements]",strip:"xsl:strip-space[elements]",proc:"xsl:processing-instruction[name]",sort:"xsl:sort[select order]",choose:"xsl:choose>xsl:when+xsl:otherwise",xsl:`!!!+xsl:stylesheet[version=1.0 xmlns:xsl=http://www.w3.org/1999/XSL/Transform]>{
|}`,"!!!":'{<?xml version="1.0" encoding="UTF-8"?>}'},Og={"!!!":"{doctype html}"},Pg={lang:"en",locale:"en-US",charset:"UTF-8",indentation:"	",newline:`
`};const Lg={markup:"html",stylesheet:"css"},Dg={inlineElements:["a","abbr","acronym","applet","b","basefont","bdo","big","br","button","cite","code","del","dfn","em","font","i","iframe","img","input","ins","kbd","label","map","object","q","s","samp","select","small","span","strike","strong","sub","sup","textarea","tt","u","var"],"output.indent":"	","output.baseIndent":"","output.newline":`
`,"output.tagCase":"","output.attributeCase":"","output.attributeQuotes":"double","output.format":!0,"output.formatLeafNode":!1,"output.formatSkip":["html"],"output.formatForce":["body"],"output.inlineBreak":3,"output.compactBoolean":!1,"output.booleanAttributes":["contenteditable","seamless","async","autofocus","autoplay","checked","controls","defer","disabled","formnovalidate","hidden","ismap","loop","multiple","muted","novalidate","readonly","required","reversed","selected","typemustmatch"],"output.reverseAttributes":!1,"output.selfClosingStyle":"html","output.field":(e,t)=>t,"output.text":e=>e,"markup.href":!0,"comment.enabled":!1,"comment.trigger":["id","class"],"comment.before":"","comment.after":`
<!-- /[#ID][.CLASS] -->`,"bem.enabled":!1,"bem.element":"__","bem.modifier":"_","jsx.enabled":!1,"stylesheet.keywords":["auto","inherit","unset","none"],"stylesheet.unitless":["z-index","line-height","opacity","font-weight","zoom","flex","flex-grow","flex-shrink"],"stylesheet.shortHex":!0,"stylesheet.between":": ","stylesheet.after":";","stylesheet.intUnit":"px","stylesheet.floatUnit":"em","stylesheet.unitAliases":{e:"em",p:"%",x:"ex",r:"rem"},"stylesheet.json":!1,"stylesheet.jsonDoubleQuotes":!1,"stylesheet.fuzzySearchMinScore":0},ea={type:"markup",syntax:"html",variables:Pg,snippets:{},options:Dg},vo={markup:{snippets:dn(Eg)},xhtml:{options:{"output.selfClosingStyle":"xhtml"}},xml:{options:{"output.selfClosingStyle":"xml"}},xsl:{snippets:dn(Tg),options:{"output.selfClosingStyle":"xml"}},jsx:{options:{"jsx.enabled":!0,"markup.attributes":{class:"className","class*":"styleName",for:"htmlFor"},"markup.valuePrefix":{"class*":"styles"}}},vue:{options:{"markup.attributes":{"class*":":class"}}},svelte:{options:{"jsx.enabled":!0}},pug:{snippets:dn(Og)},stylesheet:{snippets:dn(Rg)},sass:{options:{"stylesheet.after":""}},stylus:{options:{"stylesheet.between":" ","stylesheet.after":""}}};function dn(e){const t={};return Object.keys(e).forEach(n=>{for(const s of n.split("|"))t[s]=e[n]}),t}function ta(e={},t={}){const n=e.type||"markup",s=e.syntax||Lg[n];return Object.assign(Object.assign(Object.assign({},ea),e),{type:n,syntax:s,variables:xs(n,s,"variables",e,t),snippets:xs(n,s,"snippets",e,t),options:xs(n,s,"options",e,t)})}function xs(e,t,n,s,r={}){const o=vo[e],i=r[e],a=vo[t],l=r[t];return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},ea[n]),o&&o[n]),a&&a[n]),i&&i[n]),l&&l[n]),s[n])}function na(e,t=0){return{text:e,start:t,pos:e.length}}function ot(e){return e.pos===e.start}function en(e,t=0){return e.text.charCodeAt(e.pos-1+t)}function wo(e){if(!ot(e))return e.text.charCodeAt(--e.pos)}function Ee(e,t){if(ot(e))return!1;const n=typeof t=="function"?t(en(e)):t===en(e);return n&&e.pos--,!!n}function sa(e,t){const n=e.pos;for(;Ee(e,t););return e.pos<n}var tn;(function(e){e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Escape=92]="Escape"})(tn||(tn={}));function mr(e){return e===tn.SingleQuote||e===tn.DoubleQuote}function jg(e){const t=e.pos,n=wo(e);if(mr(n)){for(;!ot(e);)if(wo(e)===n&&en(e)!==tn.Escape)return!0}return e.pos=t,!1}var le;(function(e){e[e.SquareL=91]="SquareL",e[e.SquareR=93]="SquareR",e[e.RoundL=40]="RoundL",e[e.RoundR=41]="RoundR",e[e.CurlyL=123]="CurlyL",e[e.CurlyR=125]="CurlyR"})(le||(le={}));const ra={[le.SquareL]:le.SquareR,[le.RoundL]:le.RoundR,[le.CurlyL]:le.CurlyR};var $e;(function(e){e[e.Tab=9]="Tab",e[e.Space=32]="Space",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Colon=58]="Colon",e[e.Equals=61]="Equals",e[e.AngleLeft=60]="AngleLeft",e[e.AngleRight=62]="AngleRight"})($e||($e={}));function Ng(e){const t=e.pos;if(!Ee(e,$e.AngleRight))return!1;let n=!1;for(Ee(e,$e.Slash);!ot(e);){if(sa(e,Fs),Fn(e)){if(Ee(e,$e.Slash)){n=Ee(e,$e.AngleLeft);break}else if(Ee(e,$e.AngleLeft)){n=!0;break}else{if(Ee(e,Fs))continue;if(Ee(e,$e.Equals)){if(Fn(e))continue;break}else if(oa(e)){n=!0;break}}break}if(!Bg(e))break}return e.pos=t,n}function Bg(e){return Fg(e)||oa(e)}function Fg(e){const t=e.pos;return jg(e)&&Ee(e,$e.Equals)&&Fn(e)?!0:(e.pos=t,!1)}function oa(e){const t=e.pos,n=[];for(;!ot(e);){const s=en(e);if(Vg(s))n.push(s);else if(zg(s)){if(n.pop()!==ra[s])break}else if(!Wg(s))break;e.pos--}return t!==e.pos&&Ee(e,$e.Equals)&&Fn(e)?!0:(e.pos=t,!1)}function Fn(e){return sa(e,Hg)}function Hg(e){return e===$e.Colon||e===$e.Dash||qg(e)||Ug(e)}function qg(e){return e&=-33,e>=65&&e<=90}function Ug(e){return e>47&&e<58}function Fs(e){return e===$e.Space||e===$e.Tab}function Wg(e){return!isNaN(e)&&e!==$e.Equals&&!Fs(e)&&!mr(e)}function zg(e){return e===le.CurlyL||e===le.RoundL||e===le.SquareL}function Vg(e){return e===le.CurlyR||e===le.RoundR||e===le.SquareR}const ia=e=>e.charCodeAt(0),Jg="#.*:$-_!@%^+>/".split("").map(ia),Kg={type:"markup",lookAhead:!0,prefix:""};function Qg(e,t=e.length,n={}){const s=Object.assign(Object.assign({},Kg),n);t=Math.min(e.length,Math.max(0,t??e.length)),s.lookAhead&&(t=Xg(e,t,s));let r;const o=Gg(e,t,s.prefix||"");if(o===-1)return;const i=na(e,o);i.pos=t;const a=[];for(;!ot(i);){if(r=en(i),a.includes(le.CurlyR)){if(r===le.CurlyR){a.push(r),i.pos--;continue}if(r!==le.CurlyL){i.pos--;continue}}if(aa(r,s.type))a.push(r);else if(e0(r,s.type)){if(a.pop()!==ra[r])break}else if(a.includes(le.SquareR)||a.includes(le.CurlyR)){i.pos--;continue}else if(Ng(i)||!Zg(r))break;i.pos--}if(!a.length&&i.pos!==t){const l=e.slice(i.pos,t).replace(/^[*+>^]+/,"");return{abbreviation:l,location:t-l.length,start:n.prefix?o-n.prefix.length:t-l.length,end:t}}}function Xg(e,t,n){for(mr(e.charCodeAt(t))&&t++;aa(e.charCodeAt(t),n.type);)t++;return t}function Gg(e,t,n){if(!n)return 0;const s=na(e),r=n.split("").map(ia);s.pos=t;let o;for(;!ot(s);)if(!(xo(s,le.SquareR,le.SquareL)||xo(s,le.CurlyR,le.CurlyL))){if(o=s.pos,Yg(s,r))return o;s.pos--}return-1}function xo(e,t,n){const s=e.pos;if(Ee(e,t))for(;!ot(e);){if(Ee(e,n))return!0;e.pos--}return e.pos=s,!1}function Yg(e,t){const n=e.pos;let s=!1;for(let r=t.length-1;r>=0&&!ot(e)&&Ee(e,t[r]);r--)s=r===0;return s||(e.pos=n),s}function Zg(e){return e>64&&e<91||e>96&&e<123||e>47&&e<58||Jg.includes(e)}function e0(e,t){return e===le.RoundL||t==="markup"&&(e===le.SquareL||e===le.CurlyL)}function aa(e,t){return e===le.RoundR||t==="markup"&&(e===le.SquareR||e===le.CurlyR)}function la(e,t){const n=ta(t);return n.type==="stylesheet"?n0(e,n):t0(e,n)}function t0(e,t){return Ym(Gm(e,t),t)}function n0(e,t){return hg(wg(e,t),t)}const s0={html:["!",".","}","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],jade:["!",".","}",":","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],slim:["!",".","}",":","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],haml:["!",".","}",":","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],xml:[".","}","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],xsl:["!",".","}","*","$","/","]",">","0","1","2","3","4","5","6","7","8","9"],css:[":","!","-","0","1","2","3","4","5","6","7","8","9"],scss:[":","!","-","0","1","2","3","4","5","6","7","8","9"],sass:[":","!","0","1","2","3","4","5","6","7","8","9"],less:[":","!","-","0","1","2","3","4","5","6","7","8","9"],stylus:[":","!","0","1","2","3","4","5","6","7","8","9"],javascript:["!",".","}","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"],typescript:["!",".","}","*","$","]","/",">","0","1","2","3","4","5","6","7","8","9"]};function r0(e,t){const{lineNumber:n,column:s}=t,r=e.getLanguageId(),o=e.getValueInRange({startLineNumber:n,endLineNumber:n,startColumn:1,endColumn:s}),{abbreviation:i="",start:a=1}=Qg(o)||{};if(!i)return;const l={startLineNumber:n,endLineNumber:n,startColumn:a+1,endColumn:s},u=la(i,{syntax:r,options:{"output.field":(f,d)=>d?`\${${f}:${d}}`:`\${${f}}`}});return{label:i,range:l,insertText:u,kind:Le.CompletionItemKind.Property,documentation:`Emmet ${i}`,insertTextRules:Le.CompletionItemInsertTextRule.InsertAsSnippet}}function o0(e,t,n={}){t.forEach(s=>{const{snippets:r}=ta({syntax:s});e.languages.registerCompletionItemProvider(s,{triggerCharacters:s0[s],provideCompletionItems(o,i){const a=_o(o,i,r);a.push(..._o(o,i,n[s]||{}));const l=r0(o,i);return l&&a.push(l),{suggestions:a}}})})}function _o(e,t,n){const s=e.getLanguageId(),r=e.getWordUntilPosition(t),o={startLineNumber:t.lineNumber,endLineNumber:t.lineNumber,startColumn:r.startColumn,endColumn:r.endColumn},i=[];for(const[a,l]of Object.entries(n)){const u=la(l,{syntax:s,options:{"output.field":(f,d)=>d?`\${${f}:${d}}`:`\${${f}}`}});i.push({label:a,range:o,insertText:u,sortText:a,kind:Le.CompletionItemKind.Field,documentation:`Emmet snippet for ${a}`,insertTextRules:Le.CompletionItemInsertTextRule.InsertAsSnippet})}return i}const i0=()=>{a0(),l0(),u0(),o0(Yl,["html"],{html:{card:".card>.card-body{${0}}"}})},a0=()=>{et.defineTheme("tw-light",{base:"vs",inherit:!0,rules:[{foreground:"1f2937ff",token:""},{token:"comment",foreground:"9ca3afff"},{token:"string",foreground:"4f46e5ff"},{token:"number",foreground:"1f2937ff"},{token:"tag",foreground:"0284c7ff"},{token:"delimiter",foreground:"9ca3afff"},{token:"attribute.name.html",foreground:"0ea5e9ff"},{token:"attribute.value.html",foreground:"4f46e5ff"},{token:"delimiter.html",foreground:"9ca3afff"},{token:"keyword.js",foreground:"0284c7ff"},{token:"identifier.js",foreground:"1f2937ff"},{token:"attribute.name.css",foreground:"4f46e5ff"},{token:"attribute.value.unit.css",foreground:"0d9488ff"},{token:"attribute.value.number.css",foreground:"1f2937ff"},{token:"attribute.value.css",foreground:"1f2937ff"},{token:"attribute.value.hex.css",foreground:"1f2937ff"},{token:"keyword.css",foreground:"0284c7ff"},{token:"function.css",foreground:"0d9488ff"},{token:"pseudo.css",foreground:"0284c7ff"},{token:"variable.css",foreground:"1f2937ff"}],colors:{"editor.background":"#ffffff","editor.selectionBackground":"#e2e8f0ff","editor.inactiveSelectionBackground":"#e2e8f066","editorLineNumber.foreground":"#9ca3afff","editor.lineHighlightBorder":"#f1f5f9ff","editorBracketMatch.background":"#00000000","editorBracketMatch.border":"#cbd5e1ff","editorSuggestWidget.background":"#f8fafcff","editorSuggestWidget.selectedBackground":"#94a3b81a","editorSuggestWidget.selectedForeground":"#334155ff","editorSuggestWidget.foreground":"#334155ff","editorSuggestWidget.highlightForeground":"#6366f1ff","editorSuggestWidget.focusHighlightForeground":"#6366f1ff","editorHoverWidget.background":"#f8fafcff","editorError.foreground":"#ef4444ff","editorWarning.foreground":"#eab308ff"}})},l0=()=>{Le.json.jsonDefaults.setDiagnosticsOptions({validate:!0,schemas:[{uri:"http://myserver/monaco-editor-options-schema.json",fileMatch:["settings.json"],schema:{type:"object",properties:{automaticLayout:{type:"boolean",description:"编辑器是否应自动调整大小以适应其容器"},wordWrap:{type:"string",enum:["off","on","wordWrapColumn","bounded"],description:"控制自动换行的方式"},wordWrapColumn:{type:"number",description:"当 wordWrap 设置为 'wordWrapColumn' 或 'bounded' 时使用的列数"},lineNumbers:{type:"string",enum:["on","off","relative","interval"],description:"控制行号的显示方式"},lineNumbersMinChars:{type:"number",description:"控制行号的最小字符数"},readOnly:{type:"boolean",description:"编辑器是否为只读"},theme:{type:"string",enum:["vs","vs-dark","hc-black","hc-light","tw-light"],description:"编辑器主题"},cursorStyle:{type:"string",enum:["line","block","underline","line-thin","block-outline","underline-thin"],description:"控制光标样式"},cursorWidth:{type:"number",description:"控制光标宽度，仅当 cursorStyle 设置为 'line' 时有效"},cursorBlinking:{type:"string",enum:["blink","smooth","phase","expand","solid"],description:"控制光标闪烁动画"},cursorSmoothCaretAnimation:{type:"boolean",description:"启用/禁用光标平滑动画"},fontFamily:{type:"string",description:"编辑器字体系列"},fontSize:{type:"number",description:"编辑器字体大小（像素）"},fontWeight:{type:"string",description:"编辑器字体粗细"},lineHeight:{type:"number",description:"编辑器行高"},letterSpacing:{type:"number",description:"编辑器字母间距"},minimap:{type:"object",properties:{enabled:{type:"boolean"},side:{type:"string",enum:["right","left"]},showSlider:{type:"string",enum:["always","mouseover"]},maxColumn:{type:"number"},renderCharacters:{type:"boolean"},scale:{type:"number"}}},scrollbar:{type:"object",properties:{vertical:{type:"string",enum:["auto","visible","hidden"]},horizontal:{type:"string",enum:["auto","visible","hidden"]},verticalScrollbarSize:{type:"number"},horizontalScrollbarSize:{type:"number"}}},folding:{type:"boolean",description:"是否启用代码折叠"},foldingStrategy:{type:"string",enum:["auto","indentation"],description:"用于计算折叠区域的策略"},formatOnType:{type:"boolean",description:"键入时是否自动格式化"},formatOnPaste:{type:"boolean",description:"粘贴时是否自动格式化"},autoIndent:{type:"string",enum:["none","keep","brackets","advanced","full"],description:"控制编辑器的自动缩进行为"},suggestOnTriggerCharacters:{type:"boolean",description:"键入触发字符时是否显示建议"},acceptSuggestionOnEnter:{type:"string",enum:["on","smart","off"],description:"按 Enter 键时是否接受建议"},acceptSuggestionOnCommitCharacter:{type:"boolean",description:"键入提交字符时是否接受建议"},snippetSuggestions:{type:"string",enum:["top","bottom","inline","none"],description:"控制代码片段建议的显示方式"},tabCompletion:{type:"string",enum:["on","off","onlySnippets"],description:"控制 Tab 键是否完成建议"},hover:{type:"object",properties:{enabled:{type:"boolean"},delay:{type:"number"},sticky:{type:"boolean"}}},links:{type:"boolean",description:"是否检测链接并使其可点击"},colorDecorators:{type:"boolean",description:"是否显示颜色装饰器"},renderWhitespace:{type:"string",enum:["none","boundary","selection","trailing","all"]},renderControlCharacters:{type:"boolean",description:"是否渲染控制字符"},renderIndentGuides:{type:"boolean",description:"是否渲染缩进参考线"},renderLineHighlight:{type:"string",enum:["none","gutter","line","all"],description:"控制当前行高亮的渲染方式"}}}}]})},u0=()=>{self.MonacoEnvironment={getWorker(e,t){switch(t){case"editorWorkerService":return new Kr;case"css":case"less":case"scss":return new wp;case"json":return new xp;case"tailwindcss":return new vp;case"handlebars":case"html":case"razor":return new yp;case"javascript":case"typescript":return new bp;default:return new Kr}}}};let c0=`<!DOCTYPE html>
<html>
  <head>
    <title>My app</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta charset="utf-8">
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100dvh;
        font-family: "Arial", sans-serif;
        text-align: center;
      }
      .arrow {
        position: absolute;
        bottom: 32px;
        left: 0px;
        width: 100px;
        transform: rotate(30deg);
      }
      h1 {
        font-size: 50px;
      }
      h1 span {
        color: #acacac;
        font-size: 32px;
      }
      @media screen and (max-width: 640px) {
        .arrow {
          top: 12px;
          left: 56px;
          transform: rotate(180deg);
        }
      }
    </style>
  </head>
  <body>
    <h1>
      <span>I'm ready to work,</span><br />
      Ask me anything.
    </h1>
    <img src="https://enzostvs-deepsite.hf.space/arrow.svg" class="arrow" />
    <script><\/script>
  </body>
</html>
`;const ua={arrowParens:"always",bracketSameLine:!1,bracketSpacing:!0,semi:!0,experimentalTernaries:!0,singleQuote:!1,jsxSingleQuote:!1,quoteProps:"as-needed",trailingComma:"all",singleAttributePerLine:!1,htmlWhitespaceSensitivity:"css",vueIndentScriptAndStyle:!1,proseWrap:"preserve",insertPragma:!1,printWidth:120,requirePragma:!1,tabWidth:2,useTabs:!1,embeddedLanguageFormatting:"auto"};function d0(e){return new Worker("/web-mo/assets/format-DlzStJQV.js",{type:"module",name:e?.name})}const fn=async(e,t,n)=>{const s=ua,r=new d0;return new Promise(o=>{const i=Math.ceil(Math.random()*1e5);r.addEventListener("message",a=>{const{id:l,code:u}=a.data;i===l&&o(u),r.terminate()}),r.postMessage({id:i,code:e,language:t,options:s})})},f0=()=>{Le.registerDocumentFormattingEditProvider("html",{async provideDocumentFormattingEdits(e,t,n){const s=e.getValue();try{const r=await fn(s,"html");if(r&&r!==s)return[{range:e.getFullModelRange(),text:r}]}catch(r){console.error("HTML格式化失败:",r)}return[]}}),Le.registerDocumentFormattingEditProvider("javascript",{async provideDocumentFormattingEdits(e,t,n){const s=e.getValue();try{const r=await fn(s,"javascript");if(r&&r!==s)return[{range:e.getFullModelRange(),text:r}]}catch(r){console.error("JavaScript格式化失败:",r)}return[]}}),Le.registerDocumentFormattingEditProvider("typescript",{async provideDocumentFormattingEdits(e,t,n){const s=e.getValue();try{const r=await fn(s,"typescript");if(r&&r!==s)return[{range:e.getFullModelRange(),text:r}]}catch(r){console.error("TypeScript格式化失败:",r)}return[]}}),Le.registerDocumentFormattingEditProvider("css",{async provideDocumentFormattingEdits(e,t,n){const s=e.getValue();try{const r=await fn(s,"css");if(r&&r!==s)return[{range:e.getFullModelRange(),text:r}]}catch(r){console.error("CSS格式化失败:",r)}return[]}})},p0=()=>{Le.registerFoldingRangeProvider("html",{provideFoldingRanges(e,t,n){const s=e.getValue(),r=[],o=/<script\b[^>]*>([\s\S]*?)<\/script>/gi;let i;for(;(i=o.exec(s))!==null;){i.index===o.lastIndex&&o.lastIndex++;const a=e.getPositionAt(i.index).lineNumber,l=e.getPositionAt(i.index+i[0].length).lineNumber;if(l>a){r.push({start:a,end:l,kind:Le.FoldingRangeKind.Region});const u=i[1],f=i.index+i[0].indexOf(u),d=u.split(`
`);if(d.length>2){let b=-1,h=0;for(let _=0;_<d.length;_++){const g=d[_],A=e.getPositionAt(f+u.indexOf(g)).lineNumber;if(g.includes("{")&&(b===-1&&(b=A),h++),g.includes("}")&&h>0&&(h--,h===0&&b!==-1)){const $=A;$>b&&r.push({start:b,end:$,kind:Le.FoldingRangeKind.Region}),b=-1}}}}}return r}})},h0=e=>{if(!e)return;const{name:t,language:n,content:s}=e,r=Zl.parse(`file:///${t}`);let o=et.getModel(r);return o||et.createModel(s,n,r)},ca=e=>{const t=e.split(`
`);let n="",s="",r=null;for(const o of t)if(/-------\s*SEARCH/.test(o)){r="search";continue}else if(/=======/.test(o)){r="replace";continue}else{if(/\+\+\+\+\+\+\+\s*REPLACE/.test(o))break;r&&(r==="search"?n+=o+`
`:r==="replace"&&(s+=o+`
`))}return{search:n.trimEnd(),replace:s.trimEnd()}},m0=e=>{const t=[],n=e.split(/(?=-------\s*SEARCH)/);for(const s of n)if(s.trim()){const r=ca(s);r.search.trim()&&t.push(r)}return t},da=(e,t,n)=>{let s=e;if(e.includes(t))s=e.replace(t,n);else{const r=e.split(`
`),o=t.split(`
`),i=n.split(`
`);if(o.length>1){for(let a=0;a<r.length-o.length+1;a++)if(r.slice(a,a+o.length).join(`
`)===o.join(`
`)){r.splice(a,o.length,...i),s=r.join(`
`);break}}}return s},g0=(e,t)=>{let n=e,s=0;const r=[];for(const o of t){const i=n;n=da(n,o.search,o.replace),n!==i?s++:r.push(o)}return{content:n,appliedCount:s,failedBlocks:r}},b0={class:"cursor-diff-buttons"},y0=me({__name:"DiffActionButtons",props:{change:{},onAccept:{type:Function},onUndo:{type:Function}},setup(e){const t=e;G(()=>{if(!t.change)return"";const r=t.change.modifiedStartLineNumber,o=t.change.modifiedEndLineNumber;return r===o?`${r}`:`${r}-${o}`});const n=()=>{t.onAccept&&t.onAccept(t.change)},s=()=>{t.onUndo&&t.onUndo(t.change)};return(r,o)=>(v(),x("div",b0,[c("button",{class:"cursor-btn undo-btn",onClick:s,title:"Undo Change"}," Undo "),c("button",{class:"cursor-btn keep-btn",onClick:n,title:"Keep Code Suggestion"}," Keep ")]))}}),v0=Xe(y0,[["__scopeId","data-v-c5784112"]]),w0=(e={})=>{const t=D(null),n=Rs(null),s=Rs(null),r=ps(w=>{d.value&&e.onChange&&e.onChange(w)},300),o=D(e.files||[{id:1,name:"settings.json",language:"json",content:"{}"},{id:2,name:"index.html",language:"html",content:`<!DOCTYPE html>
<html>
<head>
  <title>测试页面</title>
</head>
<body>
  <h1>欢迎</h1>
  <p>这是一个测试页面</p>
</body>
</html>`}]),i=D(e.defaultFileId||o.value[1]?.id||1),a=D(!1),l=D(0),u=D([]),f=D([]),d=G(()=>o.value.find(w=>w.id===i.value)),b=()=>d.value?h0(d.value):null,h=w=>{if(!n.value)return;const{prettier:E,...L}=w;n.value.updateOptions(L);const W=o.value.find(ce=>ce.name==="settings.json");W&&(W.content=JSON.stringify(w,null,2))},_=ps(()=>{if(!(!n.value||!d.value||A.value)&&d.value.name==="settings.json")try{const w=JSON.parse(d.value.content);h(w)}catch(w){console.error("解析设置失败:",w)}},1e3),g=async()=>{n.value&&($.value=!0,await n.value.getAction("editor.action.formatDocument")?.run(),setTimeout(()=>{$.value=!1},100))};ps(g,500);const A=D(!1),$=D(!1),C=w=>{!d.value||$.value||d.value.content!==w&&(A.value=!0,d.value.content=w,e.onChange&&r(w),d.value.name==="settings.json"&&_(),setTimeout(()=>{A.value=!1},0))},z=w=>{const L=/-------\s*SEARCH[\s\S]*?\+\+\+\+\+\+\+\s*REPLACE[\s\S]*?-------\s*SEARCH/.test(w)||(w.match(/-------\s*SEARCH/g)||[]).length>1;let W=d.value?.content||"",ce="";if(L){const re=m0(w);if(re.length===0)throw new Error("未找到有效的差异内容");const fe=g0(W,re);ce=fe.content,fe.appliedCount>0?(console.log(`✅ 已成功应用 ${fe.appliedCount}/${re.length} 个替换操作`),fe.failedBlocks.length>0&&console.warn(`⚠️ ${fe.failedBlocks.length} 个替换操作失败:`,fe.failedBlocks)):console.log("所有替换操作都失败了，请检查搜索内容是否存在")}else{const{search:re,replace:fe}=ca(w);if(!re.trim())throw new Error("请输入搜索内容");ce=da(W,re,fe)}if(W!==ce)y(W,ce);else throw new Error("未找到匹配的内容进行替换")},Y=()=>{if(!s.value||!d.value)return;const w=s.value.getModifiedEditor().getValue();ee(),u.value=[],l.value=0,$.value=!0,d.value.content=w,a.value=!1,s.value.dispose(),s.value=null,n.value&&(n.value.dispose(),n.value=null),J(),e.addToHistory&&e.addToHistory(w,"差异应用"),setTimeout(()=>{$.value=!1},0)},ne=w=>{const E=o.value.find(L=>L.name==="index.html");console.log("setContent 被调用:",{content:w.substring(0,50)+"...",indexFile:E?.name,currentContent:E?.content?.substring(0,50)+"...",contentChanged:E?.content!==w}),E&&E.content!==w&&($.value=!0,E.content=w,console.log("文件内容已更新，触发 watch"),setTimeout(()=>{$.value=!1},0))},ae=()=>n.value&&!a.value?n.value.getValue():d.value?.content||"",J=()=>{if(!t.value)return;const w={theme:"tw-light",automaticLayout:!0,minimap:{enabled:!0,maxColumn:120},scrollBeyondLastLine:!1,fontSize:14,tabSize:2,fontWeight:"700",wordWrap:"off",mouseWheelZoom:!0,suggestOnTriggerCharacters:!0,quickSuggestions:!0,suggest:{showColors:!0,preview:!0,showDeprecated:!1},prettier:ua},E=o.value.find(L=>L.name==="settings.json");if(E)try{const L=JSON.parse(E.content);Object.assign(w,L)}catch(L){console.error("设置文件解析失败，使用默认设置:",L),E.content=JSON.stringify(w,null,2)}else{const L={id:Date.now(),name:"settings.json",language:"json",content:JSON.stringify(w,null,2)};o.value.unshift(L)}n.value=et.create(t.value,{model:b(),...w}),n.value.onDidChangeModelContent(()=>{if($.value)return;const L=n.value?.getValue();d.value&&L!==void 0&&d.value.content!==L&&C(L)}),n.value.addCommand(qr.CtrlCmd|Ur.KeyS,async()=>{n.value&&d.value&&(C(n.value.getValue()||""),await g())}),n.value.addCommand(qr.CtrlCmd|Ur.Comma,()=>{if(!d.value||!n.value)return;const L=i.value,W=n.value.saveViewState();i.value=i.value===1?2:1;const ce=b();if(ce){const re=o.value.find(fe=>fe.id===L);re&&(re.state=W),n.value.setModel(ce),d.value.state&&n.value.restoreViewState(d.value.state)}})},ee=()=>{if(!s.value)return;const w=s.value.getModifiedEditor();f.value.forEach(E=>{const L=E.getDomNode();L&&Hr(null,L),w.removeContentWidget(E)}),f.value=[]},se=w=>{let E=800;try{const L=w.getDomNode();if(L){const W=L.getBoundingClientRect();W.width>0&&(E=W.width,console.log("方法1: 从修改后的编辑器获取宽度",E,L))}if(E===800&&t.value){const W=t.value.getBoundingClientRect();W.width>0&&(E=W.width/2,console.log("方法2: 从容器获取宽度",E))}if(E===800){const W=t.value?.querySelectorAll(".monaco-editor");if(W&&W.length>0){const re=W[W.length-1]?.querySelector(".view-lines");if(re){const fe=re.getBoundingClientRect();fe.width>0&&(E=fe.width,console.log("方法3: 从最后一个编辑器获取宽度",E))}}}}catch(L){console.warn("获取编辑器宽度失败，使用默认值:",L),E=800}return E-40},R=w=>{if(!s.value)return;const E=s.value.getModifiedEditor(),L=w.modifiedEndLineNumber,W=se(E);if(console.log("计算得到的编辑器宽度:",W),W<=0){console.warn("编辑器宽度无效，跳过按钮创建");return}const ce=document.createElement("div");ce.style.position="absolute",ce.style.pointerEvents="auto",ce.style.zIndex="1000";const re=document.createElement("div");re.style.display="flex",re.style.width=`${W-30}px`,re.style.justifyContent="flex-end",re.style.alignItems="center",ce.appendChild(re);const fe=Kl(v0,{change:w,onAccept:Oe=>{Z(Oe)},onUndo:Oe=>{O(Oe)}});Hr(fe,re);const qe={getId:()=>`diff.action.buttons.${L}`,getDomNode:()=>ce,getPosition:()=>({position:{lineNumber:L,column:0},positionAffinity:et.PositionAffinity.RightOfInjectedText,preference:[et.ContentWidgetPositionPreference.BELOW]})};E.addContentWidget(qe),f.value.push(qe)},S=()=>{if(!a.value||!s.value)return!1;const w=s.value.getLineChanges();if(!w||w.length===0){console.log("没有检测到差异，自动退出diff模式");const E=s.value.getModifiedEditor().getValue();return ee(),u.value=[],l.value=0,$.value=!0,d.value&&(d.value.content=E),a.value=!1,s.value.dispose(),s.value=null,n.value&&(n.value.dispose(),n.value=null),J(),setTimeout(()=>{$.value=!1},0),!0}return!1},T=()=>{if(!a.value||!s.value||S())return;ee();const w=s.value.getLineChanges();w&&w.forEach(E=>{E.modifiedEndLineNumber>0&&R(E)})},Z=w=>{if(!a.value||!s.value)return;const E=s.value.getOriginalEditor().getModel(),L=s.value.getModifiedEditor().getModel();if(!E||!L)return;const W=E.getValue(),ce=L.getValue(),re=W.split(`
`),fe=ce.split(`
`),qe=w.originalStartLineNumber-1,Oe=w.originalEndLineNumber,ct=w.modifiedStartLineNumber-1,Lt=w.modifiedEndLineNumber;let Be=[];Be.push(...re.slice(0,qe)),Be.push(...fe.slice(ct,Lt)),Be.push(...re.slice(Oe));const Dt=Be.join(`
`);E.setValue(Dt),setTimeout(()=>{T(),p()},200)},O=w=>{if(!a.value||!s.value)return;const E=s.value.getOriginalEditor().getModel(),L=s.value.getModifiedEditor().getModel();if(!E||!L)return;const W=E.getValue(),ce=L.getValue(),re=W.split(`
`),fe=ce.split(`
`),qe=w.originalStartLineNumber-1,Oe=w.originalEndLineNumber,ct=w.modifiedStartLineNumber-1,Lt=w.modifiedEndLineNumber;let Be=[];Be.push(...fe.slice(0,ct)),Be.push(...re.slice(qe,Oe)),Be.push(...fe.slice(Lt));const Dt=Be.join(`
`);L.setValue(Dt),setTimeout(()=>{T(),p()},200)},j=()=>{u.value.length!==0&&(l.value=(l.value-1+u.value.length)%u.value.length,k(l.value))},q=()=>{u.value.length!==0&&(l.value=(l.value+1)%u.value.length,k(l.value))},k=w=>{if(w<0||w>=u.value.length||!s.value)return;const E=u.value[w],L=s.value.getModifiedEditor(),W=Math.max(1,E.modifiedStartLineNumber);setTimeout(()=>{L.revealLineInCenter(W);const ce=Math.max(1,L.getModel()?.getLineMaxColumn(W)||1);L.setPosition({lineNumber:W,column:Math.min(2,ce)}),L.focus()},50)},p=()=>{if(!(!a.value||!s.value))try{const w=s.value.getLineChanges()||[];if(u.value=w,w.length===0){console.log("导航器检测到无差异，自动退出diff模式");const E=s.value.getModifiedEditor().getValue();e.addToHistory&&e.addToHistory(E,"差异应用完成"),S();return}l.value=Math.min(l.value,w.length-1)}catch(w){console.error("更新导航器时出错:",w)}},y=(w,E)=>{if(!t.value)return;n.value&&(n.value.dispose(),n.value=null),a.value=!0;const L=et.createModel(w,d.value?.language||"html"),W=et.createModel(E,d.value?.language||"html");s.value=et.createDiffEditor(t.value,{readOnly:!1,renderSideBySide:!1,ignoreTrimWhitespace:!1,automaticLayout:!0}),s.value.setModel({original:L,modified:W}),setTimeout(()=>{T(),p()},100),s.value.onDidUpdateDiff(()=>{T(),p()})},P=w=>{if(i.value===w||!n.value||a.value)return;const E=d.value;E&&(E.state=n.value.saveViewState()),i.value=w};return Ke(d,(w,E)=>{if(!n.value||!w||A.value)return;const L=n.value.getValue();if(E&&w.id!==E.id){const W=b();W&&($.value=!0,n.value.setModel(W),w.state&&n.value.restoreViewState(w.state),n.value.focus(),setTimeout(()=>{$.value=!1},0))}else if(L!==w.content){console.log("检测到外部内容变化:",{editorContent:L.substring(0,50)+"...",newContent:(w.content||"").substring(0,50)+"...",isUpdatingFromExternal:$.value});const W=n.value.getPosition();$.value=!0,n.value.setValue(w.content||""),W&&n.value.setPosition(W),setTimeout(()=>{$.value=!1},0)}},{immediate:!0,deep:!0}),sn(()=>{ee(),n.value&&n.value.dispose(),s.value&&s.value.dispose()}),{container:t,files:o,fileId:i,currentFile:d,editor:n,diffEditor:s,isDiffMode:a,currentChangeIndex:l,allChanges:u,createNormalEditor:J,createDiffEditor:y,formatCurrentDocument:g,applyDiff:z,acceptAllChanges:Y,acceptSpecificChange:Z,undoSpecificChange:O,switchFile:P,setContent:ne,getContent:ae,updateCurrentFileContent:C,updateDiffButtons:T,navigateToPreviousChange:j,navigateToNextChange:q,jumpToChange:k}},x0={key:0,class:"cursor-bottom-navigation"},_0={class:"cursor-nav-container"},k0={class:"nav-section"},C0=["disabled"],$0={class:"change-counter"},S0=["disabled"],A0={class:"action-section"},I0=me({__name:"DiffBottomNavigation",props:{currentIndex:{},totalChanges:{}},emits:["previous","next","acceptAll","undoAll","close"],setup(e){return(t,n)=>t.totalChanges>0?(v(),x("div",x0,[c("div",_0,[c("div",k0,[c("button",{class:"nav-btn prev-btn",onClick:n[0]||(n[0]=s=>t.$emit("previous")),disabled:t.currentIndex===0,title:"Previous Change"},[H(I(Os),{class:"w-4 h-4"})],8,C0),c("div",$0,de(t.currentIndex+1)+" / "+de(t.totalChanges),1),c("button",{class:"nav-btn next-btn",onClick:n[1]||(n[1]=s=>t.$emit("next")),disabled:t.currentIndex===t.totalChanges-1,title:"Next Change"},[H(I(Os),{class:"w-4 h-4 rotate-180"})],8,S0)]),c("div",A0,[c("button",{class:"action-btn undo-all-btn",onClick:n[2]||(n[2]=s=>t.$emit("undoAll")),title:"Undo all"},[...n[4]||(n[4]=[Ve(" Undo all ",-1),c("span",{class:"shortcut"},"Ctrl+Shift+U",-1)])]),c("button",{class:"action-btn keep-all-btn",onClick:n[3]||(n[3]=s=>t.$emit("acceptAll")),title:"Keep all"},[...n[5]||(n[5]=[Ve(" Keep all ",-1),c("span",{class:"shortcut"},"Ctrl+A",-1)])])])])])):Q("",!0)}}),M0=Xe(I0,[["__scopeId","data-v-aac609bb"]]),E0={class:"monaco-editor-wrapper h-full flex flex-col"},R0={class:"hidden toolbar p-2 border-b flex items-center gap-2"},T0=["value"],O0={key:1,class:"text-sm text-orange-600 ml-2"},P0={key:0,class:"diff-input-area p-2 border-b"},L0={class:"flex-1 relative"},D0=me({__name:"MonacoEditor",props:{value:{},height:{default:"100%"},readonly:{type:Boolean,default:!1},addToHistory:{}},emits:["update:value"],setup(e,{expose:t,emit:n}){const s=e,r=n,o=D(),i=D(""),a=D(!1),{container:l,files:u,fileId:f,editor:d,diffEditor:b,isDiffMode:h,currentChangeIndex:_,allChanges:g,formatCurrentDocument:A,createNormalEditor:$,applyDiff:C,acceptAllChanges:z,navigateToPreviousChange:Y,navigateToNextChange:ne,switchFile:ae,setContent:J,getContent:ee}=w0({files:[{id:1,name:"settings.json",language:"json",content:"{}"},{id:2,name:"index.html",language:"html",content:s.value||c0}],onChange:j=>{r("update:value",j)},addToHistory:s.addToHistory});Qe(()=>{i0(),f0(),p0(),l.value=o.value,$()}),Ke(()=>s.value,j=>{typeof j=="string"&&J(j)});const se=()=>{ae(f.value)},R=()=>{a.value=!0},S=()=>{a.value=!1,i.value=""},T=async()=>{if(!i.value.trim()){const j=`------- SEARCH
  <title>示例页面</title>
=======
  <title>测试页面 - 已修改</title>
  <meta charset="UTF-8">
+++++++ REPLACE

------- SEARCH
  <h1>欢迎使用AI代码编辑器</h1>
=======
  <h1>欢迎来到新页面</h1>
  <p>这是一个已更新的测试页面</p>
  <footer>© 2024</footer>
+++++++ REPLACE`;try{await C(j),S()}catch(q){console.error("应用差异失败:",q)}return}try{await C(i.value),S()}catch(j){console.error("应用差异失败:",j)}},Z=()=>{if(h&&b.value){const j=b.value.getOriginalEditor().getModel();if(j){const q=b.value.getModifiedEditor().getModel();q&&q.setValue(j.getValue())}}},O=()=>{if(d.value&&b.value){const j=b.value.getModifiedEditor().getModel()?.getValue()||"";console.log("发送差异模式结束事件，最终代码:",j);const q=new CustomEvent("diffModeEnded",{detail:{finalCode:j}});window.dispatchEvent(q)}z(),a.value=!1};return t({setValue:J,addValue:j=>{const q=ee();J(q+j)},getValue:ee,openDiffInput:R,applyDiff:C,formatDocument:A}),(j,q)=>(v(),x("div",E0,[c("div",R0,[At(c("select",{"onUpdate:modelValue":q[0]||(q[0]=k=>Xl(f)?f.value=k:null),class:"px-2 py-1 border rounded text-sm",onChange:se},[(v(!0),x(Re,null,Te(I(u),k=>(v(),x("option",{key:k.id,value:k.id},de(k.name),9,T0))),128))],544),[[Ql,I(f)]]),c("button",{class:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600",onClick:q[1]||(q[1]=(...k)=>I(A)&&I(A)(...k))}," 格式化 "),c("button",{class:"px-3 py-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600",onClick:R}," 差异模式开启 "),I(h)?(v(),x("button",{key:0,class:"px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600",onClick:q[2]||(q[2]=(...k)=>I(z)&&I(z)(...k))}," 接受所有更改 ")):Q("",!0),I(h)?(v(),x("span",O0," 差异对比模式 ")):Q("",!0)]),a.value?(v(),x("div",P0,[c("div",{class:"flex gap-2 items-center mb-2"},[q[4]||(q[4]=c("label",{class:"text-sm font-medium"},"差异内容：",-1)),c("button",{class:"px-2 py-1 text-xs bg-green-500 text-white rounded hover:bg-green-600",onClick:T}," 应用差异 "),c("button",{class:"px-2 py-1 text-xs bg-gray-500 text-white rounded hover:bg-gray-600",onClick:S}," 关闭 ")]),At(c("textarea",{"onUpdate:modelValue":q[3]||(q[3]=k=>i.value=k),class:"w-full h-40 p-2 border rounded text-sm font-mono",placeholder:`------- SEARCH
搜索内容
=======
替换内容
+++++++ REPLACE`},null,512),[[Jt,i.value]])])):Q("",!0),c("div",L0,[c("div",{ref_key:"editorContainer",ref:o,class:"w-full h-full bg-gray-400"},null,512),I(h)&&I(g).length>0?(v(),Rt(M0,{key:0,currentIndex:I(_),totalChanges:I(g).length,onPrevious:I(Y),onNext:I(ne),onAcceptAll:I(z),onUndoAll:Z,onClose:O},null,8,["currentIndex","totalChanges","onPrevious","onNext","onAcceptAll"])):Q("",!0)])]))}}),j0=Xe(D0,[["__scopeId","data-v-62a9012d"]]),N0={class:"relative"},B0={class:"flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg shadow-sm"},F0={key:0,class:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full flex items-center justify-center"},H0=me({__name:"AppLogo",props:{size:{default:"medium"}},setup(e){const t=e,n=G(()=>`${{small:"w-6 h-6",medium:"w-8 h-8",large:"w-12 h-12"}[t.size]} flex items-center justify-center`),s=G(()=>`${{small:"w-3 h-3",medium:"w-4 h-4",large:"w-6 h-6"}[t.size]} text-white`);return(r,o)=>(v(),x("div",{class:te(n.value)},[c("div",N0,[c("div",B0,[H(I(tr),{class:te(s.value)},null,8,["class"])]),r.size!=="small"?(v(),x("div",F0,[...o[0]||(o[0]=[c("div",{class:"w-1.5 h-1.5 bg-white rounded-full"},null,-1)])])):Q("",!0)])],2))}}),q0={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function U0(e,t){return v(),x("svg",q0,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0"},null,-1)])])}const W0={render:U0},z0={class:"relative"},V0={class:"text-sm font-medium"},J0={key:1,class:"absolute top-full left-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto"},K0={class:"py-2"},Q0=["onClick"],X0={class:"flex items-start justify-between"},G0={class:"flex-1 min-w-0"},Y0={class:"flex items-center gap-2 mb-1"},Z0={class:"text-sm font-medium text-gray-800"},eb={class:"text-xs text-gray-500"},tb={key:0,class:"text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded-full"},nb={class:"text-xs text-gray-600 mb-2"},sb={class:"text-xs text-gray-500 font-mono bg-gray-50 p-2 rounded border max-h-16 overflow-hidden"},rb={class:"p-3 border-t border-gray-100 bg-gray-50"},ob={class:"text-xs text-gray-500"},ib=me({__name:"HistorySelector",props:{history:{},currentIndex:{}},emits:["select"],setup(e,{emit:t}){const n=e,s=t,r=D(!1),o=G(()=>n.currentIndex+1),i=G(()=>n.history),a=()=>{r.value=!r.value},l=()=>{r.value=!1},u=_=>{s("select",_),r.value=!1},f=_=>{const g=new Date(_),A=new Date;if(A.getTime()-_,g.toDateString()===A.toDateString())return g.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});const $=new Date(A);return $.setDate($.getDate()-1),g.toDateString()===$.toDateString()?"昨天 "+g.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):g.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},d=_=>{const g=_.match(/<title[^>]*>([^<]*)<\/title>/i);if(g&&g[1])return g[1].trim();const A=_.match(/<h1[^>]*>([^<]*)<\/h1>/i);return A&&A[1]?A[1].trim():"代码版本"},b=_=>{const g=_.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();return g.length>100?g.substring(0,100)+"...":g||"空内容"},h=_=>{_.key==="Escape"&&r.value&&l()};return Qe(()=>{document.addEventListener("keydown",h)}),sn(()=>{document.removeEventListener("keydown",h)}),(_,g)=>(v(),x("div",z0,[c("button",{onClick:a,class:"p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-600 flex items-center gap-2",title:"历史记录"},[H(I(W0),{class:"w-4 h-4"}),c("span",V0,"v"+de(o.value),1),H(I(er),{class:"w-3 h-3"})]),r.value?(v(),x("div",{key:0,class:"fixed inset-0 z-40",onClick:l})):Q("",!0),r.value?(v(),x("div",J0,[g[0]||(g[0]=c("div",{class:"p-3 border-b border-gray-100"},[c("h3",{class:"text-sm font-semibold text-gray-800"},"代码历史记录"),c("p",{class:"text-xs text-gray-500 mt-1"},"选择要恢复的版本")],-1)),c("div",K0,[(v(!0),x(Re,null,Te(i.value,(A,$)=>(v(),x("div",{key:$,onClick:C=>u($),class:te(["px-3 py-3 cursor-pointer transition-colors border-l-2",$===_.currentIndex?"bg-blue-50 border-blue-500":"hover:bg-gray-50 border-transparent"])},[c("div",X0,[c("div",G0,[c("div",Y0,[c("span",Z0,"v"+de($+1),1),c("span",eb,de(f(A.timestamp)),1),$===_.currentIndex?(v(),x("span",tb," 当前 ")):Q("",!0)]),c("div",nb,de(A.title||d(A.code)),1),c("div",sb,de(b(A.code)),1)])])],10,Q0))),128))]),c("div",rb,[c("div",ob,"共 "+de(i.value.length)+" 个版本",1)])])):Q("",!0)]))}}),ab=Xe(ib,[["__scopeId","data-v-dd3121dd"]]),lb={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function ub(e,t){return v(),x("svg",lb,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 0 1 8 8v2M3 10l6 6m-6-6 6-6"},null,-1)])])}const cb={render:ub},db={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function fb(e,t){return v(),x("svg",db,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 10H11a8 8 0 0 0-8 8v2m18-10-6-6m6 6-6 6"},null,-1)])])}const pb={render:fb},hb={xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"};function mb(e,t){return v(),x("svg",hb,[...t[0]||(t[0]=[c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0"},null,-1),c("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7s-8.268-2.943-9.542-7"},null,-1)])])}const gb={render:mb},bb={class:"bg-white border-b border-gray-200 px-3 py-2 flex items-center justify-between rounded-t-xl"},yb={class:"flex items-center gap-4 min-w-0 flex-1"},vb={class:"flex items-center gap-3 min-w-0"},wb=["title"],xb={class:"flex items-center gap-1 flex-shrink-0"},_b=["disabled"],kb=["disabled"],Cb={class:"flex items-center gap-2 flex-shrink-0"},$b=["disabled","title"],Sb=me({__name:"EditorHeader",props:{title:{},isPreviewMode:{type:Boolean},currentCode:{default:""},canUndo:{type:Boolean,default:!1},canRedo:{type:Boolean,default:!1},history:{default:()=>[]},currentHistoryIndex:{default:0}},emits:["toggle-preview","undo","redo","history","refresh","history-select"],setup(e,{emit:t}){const n=e,s=t,r=G(()=>{const u=n.currentCode?.toLowerCase()||"";return u.includes("<html")||u.includes("<!doctype html")}),o=G(()=>{let u="";if(n.history&&n.history.length>0&&n.currentHistoryIndex!==void 0){const f=n.history[n.currentHistoryIndex];f&&f.title&&(u=f.title)}else u=n.title;return u.length>20?u.substring(0,20)+"...":u}),i=()=>{n.isPreviewMode&&s("toggle-preview")},a=()=>{!n.isPreviewMode&&r.value&&s("toggle-preview")},l=u=>{s("history-select",u)};return(u,f)=>(v(),x("div",bb,[c("div",yb,[c("div",vb,[H(H0,{size:"large"}),c("h3",{class:"text-lg font-semibold text-gray-800 truncate max-w-48 sm:max-w-64 md:max-w-80",title:o.value},de(o.value),9,wb)]),f[3]||(f[3]=c("div",{class:"w-px h-6 bg-gray-200 flex-shrink-0"},null,-1)),c("div",xb,[H(ab,{history:u.history,"current-index":u.currentHistoryIndex,onSelect:l},null,8,["history","current-index"]),c("button",{onClick:f[0]||(f[0]=d=>u.$emit("undo")),disabled:!u.canUndo,class:te(["p-2 rounded-lg transition-colors",u.canUndo?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed"]),title:"撤销 (Ctrl+Z)"},[H(I(cb),{class:"w-4 h-4"})],10,_b),c("button",{onClick:f[1]||(f[1]=d=>u.$emit("redo")),disabled:!u.canRedo,class:te(["p-2 rounded-lg transition-colors",u.canRedo?"hover:bg-gray-100 text-gray-600":"text-gray-300 cursor-not-allowed"]),title:"恢复 (Ctrl+Y)"},[H(I(pb),{class:"w-4 h-4"})],10,kb),u.isPreviewMode?(v(),x("button",{key:0,onClick:f[2]||(f[2]=d=>u.$emit("refresh")),class:"p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-600",title:"刷新预览 (F5)"},[H(I(ei),{class:"w-4 h-4"})])):Q("",!0)])]),c("div",Cb,[c("button",{onClick:i,class:te(["px-4 py-2 text-sm font-medium rounded-lg transition-colors flex items-center gap-2",u.isPreviewMode?"text-gray-600 hover:text-gray-800 hover:bg-gray-100":"bg-blue-500 text-white shadow-sm"])},[H(I(tr),{class:"w-4 h-4"}),f[4]||(f[4]=Ve(" 代码 ",-1))],2),c("button",{onClick:a,class:te(["px-4 py-2 text-sm font-medium rounded-lg transition-colors flex items-center gap-2",u.isPreviewMode?"bg-blue-500 text-white shadow-sm":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"]),disabled:!r.value,title:r.value?"预览HTML":"只有HTML内容才能预览"},[H(I(gb),{class:"w-4 h-4"}),f[5]||(f[5]=Ve(" 预览 ",-1))],10,$b)])]))}}),Ab=Xe(Sb,[["__scopeId","data-v-7ba70c05"]]),Ib={class:"flex-1 p-4 pt-0 bg-gray-50 overflow-hidden"},Mb={class:"h-full bg-white rounded-xl border border-gray-200 shadow-sm flex flex-col overflow-hidden"},Eb={class:"flex-1 relative"},Rb={class:"h-full"},Tb={key:0,class:"absolute inset-0 z-5 bg-white"},Ob=["srcdoc"],Pb=me({__name:"CodeEditor",props:{title:{},currentCode:{},isPreviewMode:{type:Boolean},canUndo:{type:Boolean},canRedo:{type:Boolean},history:{},currentHistoryIndex:{},addToHistory:{type:Function}},emits:["update:currentCode","toggle-preview","undo","redo","history","history-select"],setup(e,{expose:t,emit:n}){const s=e,r=n,o=D(),i=D(),a=u=>{r("update:currentCode",u)},l=()=>{if(i.value){const u=i.value.getAttribute("srcdoc");i.value.setAttribute("srcdoc",""),setTimeout(()=>{i.value&&i.value.setAttribute("srcdoc",u||"")},100)}};return t({editorRef:o}),Qe(()=>{o.value}),(u,f)=>(v(),x("div",Ib,[c("div",Mb,[H(Ab,{title:u.title,"is-preview-mode":u.isPreviewMode,"current-code":u.currentCode,"can-undo":u.canUndo,"can-redo":u.canRedo,history:u.history,"current-history-index":u.currentHistoryIndex,onTogglePreview:f[0]||(f[0]=d=>u.$emit("toggle-preview")),onUndo:f[1]||(f[1]=d=>u.$emit("undo")),onRedo:f[2]||(f[2]=d=>u.$emit("redo")),onHistory:f[3]||(f[3]=d=>u.$emit("history")),onHistorySelect:f[4]||(f[4]=d=>u.$emit("history-select",d)),onRefresh:l},null,8,["title","is-preview-mode","current-code","can-undo","can-redo","history","current-history-index"]),c("div",Eb,[c("div",Rb,[H(j0,{ref_key:"editorRef",ref:o,value:u.currentCode,addToHistory:s.addToHistory,"onUpdate:value":a,class:"h-full"},null,8,["value","addToHistory"])]),u.isPreviewMode?(v(),x("div",Tb,[c("iframe",{ref_key:"previewFrame",ref:i,class:"w-full h-full border-0",srcdoc:u.currentCode},null,8,Ob)])):Q("",!0)])])]))}});function U(e,t,n,s,r){if(typeof t=="function"?e!==t||!0:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,n),n}function m(e,t,n,s){if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?s:n==="a"?s.call(e):s?s.value:t.get(e)}let fa=function(){const{crypto:e}=globalThis;if(e?.randomUUID)return fa=e.randomUUID.bind(e),e.randomUUID();const t=new Uint8Array(1),n=e?()=>e.getRandomValues(t)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,s=>(+s^n()&15>>+s/4).toString(16))};function Hs(e){return typeof e=="object"&&e!==null&&("name"in e&&e.name==="AbortError"||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}const qs=e=>{if(e instanceof Error)return e;if(typeof e=="object"&&e!==null){try{if(Object.prototype.toString.call(e)==="[object Error]"){const t=new Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return new Error(JSON.stringify(e))}catch{}}return new Error(e)};class B extends Error{}class _e extends B{constructor(t,n,s,r){super(`${_e.makeMessage(t,n,s)}`),this.status=t,this.headers=r,this.requestID=r?.get("x-request-id"),this.error=n;const o=n;this.code=o?.code,this.param=o?.param,this.type=o?.type}static makeMessage(t,n,s){const r=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):s;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,n,s,r){if(!t||!r)return new ts({message:s,cause:qs(n)});const o=n?.error;return t===400?new pa(t,o,s,r):t===401?new ha(t,o,s,r):t===403?new ma(t,o,s,r):t===404?new ga(t,o,s,r):t===409?new ba(t,o,s,r):t===422?new ya(t,o,s,r):t===429?new va(t,o,s,r):t>=500?new wa(t,o,s,r):new _e(t,o,s,r)}}class De extends _e{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class ts extends _e{constructor({message:t,cause:n}){super(void 0,void 0,t||"Connection error.",void 0),n&&(this.cause=n)}}class gr extends ts{constructor({message:t}={}){super({message:t??"Request timed out."})}}class pa extends _e{}class ha extends _e{}class ma extends _e{}class ga extends _e{}class ba extends _e{}class ya extends _e{}class va extends _e{}class wa extends _e{}class xa extends B{constructor(){super("Could not parse response content as the length limit was reached")}}class _a extends B{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Nt extends Error{constructor(t){super(t)}}const Lb=/^[a-z][a-z0-9+.-]*:/i,Db=e=>Lb.test(e);let Se=e=>(Se=Array.isArray,Se(e)),ko=Se;function ka(e){return typeof e!="object"?{}:e??{}}function jb(e){if(!e)return!0;for(const t in e)return!1;return!0}function Nb(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function _s(e){return e!=null&&typeof e=="object"&&!Array.isArray(e)}const Bb=(e,t)=>{if(typeof t!="number"||!Number.isInteger(t))throw new B(`${e} must be an integer`);if(t<0)throw new B(`${e} must be a positive integer`);return t},Fb=e=>{try{return JSON.parse(e)}catch{return}},rn=e=>new Promise(t=>setTimeout(t,e)),_t="5.20.0",Hb=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function qb(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const Ub=()=>{const e=qb();if(e==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":$o(Deno.build.os),"X-Stainless-Arch":Co(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(e==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":$o(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Co(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const t=Wb();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Wb(){if(typeof navigator>"u"||!navigator)return null;const e=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:t,pattern:n}of e){const s=n.exec(navigator.userAgent);if(s){const r=s[1]||0,o=s[2]||0,i=s[3]||0;return{browser:t,version:`${r}.${o}.${i}`}}}return null}const Co=e=>e==="x32"?"x32":e==="x86_64"||e==="x64"?"x64":e==="arm"?"arm":e==="aarch64"||e==="arm64"?"arm64":e?`other:${e}`:"unknown",$o=e=>(e=e.toLowerCase(),e.includes("ios")?"iOS":e==="android"?"Android":e==="darwin"?"MacOS":e==="win32"?"Windows":e==="freebsd"?"FreeBSD":e==="openbsd"?"OpenBSD":e==="linux"?"Linux":e?`Other:${e}`:"Unknown");let So;const zb=()=>So??(So=Ub());function Vb(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function Ca(...e){const t=globalThis.ReadableStream;if(typeof t>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function $a(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return Ca({start(){},async pull(n){const{done:s,value:r}=await t.next();s?n.close():n.enqueue(r)},async cancel(){await t.return?.()}})}function Sa(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{const n=await t.read();return n?.done&&t.releaseLock(),n}catch(n){throw t.releaseLock(),n}},async return(){const n=t.cancel();return t.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function Jb(e){if(e===null||typeof e!="object")return;if(e[Symbol.asyncIterator]){await e[Symbol.asyncIterator]().return?.();return}const t=e.getReader(),n=t.cancel();t.releaseLock(),await n}const Kb=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),Aa="RFC3986",Ia=e=>String(e),Ao={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:Ia},Qb="RFC1738";let Us=(e,t)=>(Us=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),Us(e,t));const Ue=(()=>{const e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})(),ks=1024,Xb=(e,t,n,s,r)=>{if(e.length===0)return e;let o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(a){return"%26%23"+parseInt(a.slice(2),16)+"%3B"});let i="";for(let a=0;a<o.length;a+=ks){const l=o.length>=ks?o.slice(a,a+ks):o,u=[];for(let f=0;f<l.length;++f){let d=l.charCodeAt(f);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||r===Qb&&(d===40||d===41)){u[u.length]=l.charAt(f);continue}if(d<128){u[u.length]=Ue[d];continue}if(d<2048){u[u.length]=Ue[192|d>>6]+Ue[128|d&63];continue}if(d<55296||d>=57344){u[u.length]=Ue[224|d>>12]+Ue[128|d>>6&63]+Ue[128|d&63];continue}f+=1,d=65536+((d&1023)<<10|l.charCodeAt(f)&1023),u[u.length]=Ue[240|d>>18]+Ue[128|d>>12&63]+Ue[128|d>>6&63]+Ue[128|d&63]}i+=u.join("")}return i};function Gb(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}function Io(e,t){if(Se(e)){const n=[];for(let s=0;s<e.length;s+=1)n.push(t(e[s]));return n}return t(e)}const Ma={brackets(e){return String(e)+"[]"},comma:"comma",indices(e,t){return String(e)+"["+t+"]"},repeat(e){return String(e)}},Ea=function(e,t){Array.prototype.push.apply(e,Se(t)?t:[t])};let Mo;const be={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Xb,encodeValuesOnly:!1,format:Aa,formatter:Ia,indices:!1,serializeDate(e){return(Mo??(Mo=Function.prototype.call.bind(Date.prototype.toISOString)))(e)},skipNulls:!1,strictNullHandling:!1};function Yb(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"}const Cs={};function Ra(e,t,n,s,r,o,i,a,l,u,f,d,b,h,_,g,A,$){let C=e,z=$,Y=0,ne=!1;for(;(z=z.get(Cs))!==void 0&&!ne;){const R=z.get(e);if(Y+=1,typeof R<"u"){if(R===Y)throw new RangeError("Cyclic object value");ne=!0}typeof z.get(Cs)>"u"&&(Y=0)}if(typeof u=="function"?C=u(t,C):C instanceof Date?C=b?.(C):n==="comma"&&Se(C)&&(C=Io(C,function(R){return R instanceof Date?b?.(R):R})),C===null){if(o)return l&&!g?l(t,be.encoder,A,"key",h):t;C=""}if(Yb(C)||Gb(C)){if(l){const R=g?t:l(t,be.encoder,A,"key",h);return[_?.(R)+"="+_?.(l(C,be.encoder,A,"value",h))]}return[_?.(t)+"="+_?.(String(C))]}const ae=[];if(typeof C>"u")return ae;let J;if(n==="comma"&&Se(C))g&&l&&(C=Io(C,l)),J=[{value:C.length>0?C.join(",")||null:void 0}];else if(Se(u))J=u;else{const R=Object.keys(C);J=f?R.sort(f):R}const ee=a?String(t).replace(/\./g,"%2E"):String(t),se=s&&Se(C)&&C.length===1?ee+"[]":ee;if(r&&Se(C)&&C.length===0)return se+"[]";for(let R=0;R<J.length;++R){const S=J[R],T=typeof S=="object"&&typeof S.value<"u"?S.value:C[S];if(i&&T===null)continue;const Z=d&&a?S.replace(/\./g,"%2E"):S,O=Se(C)?typeof n=="function"?n(se,Z):se:se+(d?"."+Z:"["+Z+"]");$.set(e,Y);const j=new WeakMap;j.set(Cs,$),Ea(ae,Ra(T,O,n,s,r,o,i,a,n==="comma"&&g&&Se(C)?null:l,u,f,d,b,h,_,g,A,j))}return ae}function Zb(e=be){if(typeof e.allowEmptyArrays<"u"&&typeof e.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof e.encodeDotInKeys<"u"&&typeof e.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");const t=e.charset||be.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=Aa;if(typeof e.format<"u"){if(!Us(Ao,e.format))throw new TypeError("Unknown format option provided.");n=e.format}const s=Ao[n];let r=be.filter;(typeof e.filter=="function"||Se(e.filter))&&(r=e.filter);let o;if(e.arrayFormat&&e.arrayFormat in Ma?o=e.arrayFormat:"indices"in e?o=e.indices?"indices":"repeat":o=be.arrayFormat,"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=typeof e.allowDots>"u"?e.encodeDotInKeys?!0:be.allowDots:!!e.allowDots;return{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:be.addQueryPrefix,allowDots:i,allowEmptyArrays:typeof e.allowEmptyArrays=="boolean"?!!e.allowEmptyArrays:be.allowEmptyArrays,arrayFormat:o,charset:t,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:be.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:typeof e.delimiter>"u"?be.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:be.encode,encodeDotInKeys:typeof e.encodeDotInKeys=="boolean"?e.encodeDotInKeys:be.encodeDotInKeys,encoder:typeof e.encoder=="function"?e.encoder:be.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:be.encodeValuesOnly,filter:r,format:n,formatter:s,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:be.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:be.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:be.strictNullHandling}}function ey(e,t={}){let n=e;const s=Zb(t);let r,o;typeof s.filter=="function"?(o=s.filter,n=o("",n)):Se(s.filter)&&(o=s.filter,r=o);const i=[];if(typeof n!="object"||n===null)return"";const a=Ma[s.arrayFormat],l=a==="comma"&&s.commaRoundTrip;r||(r=Object.keys(n)),s.sort&&r.sort(s.sort);const u=new WeakMap;for(let b=0;b<r.length;++b){const h=r[b];s.skipNulls&&n[h]===null||Ea(i,Ra(n[h],h,a,l,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,u))}const f=i.join(s.delimiter);let d=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),f.length>0?d+f:""}function ty(e){let t=0;for(const r of e)t+=r.length;const n=new Uint8Array(t);let s=0;for(const r of e)n.set(r,s),s+=r.length;return n}let Eo;function br(e){let t;return(Eo??(t=new globalThis.TextEncoder,Eo=t.encode.bind(t)))(e)}let Ro;function To(e){let t;return(Ro??(t=new globalThis.TextDecoder,Ro=t.decode.bind(t)))(e)}var Ae,Ie;class ns{constructor(){Ae.set(this,void 0),Ie.set(this,void 0),U(this,Ae,new Uint8Array),U(this,Ie,null)}decode(t){if(t==null)return[];const n=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?br(t):t;U(this,Ae,ty([m(this,Ae,"f"),n]));const s=[];let r;for(;(r=ny(m(this,Ae,"f"),m(this,Ie,"f")))!=null;){if(r.carriage&&m(this,Ie,"f")==null){U(this,Ie,r.index);continue}if(m(this,Ie,"f")!=null&&(r.index!==m(this,Ie,"f")+1||r.carriage)){s.push(To(m(this,Ae,"f").subarray(0,m(this,Ie,"f")-1))),U(this,Ae,m(this,Ae,"f").subarray(m(this,Ie,"f"))),U(this,Ie,null);continue}const o=m(this,Ie,"f")!==null?r.preceding-1:r.preceding,i=To(m(this,Ae,"f").subarray(0,o));s.push(i),U(this,Ae,m(this,Ae,"f").subarray(r.index)),U(this,Ie,null)}return s}flush(){return m(this,Ae,"f").length?this.decode(`
`):[]}}Ae=new WeakMap,Ie=new WeakMap;ns.NEWLINE_CHARS=new Set([`
`,"\r"]);ns.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ny(e,t){for(let r=t??0;r<e.length;r++){if(e[r]===10)return{preceding:r,index:r+1,carriage:!1};if(e[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function sy(e){for(let s=0;s<e.length-1;s++){if(e[s]===10&&e[s+1]===10||e[s]===13&&e[s+1]===13)return s+2;if(e[s]===13&&e[s+1]===10&&s+3<e.length&&e[s+2]===13&&e[s+3]===10)return s+4}return-1}const Hn={off:0,error:200,warn:300,info:400,debug:500},Oo=(e,t,n)=>{if(e){if(Nb(Hn,e))return e;ve(n).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(Hn))}`)}};function Bt(){}function pn(e,t,n){return!t||Hn[e]>Hn[n]?Bt:t[e].bind(t)}const ry={error:Bt,warn:Bt,info:Bt,debug:Bt};let Po=new WeakMap;function ve(e){const t=e.logger,n=e.logLevel??"off";if(!t)return ry;const s=Po.get(t);if(s&&s[0]===n)return s[1];const r={error:pn("error",t,n),warn:pn("warn",t,n),info:pn("info",t,n),debug:pn("debug",t,n)};return Po.set(t,[n,r]),r}const dt=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([t,n])=>[t,t.toLowerCase()==="authorization"||t.toLowerCase()==="cookie"||t.toLowerCase()==="set-cookie"?"***":n]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);var jt;class Je{constructor(t,n,s){this.iterator=t,jt.set(this,void 0),this.controller=n,U(this,jt,s)}static fromSSEResponse(t,n,s){let r=!1;const o=s?ve(s):console;async function*i(){if(r)throw new B("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const l of oy(t,n))if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null||!l.event.startsWith("thread.")){let u;try{u=JSON.parse(l.data)}catch(f){throw o.error("Could not parse message into JSON:",l.data),o.error("From chunk:",l.raw),f}if(u&&u.error)throw new _e(void 0,u.error,void 0,t.headers);yield u}else{let u;try{u=JSON.parse(l.data)}catch(f){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),f}if(l.event=="error")throw new _e(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}a=!0}catch(l){if(Hs(l))return;throw l}finally{a||n.abort()}}return new Je(i,n,s)}static fromReadableStream(t,n,s){let r=!1;async function*o(){const a=new ns,l=Sa(t);for await(const u of l)for(const f of a.decode(u))yield f;for(const u of a.flush())yield u}async function*i(){if(r)throw new B("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const l of o())a||l&&(yield JSON.parse(l));a=!0}catch(l){if(Hs(l))return;throw l}finally{a||n.abort()}}return new Je(i,n,s)}[(jt=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],n=[],s=this.iterator(),r=o=>({next:()=>{if(o.length===0){const i=s.next();t.push(i),n.push(i)}return o.shift()}});return[new Je(()=>r(t),this.controller,m(this,jt,"f")),new Je(()=>r(n),this.controller,m(this,jt,"f"))]}toReadableStream(){const t=this;let n;return Ca({async start(){n=t[Symbol.asyncIterator]()},async pull(s){try{const{value:r,done:o}=await n.next();if(o)return s.close();const i=br(JSON.stringify(r)+`
`);s.enqueue(i)}catch(r){s.error(r)}},async cancel(){await n.return?.()}})}}async function*oy(e,t){if(!e.body)throw t.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new B("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new B("Attempted to iterate over a response with no body");const n=new ay,s=new ns,r=Sa(e.body);for await(const o of iy(r))for(const i of s.decode(o)){const a=n.decode(i);a&&(yield a)}for(const o of s.flush()){const i=n.decode(o);i&&(yield i)}}async function*iy(e){let t=new Uint8Array;for await(const n of e){if(n==null)continue;const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?br(n):n;let r=new Uint8Array(t.length+s.length);r.set(t),r.set(s,t.length),t=r;let o;for(;(o=sy(t))!==-1;)yield t.slice(0,o),t=t.slice(o)}t.length>0&&(yield t)}class ay{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const o={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],o}if(this.chunks.push(t),t.startsWith(":"))return null;let[n,s,r]=ly(t,":");return r.startsWith(" ")&&(r=r.substring(1)),n==="event"?this.event=r:n==="data"&&this.data.push(r),null}}function ly(e,t){const n=e.indexOf(t);return n!==-1?[e.substring(0,n),t,e.substring(n+t.length)]:[e,"",""]}async function Ta(e,t){const{response:n,requestLogID:s,retryOfRequestLogID:r,startTime:o}=t,i=await(async()=>{if(t.options.stream)return ve(e).debug("response",n.status,n.url,n.headers,n.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(n,t.controller,e):Je.fromSSEResponse(n,t.controller,e);if(n.status===204)return null;if(t.options.__binaryResponse)return n;const l=n.headers.get("content-type")?.split(";")[0]?.trim();if(l?.includes("application/json")||l?.endsWith("+json")){const d=await n.json();return Oa(d,n)}return await n.text()})();return ve(e).debug(`[${s}] response parsed`,dt({retryOfRequestLogID:r,url:n.url,status:n.status,body:i,durationMs:Date.now()-o})),i}function Oa(e,t){return!e||typeof e!="object"||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}var Ft;class ss extends Promise{constructor(t,n,s=Ta){super(r=>{r(null)}),this.responsePromise=n,this.parseResponse=s,Ft.set(this,void 0),U(this,Ft,t)}_thenUnwrap(t){return new ss(m(this,Ft,"f"),this.responsePromise,async(n,s)=>Oa(t(await this.parseResponse(n,s),s),s.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(m(this,Ft,"f"),t))),this.parsedPromise}then(t,n){return this.parse().then(t,n)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}Ft=new WeakMap;var hn;class yr{constructor(t,n,s,r){hn.set(this,void 0),U(this,hn,t),this.options=r,this.response=n,this.body=s}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new B("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await m(this,hn,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(hn=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const n of t.getPaginatedItems())yield n}}class uy extends ss{constructor(t,n,s){super(t,n,async(r,o)=>new s(r,o.response,await Ta(r,o),o.options))}async*[Symbol.asyncIterator](){const t=await this;for await(const n of t)yield n}}class rs extends yr{constructor(t,n,s,r){super(t,n,s,r),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class he extends yr{constructor(t,n,s,r){super(t,n,s,r),this.data=s.data||[],this.has_more=s.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.getPaginatedItems(),n=t[t.length-1]?.id;return n?{...this.options,query:{...ka(this.options.query),after:n}}:null}}class cy extends yr{constructor(t,n,s,r){super(t,n,s,r),this.data=s.data||[],this.has_more=s.has_more||!1,this.last_id=s.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){const t=this.last_id;return t?{...this.options,query:{...ka(this.options.query),after:t}}:null}}const Pa=()=>{if(typeof File>"u"){const{process:e}=globalThis,t=typeof e?.versions?.node=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Kt(e,t,n){return Pa(),new File(e,t??"unknown_file",n)}function _n(e){return(typeof e=="object"&&e!==null&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}const La=e=>e!=null&&typeof e=="object"&&typeof e[Symbol.asyncIterator]=="function",yt=async(e,t)=>({...e,body:await fy(e.body,t)}),Lo=new WeakMap;function dy(e){const t=typeof e=="function"?e:e.fetch,n=Lo.get(t);if(n)return n;const s=(async()=>{try{const r="Response"in t?t.Response:(await t("data:,")).constructor,o=new FormData;return o.toString()!==await new r(o).text()}catch{return!0}})();return Lo.set(t,s),s}const fy=async(e,t)=>{if(!await dy(t))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(e||{}).map(([s,r])=>Ws(n,s,r))),n},py=e=>e instanceof Blob&&"name"in e,Ws=async(e,t,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")e.append(t,String(n));else if(n instanceof Response)e.append(t,Kt([await n.blob()],_n(n)));else if(La(n))e.append(t,Kt([await new Response($a(n)).blob()],_n(n)));else if(py(n))e.append(t,n,_n(n));else if(Array.isArray(n))await Promise.all(n.map(s=>Ws(e,t+"[]",s)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([s,r])=>Ws(e,`${t}[${s}]`,r)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}},Da=e=>e!=null&&typeof e=="object"&&typeof e.size=="number"&&typeof e.type=="string"&&typeof e.text=="function"&&typeof e.slice=="function"&&typeof e.arrayBuffer=="function",hy=e=>e!=null&&typeof e=="object"&&typeof e.name=="string"&&typeof e.lastModified=="number"&&Da(e),my=e=>e!=null&&typeof e=="object"&&typeof e.url=="string"&&typeof e.blob=="function";async function gy(e,t,n){if(Pa(),e=await e,hy(e))return e instanceof File?e:Kt([await e.arrayBuffer()],e.name);if(my(e)){const r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),Kt(await zs(r),t,n)}const s=await zs(e);if(t||(t=_n(e)),!n?.type){const r=s.find(o=>typeof o=="object"&&"type"in o&&o.type);typeof r=="string"&&(n={...n,type:r})}return Kt(s,t,n)}async function zs(e){let t=[];if(typeof e=="string"||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(Da(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(La(e))for await(const n of e)t.push(...await zs(n));else{const n=e?.constructor?.name;throw new Error(`Unexpected data type: ${typeof e}${n?`; constructor: ${n}`:""}${by(e)}`)}return t}function by(e){return typeof e!="object"||e===null?"":`; props: [${Object.getOwnPropertyNames(e).map(n=>`"${n}"`).join(", ")}]`}class F{constructor(t){this._client=t}}function ja(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const Do=Object.freeze(Object.create(null)),yy=(e=ja)=>function(n,...s){if(n.length===1)return n[0];let r=!1;const o=[],i=n.reduce((f,d,b)=>{/[?#]/.test(d)&&(r=!0);const h=s[b];let _=(r?encodeURIComponent:e)(""+h);return b!==s.length&&(h==null||typeof h=="object"&&h.toString===Object.getPrototypeOf(Object.getPrototypeOf(h.hasOwnProperty??Do)??Do)?.toString)&&(_=h+"",o.push({start:f.length+d.length,length:_.length,error:`Value of type ${Object.prototype.toString.call(h).slice(8,-1)} is not a valid path parameter`})),f+d+(b===s.length?"":_)},""),a=i.split(/[?#]/,1)[0],l=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let u;for(;(u=l.exec(a))!==null;)o.push({start:u.index,length:u[0].length,error:`Value "${u[0]}" can't be safely passed as a path parameter`});if(o.sort((f,d)=>f.start-d.start),o.length>0){let f=0;const d=o.reduce((b,h)=>{const _=" ".repeat(h.start-f),g="^".repeat(h.length);return f=h.start+h.length,b+_+g},"");throw new B(`Path parameters result in path with invalid segments:
${o.map(b=>b.error).join(`
`)}
${i}
${d}`)}return i},M=yy(ja);let Na=class extends F{list(t,n={},s){return this._client.getAPIList(M`/chat/completions/${t}/messages`,he,{query:n,...s})}};function qn(e){return e!==void 0&&"function"in e&&e.function!==void 0}function vr(e){return e?.$brand==="auto-parseable-response-format"}function on(e){return e?.$brand==="auto-parseable-tool"}function vy(e,t){return!t||!Ba(t)?{...e,choices:e.choices.map(n=>(Fa(n.message.tool_calls),{...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:wr(e,t)}function wr(e,t){const n=e.choices.map(s=>{if(s.finish_reason==="length")throw new xa;if(s.finish_reason==="content_filter")throw new _a;return Fa(s.message.tool_calls),{...s,message:{...s.message,...s.message.tool_calls?{tool_calls:s.message.tool_calls?.map(r=>xy(t,r))??void 0}:void 0,parsed:s.message.content&&!s.message.refusal?wy(t,s.message.content):null}}});return{...e,choices:n}}function wy(e,t){return e.response_format?.type!=="json_schema"?null:e.response_format?.type==="json_schema"?"$parseRaw"in e.response_format?e.response_format.$parseRaw(t):JSON.parse(t):null}function xy(e,t){const n=e.tools?.find(s=>qn(s)&&s.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:on(n)?n.$parseRaw(t.function.arguments):n?.function.strict?JSON.parse(t.function.arguments):null}}}function _y(e,t){if(!e||!("tools"in e)||!e.tools)return!1;const n=e.tools?.find(s=>qn(s)&&s.function?.name===t.function.name);return qn(n)&&(on(n)||n?.function.strict||!1)}function Ba(e){return vr(e.response_format)?!0:e.tools?.some(t=>on(t)||t.type==="function"&&t.function.strict===!0)??!1}function Fa(e){for(const t of e||[])if(t.type!=="function")throw new B(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}function ky(e){for(const t of e??[]){if(t.type!=="function")throw new B(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(t.function.strict!==!0)throw new B(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}const Un=e=>e?.role==="assistant",Ha=e=>e?.role==="tool";var Vs,kn,Cn,Ht,qt,$n,Ut,Ze,Wt,Wn,zn,kt,qa;class xr{constructor(){Vs.add(this),this.controller=new AbortController,kn.set(this,void 0),Cn.set(this,()=>{}),Ht.set(this,()=>{}),qt.set(this,void 0),$n.set(this,()=>{}),Ut.set(this,()=>{}),Ze.set(this,{}),Wt.set(this,!1),Wn.set(this,!1),zn.set(this,!1),kt.set(this,!1),U(this,kn,new Promise((t,n)=>{U(this,Cn,t,"f"),U(this,Ht,n,"f")})),U(this,qt,new Promise((t,n)=>{U(this,$n,t,"f"),U(this,Ut,n,"f")})),m(this,kn,"f").catch(()=>{}),m(this,qt,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},m(this,Vs,"m",qa).bind(this))},0)}_connected(){this.ended||(m(this,Cn,"f").call(this),this._emit("connect"))}get ended(){return m(this,Wt,"f")}get errored(){return m(this,Wn,"f")}get aborted(){return m(this,zn,"f")}abort(){this.controller.abort()}on(t,n){return(m(this,Ze,"f")[t]||(m(this,Ze,"f")[t]=[])).push({listener:n}),this}off(t,n){const s=m(this,Ze,"f")[t];if(!s)return this;const r=s.findIndex(o=>o.listener===n);return r>=0&&s.splice(r,1),this}once(t,n){return(m(this,Ze,"f")[t]||(m(this,Ze,"f")[t]=[])).push({listener:n,once:!0}),this}emitted(t){return new Promise((n,s)=>{U(this,kt,!0),t!=="error"&&this.once("error",s),this.once(t,n)})}async done(){U(this,kt,!0),await m(this,qt,"f")}_emit(t,...n){if(m(this,Wt,"f"))return;t==="end"&&(U(this,Wt,!0),m(this,$n,"f").call(this));const s=m(this,Ze,"f")[t];if(s&&(m(this,Ze,"f")[t]=s.filter(r=>!r.once),s.forEach(({listener:r})=>r(...n))),t==="abort"){const r=n[0];!m(this,kt,"f")&&!s?.length&&Promise.reject(r),m(this,Ht,"f").call(this,r),m(this,Ut,"f").call(this,r),this._emit("end");return}if(t==="error"){const r=n[0];!m(this,kt,"f")&&!s?.length&&Promise.reject(r),m(this,Ht,"f").call(this,r),m(this,Ut,"f").call(this,r),this._emit("end")}}_emitFinal(){}}kn=new WeakMap,Cn=new WeakMap,Ht=new WeakMap,qt=new WeakMap,$n=new WeakMap,Ut=new WeakMap,Ze=new WeakMap,Wt=new WeakMap,Wn=new WeakMap,zn=new WeakMap,kt=new WeakMap,Vs=new WeakSet,qa=function(t){if(U(this,Wn,!0),t instanceof Error&&t.name==="AbortError"&&(t=new De),t instanceof De)return U(this,zn,!0),this._emit("abort",t);if(t instanceof B)return this._emit("error",t);if(t instanceof Error){const n=new B(t.message);return n.cause=t,this._emit("error",n)}return this._emit("error",new B(String(t)))};function Cy(e){return typeof e.parse=="function"}var Ce,Js,Vn,Ks,Qs,Xs,Ua,Wa;const $y=10;class za extends xr{constructor(){super(...arguments),Ce.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const n=t.choices[0]?.message;return n&&this._addMessage(n),t}_addMessage(t,n=!0){if("content"in t||(t.content=null),this.messages.push(t),n){if(this._emit("message",t),Ha(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(Un(t)&&t.tool_calls)for(const s of t.tool_calls)s.type==="function"&&this._emit("functionToolCall",s.function)}}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new B("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),m(this,Ce,"m",Js).call(this)}async finalMessage(){return await this.done(),m(this,Ce,"m",Vn).call(this)}async finalFunctionToolCall(){return await this.done(),m(this,Ce,"m",Ks).call(this)}async finalFunctionToolCallResult(){return await this.done(),m(this,Ce,"m",Qs).call(this)}async totalUsage(){return await this.done(),m(this,Ce,"m",Xs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const n=m(this,Ce,"m",Vn).call(this);n&&this._emit("finalMessage",n);const s=m(this,Ce,"m",Js).call(this);s&&this._emit("finalContent",s);const r=m(this,Ce,"m",Ks).call(this);r&&this._emit("finalFunctionToolCall",r);const o=m(this,Ce,"m",Qs).call(this);o!=null&&this._emit("finalFunctionToolCallResult",o),this._chatCompletions.some(i=>i.usage)&&this._emit("totalUsage",m(this,Ce,"m",Xs).call(this))}async _createChatCompletion(t,n,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),m(this,Ce,"m",Ua).call(this,n);const o=await t.chat.completions.create({...n,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addChatCompletion(wr(o,n))}async _runChatCompletion(t,n,s){for(const r of n.messages)this._addMessage(r,!1);return await this._createChatCompletion(t,n,s)}async _runTools(t,n,s){const r="tool",{tool_choice:o="auto",stream:i,...a}=n,l=typeof o!="string"&&o.type==="function"&&o?.function?.name,{maxChatCompletions:u=$y}=s||{},f=n.tools.map(h=>{if(on(h)){if(!h.$callback)throw new B("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:h.$callback,name:h.function.name,description:h.function.description||"",parameters:h.function.parameters,parse:h.$parseRaw,strict:!0}}}return h}),d={};for(const h of f)h.type==="function"&&(d[h.function.name||h.function.function.name]=h.function);const b="tools"in n?f.map(h=>h.type==="function"?{type:"function",function:{name:h.function.name||h.function.function.name,parameters:h.function.parameters,description:h.function.description,strict:h.function.strict}}:h):void 0;for(const h of n.messages)this._addMessage(h,!1);for(let h=0;h<u;++h){const g=(await this._createChatCompletion(t,{...a,tool_choice:o,tools:b,messages:[...this.messages]},s)).choices[0]?.message;if(!g)throw new B("missing message in ChatCompletion response");if(!g.tool_calls?.length)return;for(const A of g.tool_calls){if(A.type!=="function")continue;const $=A.id,{name:C,arguments:z}=A.function,Y=d[C];if(Y){if(l&&l!==C){const ee=`Invalid tool_call: ${JSON.stringify(C)}. ${JSON.stringify(l)} requested. Please try again`;this._addMessage({role:r,tool_call_id:$,content:ee});continue}}else{const ee=`Invalid tool_call: ${JSON.stringify(C)}. Available options are: ${Object.keys(d).map(se=>JSON.stringify(se)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:$,content:ee});continue}let ne;try{ne=Cy(Y)?await Y.parse(z):z}catch(ee){const se=ee instanceof Error?ee.message:String(ee);this._addMessage({role:r,tool_call_id:$,content:se});continue}const ae=await Y.function(ne,this),J=m(this,Ce,"m",Wa).call(this,ae);if(this._addMessage({role:r,tool_call_id:$,content:J}),l)return}}}}Ce=new WeakSet,Js=function(){return m(this,Ce,"m",Vn).call(this).content??null},Vn=function(){let t=this.messages.length;for(;t-- >0;){const n=this.messages[t];if(Un(n))return{...n,content:n.content??null,refusal:n.refusal??null}}throw new B("stream ended without producing a ChatCompletionMessage with role=assistant")},Ks=function(){for(let t=this.messages.length-1;t>=0;t--){const n=this.messages[t];if(Un(n)&&n?.tool_calls?.length)return n.tool_calls.filter(s=>s.type==="function").at(-1)?.function}},Qs=function(){for(let t=this.messages.length-1;t>=0;t--){const n=this.messages[t];if(Ha(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(s=>s.role==="assistant"&&s.tool_calls?.some(r=>r.type==="function"&&r.id===n.tool_call_id)))return n.content}},Xs=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(t.completion_tokens+=n.completion_tokens,t.prompt_tokens+=n.prompt_tokens,t.total_tokens+=n.total_tokens);return t},Ua=function(t){if(t.n!=null&&t.n>1)throw new B("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Wa=function(t){return typeof t=="string"?t:t===void 0?"undefined":JSON.stringify(t)};class _r extends za{static runTools(t,n,s){const r=new _r,o={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(t,n,o)),r}_addMessage(t,n=!0){super._addMessage(t,n),Un(t)&&t.content&&this._emit("content",t.content)}}const Va=1,Ja=2,Ka=4,Qa=8,Xa=16,Ga=32,Ya=64,Za=128,el=256,tl=Za|el,nl=Xa|Ga|tl|Ya,sl=Va|Ja|nl,rl=Ka|Qa,Sy=sl|rl,ye={STR:Va,NUM:Ja,ARR:Ka,OBJ:Qa,NULL:Xa,BOOL:Ga,NAN:Ya,INFINITY:Za,MINUS_INFINITY:el,INF:tl,SPECIAL:nl,ATOM:sl,COLLECTION:rl,ALL:Sy};class Ay extends Error{}class Iy extends Error{}function My(e,t=ye.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return Ey(e.trim(),t)}const Ey=(e,t)=>{const n=e.length;let s=0;const r=b=>{throw new Ay(`${b} at position ${s}`)},o=b=>{throw new Iy(`${b} at position ${s}`)},i=()=>(d(),s>=n&&r("Unexpected end of input"),e[s]==='"'?a():e[s]==="{"?l():e[s]==="["?u():e.substring(s,s+4)==="null"||ye.NULL&t&&n-s<4&&"null".startsWith(e.substring(s))?(s+=4,null):e.substring(s,s+4)==="true"||ye.BOOL&t&&n-s<4&&"true".startsWith(e.substring(s))?(s+=4,!0):e.substring(s,s+5)==="false"||ye.BOOL&t&&n-s<5&&"false".startsWith(e.substring(s))?(s+=5,!1):e.substring(s,s+8)==="Infinity"||ye.INFINITY&t&&n-s<8&&"Infinity".startsWith(e.substring(s))?(s+=8,1/0):e.substring(s,s+9)==="-Infinity"||ye.MINUS_INFINITY&t&&1<n-s&&n-s<9&&"-Infinity".startsWith(e.substring(s))?(s+=9,-1/0):e.substring(s,s+3)==="NaN"||ye.NAN&t&&n-s<3&&"NaN".startsWith(e.substring(s))?(s+=3,NaN):f()),a=()=>{const b=s;let h=!1;for(s++;s<n&&(e[s]!=='"'||h&&e[s-1]==="\\");)h=e[s]==="\\"?!h:!1,s++;if(e.charAt(s)=='"')try{return JSON.parse(e.substring(b,++s-Number(h)))}catch(_){o(String(_))}else if(ye.STR&t)try{return JSON.parse(e.substring(b,s-Number(h))+'"')}catch{return JSON.parse(e.substring(b,e.lastIndexOf("\\"))+'"')}r("Unterminated string literal")},l=()=>{s++,d();const b={};try{for(;e[s]!=="}";){if(d(),s>=n&&ye.OBJ&t)return b;const h=a();d(),s++;try{const _=i();Object.defineProperty(b,h,{value:_,writable:!0,enumerable:!0,configurable:!0})}catch(_){if(ye.OBJ&t)return b;throw _}d(),e[s]===","&&s++}}catch{if(ye.OBJ&t)return b;r("Expected '}' at end of object")}return s++,b},u=()=>{s++;const b=[];try{for(;e[s]!=="]";)b.push(i()),d(),e[s]===","&&s++}catch{if(ye.ARR&t)return b;r("Expected ']' at end of array")}return s++,b},f=()=>{if(s===0){e==="-"&&ye.NUM&t&&r("Not sure what '-' is");try{return JSON.parse(e)}catch(h){if(ye.NUM&t)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}o(String(h))}}const b=s;for(e[s]==="-"&&s++;e[s]&&!",]}".includes(e[s]);)s++;s==n&&!(ye.NUM&t)&&r("Unterminated number literal");try{return JSON.parse(e.substring(b,s))}catch{e.substring(b,s)==="-"&&ye.NUM&t&&r("Not sure what '-' is");try{return JSON.parse(e.substring(b,e.lastIndexOf("e")))}catch(_){o(String(_))}}},d=()=>{for(;s<n&&` 
\r	`.includes(e[s]);)s++};return i()},jo=e=>My(e,ye.ALL^ye.NUM);var ge,Ye,vt,it,$s,mn,Ss,As,Is,gn,Ms,No;class nn extends za{constructor(t){super(),ge.add(this),Ye.set(this,void 0),vt.set(this,void 0),it.set(this,void 0),U(this,Ye,t),U(this,vt,[])}get currentChatCompletionSnapshot(){return m(this,it,"f")}static fromReadableStream(t){const n=new nn(null);return n._run(()=>n._fromReadableStream(t)),n}static createChatCompletion(t,n,s){const r=new nn(n);return r._run(()=>r._runChatCompletion(t,{...n,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(t,n,s){super._createChatCompletion;const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),m(this,ge,"m",$s).call(this);const o=await t.chat.completions.create({...n,stream:!0},{...s,signal:this.controller.signal});this._connected();for await(const i of o)m(this,ge,"m",Ss).call(this,i);if(o.controller.signal?.aborted)throw new De;return this._addChatCompletion(m(this,ge,"m",gn).call(this))}async _fromReadableStream(t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),m(this,ge,"m",$s).call(this),this._connected();const r=Je.fromReadableStream(t,this.controller);let o;for await(const i of r)o&&o!==i.id&&this._addChatCompletion(m(this,ge,"m",gn).call(this)),m(this,ge,"m",Ss).call(this,i),o=i.id;if(r.controller.signal?.aborted)throw new De;return this._addChatCompletion(m(this,ge,"m",gn).call(this))}[(Ye=new WeakMap,vt=new WeakMap,it=new WeakMap,ge=new WeakSet,$s=function(){this.ended||U(this,it,void 0)},mn=function(n){let s=m(this,vt,"f")[n.index];return s||(s={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},m(this,vt,"f")[n.index]=s,s)},Ss=function(n){if(this.ended)return;const s=m(this,ge,"m",No).call(this,n);this._emit("chunk",n,s);for(const r of n.choices){const o=s.choices[r.index];r.delta.content!=null&&o.message?.role==="assistant"&&o.message?.content&&(this._emit("content",r.delta.content,o.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:o.message.content,parsed:o.message.parsed})),r.delta.refusal!=null&&o.message?.role==="assistant"&&o.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:o.message.refusal}),r.logprobs?.content!=null&&o.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:o.logprobs?.content??[]}),r.logprobs?.refusal!=null&&o.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:o.logprobs?.refusal??[]});const i=m(this,ge,"m",mn).call(this,o);o.finish_reason&&(m(this,ge,"m",Is).call(this,o),i.current_tool_call_index!=null&&m(this,ge,"m",As).call(this,o,i.current_tool_call_index));for(const a of r.delta.tool_calls??[])i.current_tool_call_index!==a.index&&(m(this,ge,"m",Is).call(this,o),i.current_tool_call_index!=null&&m(this,ge,"m",As).call(this,o,i.current_tool_call_index)),i.current_tool_call_index=a.index;for(const a of r.delta.tool_calls??[]){const l=o.message.tool_calls?.[a.index];l?.type&&(l?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:l.function?.name,index:a.index,arguments:l.function.arguments,parsed_arguments:l.function.parsed_arguments,arguments_delta:a.function?.arguments??""}):(l?.type,void 0))}}},As=function(n,s){if(m(this,ge,"m",mn).call(this,n).done_tool_calls.has(s))return;const o=n.message.tool_calls?.[s];if(!o)throw new Error("no tool call snapshot");if(!o.type)throw new Error("tool call snapshot missing `type`");if(o.type==="function"){const i=m(this,Ye,"f")?.tools?.find(a=>qn(a)&&a.function.name===o.function.name);this._emit("tool_calls.function.arguments.done",{name:o.function.name,index:s,arguments:o.function.arguments,parsed_arguments:on(i)?i.$parseRaw(o.function.arguments):i?.function.strict?JSON.parse(o.function.arguments):null})}else o.type},Is=function(n){const s=m(this,ge,"m",mn).call(this,n);if(n.message.content&&!s.content_done){s.content_done=!0;const r=m(this,ge,"m",Ms).call(this);this._emit("content.done",{content:n.message.content,parsed:r?r.$parseRaw(n.message.content):null})}n.message.refusal&&!s.refusal_done&&(s.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!s.logprobs_content_done&&(s.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!s.logprobs_refusal_done&&(s.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},gn=function(){if(this.ended)throw new B("stream has ended, this shouldn't happen");const n=m(this,it,"f");if(!n)throw new B("request ended without sending any chunks");return U(this,it,void 0),U(this,vt,[]),Ry(n,m(this,Ye,"f"))},Ms=function(){const n=m(this,Ye,"f")?.response_format;return vr(n)?n:null},No=function(n){var s,r,o,i;let a=m(this,it,"f");const{choices:l,...u}=n;a?Object.assign(a,u):a=U(this,it,{...u,choices:[]});for(const{delta:f,finish_reason:d,index:b,logprobs:h=null,..._}of n.choices){let g=a.choices[b];if(g||(g=a.choices[b]={finish_reason:d,index:b,message:{},logprobs:h,..._}),h)if(!g.logprobs)g.logprobs=Object.assign({},h);else{const{content:ae,refusal:J,...ee}=h;Object.assign(g.logprobs,ee),ae&&((s=g.logprobs).content??(s.content=[]),g.logprobs.content.push(...ae)),J&&((r=g.logprobs).refusal??(r.refusal=[]),g.logprobs.refusal.push(...J))}if(d&&(g.finish_reason=d,m(this,Ye,"f")&&Ba(m(this,Ye,"f")))){if(d==="length")throw new xa;if(d==="content_filter")throw new _a}if(Object.assign(g,_),!f)continue;const{content:A,refusal:$,function_call:C,role:z,tool_calls:Y,...ne}=f;if(Object.assign(g.message,ne),$&&(g.message.refusal=(g.message.refusal||"")+$),z&&(g.message.role=z),C&&(g.message.function_call?(C.name&&(g.message.function_call.name=C.name),C.arguments&&((o=g.message.function_call).arguments??(o.arguments=""),g.message.function_call.arguments+=C.arguments)):g.message.function_call=C),A&&(g.message.content=(g.message.content||"")+A,!g.message.refusal&&m(this,ge,"m",Ms).call(this)&&(g.message.parsed=jo(g.message.content))),Y){g.message.tool_calls||(g.message.tool_calls=[]);for(const{index:ae,id:J,type:ee,function:se,...R}of Y){const S=(i=g.message.tool_calls)[ae]??(i[ae]={});Object.assign(S,R),J&&(S.id=J),ee&&(S.type=ee),se&&(S.function??(S.function={name:se.name??"",arguments:""})),se?.name&&(S.function.name=se.name),se?.arguments&&(S.function.arguments+=se.arguments,_y(m(this,Ye,"f"),S)&&(S.function.parsed_arguments=jo(S.function.arguments)))}}}return a},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("chunk",r=>{const o=n.shift();o?o.resolve(r):t.push(r)}),this.on("end",()=>{s=!0;for(const r of n)r.resolve(void 0);n.length=0}),this.on("abort",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),this.on("error",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,i)=>n.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Je(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Ry(e,t){const{id:n,choices:s,created:r,model:o,system_fingerprint:i,...a}=e,l={...a,id:n,choices:s.map(({message:u,finish_reason:f,index:d,logprobs:b,...h})=>{if(!f)throw new B(`missing finish_reason for choice ${d}`);const{content:_=null,function_call:g,tool_calls:A,...$}=u,C=u.role;if(!C)throw new B(`missing role for choice ${d}`);if(g){const{arguments:z,name:Y}=g;if(z==null)throw new B(`missing function_call.arguments for choice ${d}`);if(!Y)throw new B(`missing function_call.name for choice ${d}`);return{...h,message:{content:_,function_call:{arguments:z,name:Y},role:C,refusal:u.refusal??null},finish_reason:f,index:d,logprobs:b}}return A?{...h,index:d,finish_reason:f,logprobs:b,message:{...$,role:C,content:_,refusal:u.refusal??null,tool_calls:A.map((z,Y)=>{const{function:ne,type:ae,id:J,...ee}=z,{arguments:se,name:R,...S}=ne||{};if(J==null)throw new B(`missing choices[${d}].tool_calls[${Y}].id
${bn(e)}`);if(ae==null)throw new B(`missing choices[${d}].tool_calls[${Y}].type
${bn(e)}`);if(R==null)throw new B(`missing choices[${d}].tool_calls[${Y}].function.name
${bn(e)}`);if(se==null)throw new B(`missing choices[${d}].tool_calls[${Y}].function.arguments
${bn(e)}`);return{...ee,id:J,type:ae,function:{...S,name:R,arguments:se}}})}}:{...h,message:{...$,content:_,role:C,refusal:u.refusal??null},finish_reason:f,index:d,logprobs:b}}),created:r,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return vy(l,t)}function bn(e){return JSON.stringify(e)}class Jn extends nn{static fromReadableStream(t){const n=new Jn(null);return n._run(()=>n._fromReadableStream(t)),n}static runTools(t,n,s){const r=new Jn(n),o={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(t,n,o)),r}}let kr=class extends F{constructor(){super(...arguments),this.messages=new Na(this._client)}create(t,n){return this._client.post("/chat/completions",{body:t,...n,stream:t.stream??!1})}retrieve(t,n){return this._client.get(M`/chat/completions/${t}`,n)}update(t,n,s){return this._client.post(M`/chat/completions/${t}`,{body:n,...s})}list(t={},n){return this._client.getAPIList("/chat/completions",he,{query:t,...n})}delete(t,n){return this._client.delete(M`/chat/completions/${t}`,n)}parse(t,n){return ky(t.tools),this._client.chat.completions.create(t,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(s=>wr(s,t))}runTools(t,n){return t.stream?Jn.runTools(this._client,t,n):_r.runTools(this._client,t,n)}stream(t,n){return nn.createChatCompletion(this._client,t,n)}};kr.Messages=Na;class Cr extends F{constructor(){super(...arguments),this.completions=new kr(this._client)}}Cr.Completions=kr;const ol=Symbol("brand.privateNullableHeaders");function*Ty(e){if(!e)return;if(ol in e){const{values:s,nulls:r}=e;yield*s.entries();for(const o of r)yield[o,null];return}let t=!1,n;e instanceof Headers?n=e.entries():ko(e)?n=e:(t=!0,n=Object.entries(e??{}));for(let s of n){const r=s[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const o=ko(s[1])?s[1]:[s[1]];let i=!1;for(const a of o)a!==void 0&&(t&&!i&&(i=!0,yield[r,null]),yield[r,a])}}const N=e=>{const t=new Headers,n=new Set;for(const s of e){const r=new Set;for(const[o,i]of Ty(s)){const a=o.toLowerCase();r.has(a)||(t.delete(o),r.add(a)),i===null?(t.delete(o),n.add(a)):(t.append(o,i),n.delete(a))}}return{[ol]:!0,values:t,nulls:n}};class il extends F{create(t,n){return this._client.post("/audio/speech",{body:t,...n,headers:N([{Accept:"application/octet-stream"},n?.headers]),__binaryResponse:!0})}}class al extends F{create(t,n){return this._client.post("/audio/transcriptions",yt({body:t,...n,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class ll extends F{create(t,n){return this._client.post("/audio/translations",yt({body:t,...n,__metadata:{model:t.model}},this._client))}}class an extends F{constructor(){super(...arguments),this.transcriptions=new al(this._client),this.translations=new ll(this._client),this.speech=new il(this._client)}}an.Transcriptions=al;an.Translations=ll;an.Speech=il;class ul extends F{create(t,n){return this._client.post("/batches",{body:t,...n})}retrieve(t,n){return this._client.get(M`/batches/${t}`,n)}list(t={},n){return this._client.getAPIList("/batches",he,{query:t,...n})}cancel(t,n){return this._client.post(M`/batches/${t}/cancel`,n)}}class cl extends F{create(t,n){return this._client.post("/assistants",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(M`/assistants/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,s){return this._client.post(M`/assistants/${t}`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t={},n){return this._client.getAPIList("/assistants",he,{query:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,n){return this._client.delete(M`/assistants/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class dl extends F{create(t,n){return this._client.post("/realtime/sessions",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class fl extends F{create(t,n){return this._client.post("/realtime/transcription_sessions",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}let os=class extends F{constructor(){super(...arguments),this.sessions=new dl(this._client),this.transcriptionSessions=new fl(this._client)}};os.Sessions=dl;os.TranscriptionSessions=fl;class pl extends F{create(t,n,s){return this._client.post(M`/threads/${t}/messages`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(t,n,s){const{thread_id:r}=n;return this._client.get(M`/threads/${r}/messages/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(t,n,s){const{thread_id:r,...o}=n;return this._client.post(M`/threads/${r}/messages/${t}`,{body:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t,n={},s){return this._client.getAPIList(M`/threads/${t}/messages`,he,{query:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(t,n,s){const{thread_id:r}=n;return this._client.delete(M`/threads/${r}/messages/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class hl extends F{retrieve(t,n,s){const{thread_id:r,run_id:o,...i}=n;return this._client.get(M`/threads/${r}/runs/${o}/steps/${t}`,{query:i,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t,n,s){const{thread_id:r,...o}=n;return this._client.getAPIList(M`/threads/${r}/runs/${t}/steps`,he,{query:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}const Oy=e=>{if(typeof Buffer<"u"){const t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}else{const t=atob(e),n=t.length,s=new Uint8Array(n);for(let r=0;r<n;r++)s[r]=t.charCodeAt(r);return Array.from(new Float32Array(s.buffer))}};var Py={};const wt=e=>{if(typeof globalThis.process<"u")return Py?.[e]?.trim()??void 0;if(typeof globalThis.Deno<"u")return globalThis.Deno.env?.get?.(e)?.trim()};var we,mt,Gs,We,Sn,Fe,gt,$t,pt,Kn,Me,An,In,Qt,zt,Vt,Bo,Fo,Ho,qo,Uo,Wo,zo;class Xt extends xr{constructor(){super(...arguments),we.add(this),Gs.set(this,[]),We.set(this,{}),Sn.set(this,{}),Fe.set(this,void 0),gt.set(this,void 0),$t.set(this,void 0),pt.set(this,void 0),Kn.set(this,void 0),Me.set(this,void 0),An.set(this,void 0),In.set(this,void 0),Qt.set(this,void 0)}[(Gs=new WeakMap,We=new WeakMap,Sn=new WeakMap,Fe=new WeakMap,gt=new WeakMap,$t=new WeakMap,pt=new WeakMap,Kn=new WeakMap,Me=new WeakMap,An=new WeakMap,In=new WeakMap,Qt=new WeakMap,we=new WeakSet,Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",r=>{const o=n.shift();o?o.resolve(r):t.push(r)}),this.on("end",()=>{s=!0;for(const r of n)r.resolve(void 0);n.length=0}),this.on("abort",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),this.on("error",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,i)=>n.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const n=new mt;return n._run(()=>n._fromReadableStream(t)),n}async _fromReadableStream(t,n){const s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=Je.fromReadableStream(t,this.controller);for await(const o of r)m(this,we,"m",zt).call(this,o);if(r.controller.signal?.aborted)throw new De;return this._addRun(m(this,we,"m",Vt).call(this))}toReadableStream(){return new Je(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,n,s,r){const o=new mt;return o._run(()=>o._runToolAssistantStream(t,n,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(t,n,s,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...s,stream:!0},a=await t.submitToolOutputs(n,i,{...r,signal:this.controller.signal});this._connected();for await(const l of a)m(this,we,"m",zt).call(this,l);if(a.controller.signal?.aborted)throw new De;return this._addRun(m(this,we,"m",Vt).call(this))}static createThreadAssistantStream(t,n,s){const r=new mt;return r._run(()=>r._threadAssistantStream(t,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(t,n,s,r){const o=new mt;return o._run(()=>o._runAssistantStream(t,n,s,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),o}currentEvent(){return m(this,An,"f")}currentRun(){return m(this,In,"f")}currentMessageSnapshot(){return m(this,Fe,"f")}currentRunStepSnapshot(){return m(this,Qt,"f")}async finalRunSteps(){return await this.done(),Object.values(m(this,We,"f"))}async finalMessages(){return await this.done(),Object.values(m(this,Sn,"f"))}async finalRun(){if(await this.done(),!m(this,gt,"f"))throw Error("Final run was not received.");return m(this,gt,"f")}async _createThreadAssistantStream(t,n,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.createAndRun(o,{...s,signal:this.controller.signal});this._connected();for await(const a of i)m(this,we,"m",zt).call(this,a);if(i.controller.signal?.aborted)throw new De;return this._addRun(m(this,we,"m",Vt).call(this))}async _createAssistantStream(t,n,s,r){const o=r?.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const i={...s,stream:!0},a=await t.create(n,i,{...r,signal:this.controller.signal});this._connected();for await(const l of a)m(this,we,"m",zt).call(this,l);if(a.controller.signal?.aborted)throw new De;return this._addRun(m(this,we,"m",Vt).call(this))}static accumulateDelta(t,n){for(const[s,r]of Object.entries(n)){if(!t.hasOwnProperty(s)){t[s]=r;continue}let o=t[s];if(o==null){t[s]=r;continue}if(s==="index"||s==="type"){t[s]=r;continue}if(typeof o=="string"&&typeof r=="string")o+=r;else if(typeof o=="number"&&typeof r=="number")o+=r;else if(_s(o)&&_s(r))o=this.accumulateDelta(o,r);else if(Array.isArray(o)&&Array.isArray(r)){if(o.every(i=>typeof i=="string"||typeof i=="number")){o.push(...r);continue}for(const i of r){if(!_s(i))throw new Error(`Expected array delta entry to be an object but got: ${i}`);const a=i.index;if(a==null)throw console.error(i),new Error("Expected array delta entry to have an `index` property");if(typeof a!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${a}`);const l=o[a];l==null?o.push(i):o[a]=this.accumulateDelta(l,i)}continue}else throw Error(`Unhandled record type: ${s}, deltaValue: ${r}, accValue: ${o}`);t[s]=o}return t}_addRun(t){return t}async _threadAssistantStream(t,n,s){return await this._createThreadAssistantStream(n,t,s)}async _runAssistantStream(t,n,s,r){return await this._createAssistantStream(n,t,s,r)}async _runToolAssistantStream(t,n,s,r){return await this._createToolAssistantStream(n,t,s,r)}}mt=Xt,zt=function(t){if(!this.ended)switch(U(this,An,t),m(this,we,"m",Ho).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":m(this,we,"m",zo).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":m(this,we,"m",Fo).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":m(this,we,"m",Bo).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Vt=function(){if(this.ended)throw new B("stream has ended, this shouldn't happen");if(!m(this,gt,"f"))throw Error("Final run has not been received");return m(this,gt,"f")},Bo=function(t){const[n,s]=m(this,we,"m",Uo).call(this,t,m(this,Fe,"f"));U(this,Fe,n),m(this,Sn,"f")[n.id]=n;for(const r of s){const o=n.content[r.index];o?.type=="text"&&this._emit("textCreated",o.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,n),t.data.delta.content)for(const r of t.data.delta.content){if(r.type=="text"&&r.text){let o=r.text,i=n.content[r.index];if(i&&i.type=="text")this._emit("textDelta",o,i.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=m(this,$t,"f")){if(m(this,pt,"f"))switch(m(this,pt,"f").type){case"text":this._emit("textDone",m(this,pt,"f").text,m(this,Fe,"f"));break;case"image_file":this._emit("imageFileDone",m(this,pt,"f").image_file,m(this,Fe,"f"));break}U(this,$t,r.index)}U(this,pt,n.content[r.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(m(this,$t,"f")!==void 0){const r=t.data.content[m(this,$t,"f")];if(r)switch(r.type){case"image_file":this._emit("imageFileDone",r.image_file,m(this,Fe,"f"));break;case"text":this._emit("textDone",r.text,m(this,Fe,"f"));break}}m(this,Fe,"f")&&this._emit("messageDone",t.data),U(this,Fe,void 0)}},Fo=function(t){const n=m(this,we,"m",qo).call(this,t);switch(U(this,Qt,n),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const s=t.data.delta;if(s.step_details&&s.step_details.type=="tool_calls"&&s.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const o of s.step_details.tool_calls)o.index==m(this,Kn,"f")?this._emit("toolCallDelta",o,n.step_details.tool_calls[o.index]):(m(this,Me,"f")&&this._emit("toolCallDone",m(this,Me,"f")),U(this,Kn,o.index),U(this,Me,n.step_details.tool_calls[o.index]),m(this,Me,"f")&&this._emit("toolCallCreated",m(this,Me,"f")));this._emit("runStepDelta",t.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":U(this,Qt,void 0),t.data.step_details.type=="tool_calls"&&m(this,Me,"f")&&(this._emit("toolCallDone",m(this,Me,"f")),U(this,Me,void 0)),this._emit("runStepDone",t.data,n);break}},Ho=function(t){m(this,Gs,"f").push(t),this._emit("event",t)},qo=function(t){switch(t.event){case"thread.run.step.created":return m(this,We,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let n=m(this,We,"f")[t.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let s=t.data;if(s.delta){const r=mt.accumulateDelta(n,s.delta);m(this,We,"f")[t.data.id]=r}return m(this,We,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":m(this,We,"f")[t.data.id]=t.data;break}if(m(this,We,"f")[t.data.id])return m(this,We,"f")[t.data.id];throw new Error("No snapshot available")},Uo=function(t,n){let s=[];switch(t.event){case"thread.message.created":return[t.data,s];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=t.data;if(r.delta.content)for(const o of r.delta.content)if(o.index in n.content){let i=n.content[o.index];n.content[o.index]=m(this,we,"m",Wo).call(this,o,i)}else n.content[o.index]=o,s.push(o);return[n,s];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,s];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Wo=function(t,n){return mt.accumulateDelta(n,t)},zo=function(t){switch(U(this,In,t.data),t.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":U(this,gt,t.data),m(this,Me,"f")&&(this._emit("toolCallDone",m(this,Me,"f")),U(this,Me,void 0));break}};let $r=class extends F{constructor(){super(...arguments),this.steps=new hl(this._client)}create(t,n,s){const{include:r,...o}=n;return this._client.post(M`/threads/${t}/runs`,{query:{include:r},body:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}retrieve(t,n,s){const{thread_id:r}=n;return this._client.get(M`/threads/${r}/runs/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(t,n,s){const{thread_id:r,...o}=n;return this._client.post(M`/threads/${r}/runs/${t}`,{body:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t,n={},s){return this._client.getAPIList(M`/threads/${t}/runs`,he,{query:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(t,n,s){const{thread_id:r}=n;return this._client.post(M`/threads/${r}/runs/${t}/cancel`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(t,n,s){const r=await this.create(t,n,s);return await this.poll(r.id,{thread_id:t},s)}createAndStream(t,n,s){return Xt.createAssistantStream(t,this._client.beta.threads.runs,n,s)}async poll(t,n,s){const r=N([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:o,response:i}=await this.retrieve(t,n,{...s,headers:{...s?.headers,...r}}).withResponse();switch(o.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(a=u)}}await rn(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return o}}}stream(t,n,s){return Xt.createAssistantStream(t,this._client.beta.threads.runs,n,s)}submitToolOutputs(t,n,s){const{thread_id:r,...o}=n;return this._client.post(M`/threads/${r}/runs/${t}/submit_tool_outputs`,{body:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers]),stream:n.stream??!1})}async submitToolOutputsAndPoll(t,n,s){const r=await this.submitToolOutputs(t,n,s);return await this.poll(r.id,n,s)}submitToolOutputsStream(t,n,s){return Xt.createToolAssistantStream(t,this._client.beta.threads.runs,n,s)}};$r.Steps=hl;class is extends F{constructor(){super(...arguments),this.runs=new $r(this._client),this.messages=new pl(this._client)}create(t={},n){return this._client.post("/threads",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(M`/threads/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,s){return this._client.post(M`/threads/${t}`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(t,n){return this._client.delete(M`/threads/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}createAndRun(t,n){return this._client.post("/threads/runs",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:t.stream??!1})}async createAndRunPoll(t,n){const s=await this.createAndRun(t,n);return await this.runs.poll(s.id,{thread_id:s.thread_id},n)}createAndRunStream(t,n){return Xt.createThreadAssistantStream(t,this._client.beta.threads,n)}}is.Runs=$r;is.Messages=pl;class ln extends F{constructor(){super(...arguments),this.realtime=new os(this._client),this.assistants=new cl(this._client),this.threads=new is(this._client)}}ln.Realtime=os;ln.Assistants=cl;ln.Threads=is;class ml extends F{create(t,n){return this._client.post("/completions",{body:t,...n,stream:t.stream??!1})}}class gl extends F{retrieve(t,n,s){const{container_id:r}=n;return this._client.get(M`/containers/${r}/files/${t}/content`,{...s,headers:N([{Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}}let Sr=class extends F{constructor(){super(...arguments),this.content=new gl(this._client)}create(t,n,s){return this._client.post(M`/containers/${t}/files`,yt({body:n,...s},this._client))}retrieve(t,n,s){const{container_id:r}=n;return this._client.get(M`/containers/${r}/files/${t}`,s)}list(t,n={},s){return this._client.getAPIList(M`/containers/${t}/files`,he,{query:n,...s})}delete(t,n,s){const{container_id:r}=n;return this._client.delete(M`/containers/${r}/files/${t}`,{...s,headers:N([{Accept:"*/*"},s?.headers])})}};Sr.Content=gl;class Ar extends F{constructor(){super(...arguments),this.files=new Sr(this._client)}create(t,n){return this._client.post("/containers",{body:t,...n})}retrieve(t,n){return this._client.get(M`/containers/${t}`,n)}list(t={},n){return this._client.getAPIList("/containers",he,{query:t,...n})}delete(t,n){return this._client.delete(M`/containers/${t}`,{...n,headers:N([{Accept:"*/*"},n?.headers])})}}Ar.Files=Sr;class bl extends F{create(t,n,s){const{include:r,...o}=n;return this._client.post(M`/conversations/${t}/items`,{query:{include:r},body:o,...s})}retrieve(t,n,s){const{conversation_id:r,...o}=n;return this._client.get(M`/conversations/${r}/items/${t}`,{query:o,...s})}list(t,n={},s){return this._client.getAPIList(M`/conversations/${t}/items`,cy,{query:n,...s})}delete(t,n,s){const{conversation_id:r}=n;return this._client.delete(M`/conversations/${r}/items/${t}`,s)}}class Ir extends F{constructor(){super(...arguments),this.items=new bl(this._client)}create(t,n){return this._client.post("/conversations",{body:t,...n})}retrieve(t,n){return this._client.get(M`/conversations/${t}`,n)}update(t,n,s){return this._client.post(M`/conversations/${t}`,{body:n,...s})}delete(t,n){return this._client.delete(M`/conversations/${t}`,n)}}Ir.Items=bl;class yl extends F{create(t,n){const s=!!t.encoding_format;let r=s?t.encoding_format:"base64";s&&ve(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const o=this._client.post("/embeddings",{body:{...t,encoding_format:r},...n});return s?o:(ve(this._client).debug("embeddings/decoding base64 embeddings from base64"),o._thenUnwrap(i=>(i&&i.data&&i.data.forEach(a=>{const l=a.embedding;a.embedding=Oy(l)}),i)))}}class vl extends F{retrieve(t,n,s){const{eval_id:r,run_id:o}=n;return this._client.get(M`/evals/${r}/runs/${o}/output_items/${t}`,s)}list(t,n,s){const{eval_id:r,...o}=n;return this._client.getAPIList(M`/evals/${r}/runs/${t}/output_items`,he,{query:o,...s})}}class Mr extends F{constructor(){super(...arguments),this.outputItems=new vl(this._client)}create(t,n,s){return this._client.post(M`/evals/${t}/runs`,{body:n,...s})}retrieve(t,n,s){const{eval_id:r}=n;return this._client.get(M`/evals/${r}/runs/${t}`,s)}list(t,n={},s){return this._client.getAPIList(M`/evals/${t}/runs`,he,{query:n,...s})}delete(t,n,s){const{eval_id:r}=n;return this._client.delete(M`/evals/${r}/runs/${t}`,s)}cancel(t,n,s){const{eval_id:r}=n;return this._client.post(M`/evals/${r}/runs/${t}`,s)}}Mr.OutputItems=vl;class Er extends F{constructor(){super(...arguments),this.runs=new Mr(this._client)}create(t,n){return this._client.post("/evals",{body:t,...n})}retrieve(t,n){return this._client.get(M`/evals/${t}`,n)}update(t,n,s){return this._client.post(M`/evals/${t}`,{body:n,...s})}list(t={},n){return this._client.getAPIList("/evals",he,{query:t,...n})}delete(t,n){return this._client.delete(M`/evals/${t}`,n)}}Er.Runs=Mr;let wl=class extends F{create(t,n){return this._client.post("/files",yt({body:t,...n},this._client))}retrieve(t,n){return this._client.get(M`/files/${t}`,n)}list(t={},n){return this._client.getAPIList("/files",he,{query:t,...n})}delete(t,n){return this._client.delete(M`/files/${t}`,n)}content(t,n){return this._client.get(M`/files/${t}/content`,{...n,headers:N([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}async waitForProcessing(t,{pollInterval:n=5e3,maxWait:s=1800*1e3}={}){const r=new Set(["processed","error","deleted"]),o=Date.now();let i=await this.retrieve(t);for(;!i.status||!r.has(i.status);)if(await rn(n),i=await this.retrieve(t),Date.now()-o>s)throw new gr({message:`Giving up on waiting for file ${t} to finish processing after ${s} milliseconds.`});return i}};class xl extends F{}let _l=class extends F{run(t,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:t,...n})}validate(t,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:t,...n})}};class Rr extends F{constructor(){super(...arguments),this.graders=new _l(this._client)}}Rr.Graders=_l;class kl extends F{create(t,n,s){return this._client.getAPIList(M`/fine_tuning/checkpoints/${t}/permissions`,rs,{body:n,method:"post",...s})}retrieve(t,n={},s){return this._client.get(M`/fine_tuning/checkpoints/${t}/permissions`,{query:n,...s})}delete(t,n,s){const{fine_tuned_model_checkpoint:r}=n;return this._client.delete(M`/fine_tuning/checkpoints/${r}/permissions/${t}`,s)}}let Tr=class extends F{constructor(){super(...arguments),this.permissions=new kl(this._client)}};Tr.Permissions=kl;class Cl extends F{list(t,n={},s){return this._client.getAPIList(M`/fine_tuning/jobs/${t}/checkpoints`,he,{query:n,...s})}}class Or extends F{constructor(){super(...arguments),this.checkpoints=new Cl(this._client)}create(t,n){return this._client.post("/fine_tuning/jobs",{body:t,...n})}retrieve(t,n){return this._client.get(M`/fine_tuning/jobs/${t}`,n)}list(t={},n){return this._client.getAPIList("/fine_tuning/jobs",he,{query:t,...n})}cancel(t,n){return this._client.post(M`/fine_tuning/jobs/${t}/cancel`,n)}listEvents(t,n={},s){return this._client.getAPIList(M`/fine_tuning/jobs/${t}/events`,he,{query:n,...s})}pause(t,n){return this._client.post(M`/fine_tuning/jobs/${t}/pause`,n)}resume(t,n){return this._client.post(M`/fine_tuning/jobs/${t}/resume`,n)}}Or.Checkpoints=Cl;class Pt extends F{constructor(){super(...arguments),this.methods=new xl(this._client),this.jobs=new Or(this._client),this.checkpoints=new Tr(this._client),this.alpha=new Rr(this._client)}}Pt.Methods=xl;Pt.Jobs=Or;Pt.Checkpoints=Tr;Pt.Alpha=Rr;class $l extends F{}class Pr extends F{constructor(){super(...arguments),this.graderModels=new $l(this._client)}}Pr.GraderModels=$l;class Sl extends F{createVariation(t,n){return this._client.post("/images/variations",yt({body:t,...n},this._client))}edit(t,n){return this._client.post("/images/edits",yt({body:t,...n,stream:t.stream??!1},this._client))}generate(t,n){return this._client.post("/images/generations",{body:t,...n,stream:t.stream??!1})}}class Al extends F{retrieve(t,n){return this._client.get(M`/models/${t}`,n)}list(t){return this._client.getAPIList("/models",rs,t)}delete(t,n){return this._client.delete(M`/models/${t}`,n)}}class Il extends F{create(t,n){return this._client.post("/moderations",{body:t,...n})}}class Ml extends F{create(t,n){return this._client.post("/realtime/client_secrets",{body:t,...n})}}class Lr extends F{constructor(){super(...arguments),this.clientSecrets=new Ml(this._client)}}Lr.ClientSecrets=Ml;function Ly(e,t){return!t||!jy(t)?{...e,output_parsed:null,output:e.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(s=>({...s,parsed:null}))}:n)}:El(e,t)}function El(e,t){const n=e.output.map(r=>{if(r.type==="function_call")return{...r,parsed_arguments:Fy(t,r)};if(r.type==="message"){const o=r.content.map(i=>i.type==="output_text"?{...i,parsed:Dy(t,i.text)}:i);return{...r,content:o}}return r}),s=Object.assign({},e,{output:n});return Object.getOwnPropertyDescriptor(e,"output_text")||Ys(s),Object.defineProperty(s,"output_parsed",{enumerable:!0,get(){for(const r of s.output)if(r.type==="message"){for(const o of r.content)if(o.type==="output_text"&&o.parsed!==null)return o.parsed}return null}}),s}function Dy(e,t){return e.text?.format?.type!=="json_schema"?null:"$parseRaw"in e.text?.format?(e.text?.format).$parseRaw(t):JSON.parse(t)}function jy(e){return!!vr(e.text?.format)}function Ny(e){return e?.$brand==="auto-parseable-tool"}function By(e,t){return e.find(n=>n.type==="function"&&n.name===t)}function Fy(e,t){const n=By(e.tools??[],t.name);return{...t,...t,parsed_arguments:Ny(n)?n.$parseRaw(t.arguments):n?.strict?JSON.parse(t.arguments):null}}function Ys(e){const t=[];for(const n of e.output)if(n.type==="message")for(const s of n.content)s.type==="output_text"&&t.push(s.text);e.output_text=t.join("")}var xt,yn,at,vn,Vo,Jo,Ko,Qo;class Dr extends xr{constructor(t){super(),xt.add(this),yn.set(this,void 0),at.set(this,void 0),vn.set(this,void 0),U(this,yn,t)}static createResponse(t,n,s){const r=new Dr(n);return r._run(()=>r._createOrRetrieveResponse(t,n,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(t,n,s){const r=s?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),m(this,xt,"m",Vo).call(this);let o,i=null;"response_id"in n?(o=await t.responses.retrieve(n.response_id,{stream:!0},{...s,signal:this.controller.signal,stream:!0}),i=n.starting_after??null):o=await t.responses.create({...n,stream:!0},{...s,signal:this.controller.signal}),this._connected();for await(const a of o)m(this,xt,"m",Jo).call(this,a,i);if(o.controller.signal?.aborted)throw new De;return m(this,xt,"m",Ko).call(this)}[(yn=new WeakMap,at=new WeakMap,vn=new WeakMap,xt=new WeakSet,Vo=function(){this.ended||U(this,at,void 0)},Jo=function(n,s){if(this.ended)return;const r=(i,a)=>{(s==null||a.sequence_number>s)&&this._emit(i,a)},o=m(this,xt,"m",Qo).call(this,n);switch(r("event",n),n.type){case"response.output_text.delta":{const i=o.output[n.output_index];if(!i)throw new B(`missing output at index ${n.output_index}`);if(i.type==="message"){const a=i.content[n.content_index];if(!a)throw new B(`missing content at index ${n.content_index}`);if(a.type!=="output_text")throw new B(`expected content to be 'output_text', got ${a.type}`);r("response.output_text.delta",{...n,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const i=o.output[n.output_index];if(!i)throw new B(`missing output at index ${n.output_index}`);i.type==="function_call"&&r("response.function_call_arguments.delta",{...n,snapshot:i.arguments});break}default:r(n.type,n);break}},Ko=function(){if(this.ended)throw new B("stream has ended, this shouldn't happen");const n=m(this,at,"f");if(!n)throw new B("request ended without sending any events");U(this,at,void 0);const s=Hy(n,m(this,yn,"f"));return U(this,vn,s),s},Qo=function(n){let s=m(this,at,"f");if(!s){if(n.type!=="response.created")throw new B(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return s=U(this,at,n.response),s}switch(n.type){case"response.output_item.added":{s.output.push(n.item);break}case"response.content_part.added":{const r=s.output[n.output_index];if(!r)throw new B(`missing output at index ${n.output_index}`);r.type==="message"&&r.content.push(n.part);break}case"response.output_text.delta":{const r=s.output[n.output_index];if(!r)throw new B(`missing output at index ${n.output_index}`);if(r.type==="message"){const o=r.content[n.content_index];if(!o)throw new B(`missing content at index ${n.content_index}`);if(o.type!=="output_text")throw new B(`expected content to be 'output_text', got ${o.type}`);o.text+=n.delta}break}case"response.function_call_arguments.delta":{const r=s.output[n.output_index];if(!r)throw new B(`missing output at index ${n.output_index}`);r.type==="function_call"&&(r.arguments+=n.delta);break}case"response.completed":{U(this,at,n.response);break}}return s},Symbol.asyncIterator)](){const t=[],n=[];let s=!1;return this.on("event",r=>{const o=n.shift();o?o.resolve(r):t.push(r)}),this.on("end",()=>{s=!0;for(const r of n)r.resolve(void 0);n.length=0}),this.on("abort",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),this.on("error",r=>{s=!0;for(const o of n)o.reject(r);n.length=0}),{next:async()=>t.length?{value:t.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((o,i)=>n.push({resolve:o,reject:i})).then(o=>o?{value:o,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=m(this,vn,"f");if(!t)throw new B("stream ended without producing a ChatCompletion");return t}}function Hy(e,t){return Ly(e,t)}class Rl extends F{list(t,n={},s){return this._client.getAPIList(M`/responses/${t}/input_items`,he,{query:n,...s})}}class jr extends F{constructor(){super(...arguments),this.inputItems=new Rl(this._client)}create(t,n){return this._client.post("/responses",{body:t,...n,stream:t.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&Ys(s),s))}retrieve(t,n={},s){return this._client.get(M`/responses/${t}`,{query:n,...s,stream:n?.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&Ys(r),r))}delete(t,n){return this._client.delete(M`/responses/${t}`,{...n,headers:N([{Accept:"*/*"},n?.headers])})}parse(t,n){return this._client.responses.create(t,n)._thenUnwrap(s=>El(s,t))}stream(t,n){return Dr.createResponse(this._client,t,n)}cancel(t,n){return this._client.post(M`/responses/${t}/cancel`,n)}}jr.InputItems=Rl;class Tl extends F{create(t,n,s){return this._client.post(M`/uploads/${t}/parts`,yt({body:n,...s},this._client))}}class Nr extends F{constructor(){super(...arguments),this.parts=new Tl(this._client)}create(t,n){return this._client.post("/uploads",{body:t,...n})}cancel(t,n){return this._client.post(M`/uploads/${t}/cancel`,n)}complete(t,n,s){return this._client.post(M`/uploads/${t}/complete`,{body:n,...s})}}Nr.Parts=Tl;const qy=async e=>{const t=await Promise.allSettled(e),n=t.filter(r=>r.status==="rejected");if(n.length){for(const r of n)console.error(r.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const s=[];for(const r of t)r.status==="fulfilled"&&s.push(r.value);return s};class Ol extends F{create(t,n,s){return this._client.post(M`/vector_stores/${t}/file_batches`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(t,n,s){const{vector_store_id:r}=n;return this._client.get(M`/vector_stores/${r}/file_batches/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}cancel(t,n,s){const{vector_store_id:r}=n;return this._client.post(M`/vector_stores/${r}/file_batches/${t}/cancel`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(t,n,s){const r=await this.create(t,n);return await this.poll(t,r.id,s)}listFiles(t,n,s){const{vector_store_id:r,...o}=n;return this._client.getAPIList(M`/vector_stores/${r}/file_batches/${t}/files`,he,{query:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async poll(t,n,s){const r=N([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:o,response:i}=await this.retrieve(n,{vector_store_id:t},{...s,headers:r}).withResponse();switch(o.status){case"in_progress":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{const l=i.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(a=u)}}await rn(a);break;case"failed":case"cancelled":case"completed":return o}}}async uploadAndPoll(t,{files:n,fileIds:s=[]},r){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const o=r?.maxConcurrency??5,i=Math.min(o,n.length),a=this._client,l=n.values(),u=[...s];async function f(b){for(let h of b){const _=await a.files.create({file:h,purpose:"assistants"},r);u.push(_.id)}}const d=Array(i).fill(l).map(f);return await qy(d),await this.createAndPoll(t,{file_ids:u})}}class Pl extends F{create(t,n,s){return this._client.post(M`/vector_stores/${t}/files`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}retrieve(t,n,s){const{vector_store_id:r}=n;return this._client.get(M`/vector_stores/${r}/files/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}update(t,n,s){const{vector_store_id:r,...o}=n;return this._client.post(M`/vector_stores/${r}/files/${t}`,{body:o,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t,n={},s){return this._client.getAPIList(M`/vector_stores/${t}/files`,he,{query:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}delete(t,n,s){const{vector_store_id:r}=n;return this._client.delete(M`/vector_stores/${r}/files/${t}`,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}async createAndPoll(t,n,s){const r=await this.create(t,n,s);return await this.poll(t,r.id,s)}async poll(t,n,s){const r=N([s?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":s?.pollIntervalMs?.toString()??void 0}]);for(;;){const o=await this.retrieve(n,{vector_store_id:t},{...s,headers:r}).withResponse(),i=o.data;switch(i.status){case"in_progress":let a=5e3;if(s?.pollIntervalMs)a=s.pollIntervalMs;else{const l=o.response.headers.get("openai-poll-after-ms");if(l){const u=parseInt(l);isNaN(u)||(a=u)}}await rn(a);break;case"failed":case"completed":return i}}}async upload(t,n,s){const r=await this._client.files.create({file:n,purpose:"assistants"},s);return this.create(t,{file_id:r.id},s)}async uploadAndPoll(t,n,s){const r=await this.upload(t,n,s);return await this.poll(t,r.id,s)}content(t,n,s){const{vector_store_id:r}=n;return this._client.getAPIList(M`/vector_stores/${r}/files/${t}/content`,rs,{...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}class as extends F{constructor(){super(...arguments),this.files=new Pl(this._client),this.fileBatches=new Ol(this._client)}create(t,n){return this._client.post("/vector_stores",{body:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,n){return this._client.get(M`/vector_stores/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,n,s){return this._client.post(M`/vector_stores/${t}`,{body:n,...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}list(t={},n){return this._client.getAPIList("/vector_stores",he,{query:t,...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,n){return this._client.delete(M`/vector_stores/${t}`,{...n,headers:N([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}search(t,n,s){return this._client.getAPIList(M`/vector_stores/${t}/search`,rs,{body:n,method:"post",...s,headers:N([{"OpenAI-Beta":"assistants=v2"},s?.headers])})}}as.Files=Pl;as.FileBatches=Ol;var Ct,Ll,Mn;class Dl extends F{constructor(){super(...arguments),Ct.add(this)}async unwrap(t,n,s=this._client.webhookSecret,r=300){return await this.verifySignature(t,n,s,r),JSON.parse(t)}async verifySignature(t,n,s=this._client.webhookSecret,r=300){if(typeof crypto>"u"||typeof crypto.subtle.importKey!="function"||typeof crypto.subtle.verify!="function")throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");m(this,Ct,"m",Ll).call(this,s);const o=N([n]).values,i=m(this,Ct,"m",Mn).call(this,o,"webhook-signature"),a=m(this,Ct,"m",Mn).call(this,o,"webhook-timestamp"),l=m(this,Ct,"m",Mn).call(this,o,"webhook-id"),u=parseInt(a,10);if(isNaN(u))throw new Nt("Invalid webhook timestamp format");const f=Math.floor(Date.now()/1e3);if(f-u>r)throw new Nt("Webhook timestamp is too old");if(u>f+r)throw new Nt("Webhook timestamp is too new");const d=i.split(" ").map(g=>g.startsWith("v1,")?g.substring(3):g),b=s.startsWith("whsec_")?Buffer.from(s.replace("whsec_",""),"base64"):Buffer.from(s,"utf-8"),h=l?`${l}.${a}.${t}`:`${a}.${t}`,_=await crypto.subtle.importKey("raw",b,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const g of d)try{const A=Buffer.from(g,"base64");if(await crypto.subtle.verify("HMAC",_,A,new TextEncoder().encode(h)))return}catch{continue}throw new Nt("The given webhook signature does not match the expected signature")}}Ct=new WeakSet,Ll=function(t){if(typeof t!="string"||t.length===0)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},Mn=function(t,n){if(!t)throw new Error("Headers are required");const s=t.get(n);if(s==null)throw new Error(`Missing required header: ${n}`);return s};var Zs,Br,En,jl;class X{constructor({baseURL:t=wt("OPENAI_BASE_URL"),apiKey:n=wt("OPENAI_API_KEY"),organization:s=wt("OPENAI_ORG_ID")??null,project:r=wt("OPENAI_PROJECT_ID")??null,webhookSecret:o=wt("OPENAI_WEBHOOK_SECRET")??null,...i}={}){if(Zs.add(this),En.set(this,void 0),this.completions=new ml(this),this.chat=new Cr(this),this.embeddings=new yl(this),this.files=new wl(this),this.images=new Sl(this),this.audio=new an(this),this.moderations=new Il(this),this.models=new Al(this),this.fineTuning=new Pt(this),this.graders=new Pr(this),this.vectorStores=new as(this),this.webhooks=new Dl(this),this.beta=new ln(this),this.batches=new ul(this),this.uploads=new Nr(this),this.responses=new jr(this),this.realtime=new Lr(this),this.conversations=new Ir(this),this.evals=new Er(this),this.containers=new Ar(this),n===void 0)throw new B("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const a={apiKey:n,organization:s,project:r,webhookSecret:o,...i,baseURL:t||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&Hb())throw new B(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=a.baseURL,this.timeout=a.timeout??Br.DEFAULT_TIMEOUT,this.logger=a.logger??console;const l="warn";this.logLevel=l,this.logLevel=Oo(a.logLevel,"ClientOptions.logLevel",this)??Oo(wt("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??l,this.fetchOptions=a.fetchOptions,this.maxRetries=a.maxRetries??2,this.fetch=a.fetch??Vb(),U(this,En,Kb),this._options=a,this.apiKey=typeof n=="string"?n:"Missing Key",this.organization=s,this.project=r,this.webhookSecret=o}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:n}){}async authHeaders(t){return N([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return ey(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${_t}`}defaultIdempotencyKey(){return`stainless-node-retry-${fa()}`}makeStatusError(t,n,s,r){return _e.generate(t,n,s,r)}async _callApiKey(){const t=this._options.apiKey;if(typeof t!="function")return!1;let n;try{n=await t()}catch(s){throw s instanceof B?s:new B(`Failed to get token from 'apiKey' function: ${s.message}`,{cause:s})}if(typeof n!="string"||!n)throw new B(`Expected 'apiKey' function argument to return a string but it returned ${n}`);return this.apiKey=n,!0}buildURL(t,n,s){const r=!m(this,Zs,"m",jl).call(this)&&s||this.baseURL,o=Db(t)?new URL(t):new URL(r+(r.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),i=this.defaultQuery();return jb(i)||(n={...i,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(o.search=this.stringifyQuery(n)),o.toString()}async prepareOptions(t){await this._callApiKey()}async prepareRequest(t,{url:n,options:s}){}get(t,n){return this.methodRequest("get",t,n)}post(t,n){return this.methodRequest("post",t,n)}patch(t,n){return this.methodRequest("patch",t,n)}put(t,n){return this.methodRequest("put",t,n)}delete(t,n){return this.methodRequest("delete",t,n)}methodRequest(t,n,s){return this.request(Promise.resolve(s).then(r=>({method:t,path:n,...r})))}request(t,n=null){return new ss(this,this.makeRequest(t,n,void 0))}async makeRequest(t,n,s){const r=await t,o=r.maxRetries??this.maxRetries;n==null&&(n=o),await this.prepareOptions(r);const{req:i,url:a,timeout:l}=await this.buildRequest(r,{retryCount:o-n});await this.prepareRequest(i,{url:a,options:r});const u="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),f=s===void 0?"":`, retryOf: ${s}`,d=Date.now();if(ve(this).debug(`[${u}] sending request`,dt({retryOfRequestLogID:s,method:r.method,url:a,options:r,headers:i.headers})),r.signal?.aborted)throw new De;const b=new AbortController,h=await this.fetchWithTimeout(a,i,l,b).catch(qs),_=Date.now();if(h instanceof globalThis.Error){const $=`retrying, ${n} attempts remaining`;if(r.signal?.aborted)throw new De;const C=Hs(h)||/timed? ?out/i.test(String(h)+("cause"in h?String(h.cause):""));if(n)return ve(this).info(`[${u}] connection ${C?"timed out":"failed"} - ${$}`),ve(this).debug(`[${u}] connection ${C?"timed out":"failed"} (${$})`,dt({retryOfRequestLogID:s,url:a,durationMs:_-d,message:h.message})),this.retryRequest(r,n,s??u);throw ve(this).info(`[${u}] connection ${C?"timed out":"failed"} - error; no more retries left`),ve(this).debug(`[${u}] connection ${C?"timed out":"failed"} (error; no more retries left)`,dt({retryOfRequestLogID:s,url:a,durationMs:_-d,message:h.message})),C?new gr:new ts({cause:h})}const g=[...h.headers.entries()].filter(([$])=>$==="x-request-id").map(([$,C])=>", "+$+": "+JSON.stringify(C)).join(""),A=`[${u}${f}${g}] ${i.method} ${a} ${h.ok?"succeeded":"failed"} with status ${h.status} in ${_-d}ms`;if(!h.ok){const $=await this.shouldRetry(h);if(n&&$){const J=`retrying, ${n} attempts remaining`;return await Jb(h.body),ve(this).info(`${A} - ${J}`),ve(this).debug(`[${u}] response error (${J})`,dt({retryOfRequestLogID:s,url:h.url,status:h.status,headers:h.headers,durationMs:_-d})),this.retryRequest(r,n,s??u,h.headers)}const C=$?"error; no more retries left":"error; not retryable";ve(this).info(`${A} - ${C}`);const z=await h.text().catch(J=>qs(J).message),Y=Fb(z),ne=Y?void 0:z;throw ve(this).debug(`[${u}] response error (${C})`,dt({retryOfRequestLogID:s,url:h.url,status:h.status,headers:h.headers,message:ne,durationMs:Date.now()-d})),this.makeStatusError(h.status,Y,ne,h.headers)}return ve(this).info(A),ve(this).debug(`[${u}] response start`,dt({retryOfRequestLogID:s,url:h.url,status:h.status,headers:h.headers,durationMs:_-d})),{response:h,options:r,controller:b,requestLogID:u,retryOfRequestLogID:s,startTime:d}}getAPIList(t,n,s){return this.requestAPIList(n,{method:"get",path:t,...s})}requestAPIList(t,n){const s=this.makeRequest(n,null,void 0);return new uy(this,s,t)}async fetchWithTimeout(t,n,s,r){const{signal:o,method:i,...a}=n||{};o&&o.addEventListener("abort",()=>r.abort());const l=setTimeout(()=>r.abort(),s),u=globalThis.ReadableStream&&a.body instanceof globalThis.ReadableStream||typeof a.body=="object"&&a.body!==null&&Symbol.asyncIterator in a.body,f={signal:r.signal,...u?{duplex:"half"}:{},method:"GET",...a};i&&(f.method=i.toUpperCase());try{return await this.fetch.call(void 0,t,f)}finally{clearTimeout(l)}}async shouldRetry(t){const n=t.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:t.status===408||t.status===409||t.status===429||t.status>=500}async retryRequest(t,n,s,r){let o;const i=r?.get("retry-after-ms");if(i){const l=parseFloat(i);Number.isNaN(l)||(o=l)}const a=r?.get("retry-after");if(a&&!o){const l=parseFloat(a);Number.isNaN(l)?o=Date.parse(a)-Date.now():o=l*1e3}if(!(o&&0<=o&&o<60*1e3)){const l=t.maxRetries??this.maxRetries;o=this.calculateDefaultRetryTimeoutMillis(n,l)}return await rn(o),this.makeRequest(t,n-1,s)}calculateDefaultRetryTimeoutMillis(t,n){const o=n-t,i=Math.min(.5*Math.pow(2,o),8),a=1-Math.random()*.25;return i*a*1e3}async buildRequest(t,{retryCount:n=0}={}){const s={...t},{method:r,path:o,query:i,defaultBaseURL:a}=s,l=this.buildURL(o,i,a);"timeout"in s&&Bb("timeout",s.timeout),s.timeout=s.timeout??this.timeout;const{bodyHeaders:u,body:f}=this.buildBody({options:s}),d=await this.buildHeaders({options:t,method:r,bodyHeaders:u,retryCount:n});return{req:{method:r,headers:d,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&f instanceof globalThis.ReadableStream&&{duplex:"half"},...f&&{body:f},...this.fetchOptions??{},...s.fetchOptions??{}},url:l,timeout:s.timeout}}async buildHeaders({options:t,method:n,bodyHeaders:s,retryCount:r}){let o={};this.idempotencyHeader&&n!=="get"&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),o[this.idempotencyHeader]=t.idempotencyKey);const i=N([o,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...zb(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(t),this._options.defaultHeaders,s,t.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:t,headers:n}}){if(!t)return{bodyHeaders:void 0,body:void 0};const s=N([n]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||typeof t=="string"&&s.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:typeof t=="object"&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&typeof t.next=="function")?{bodyHeaders:void 0,body:$a(t)}:m(this,En,"f").call(this,{body:t,headers:s})}}Br=X,En=new WeakMap,Zs=new WeakSet,jl=function(){return this.baseURL!=="https://api.openai.com/v1"};X.OpenAI=Br;X.DEFAULT_TIMEOUT=6e5;X.OpenAIError=B;X.APIError=_e;X.APIConnectionError=ts;X.APIConnectionTimeoutError=gr;X.APIUserAbortError=De;X.NotFoundError=ga;X.ConflictError=ba;X.RateLimitError=va;X.BadRequestError=pa;X.AuthenticationError=ha;X.InternalServerError=wa;X.PermissionDeniedError=ma;X.UnprocessableEntityError=ya;X.InvalidWebhookSignatureError=Nt;X.toFile=gy;X.Completions=ml;X.Chat=Cr;X.Embeddings=yl;X.Files=wl;X.Images=Sl;X.Audio=an;X.Moderations=Il;X.Models=Al;X.FineTuning=Pt;X.Graders=Pr;X.VectorStores=as;X.Webhooks=Dl;X.Beta=ln;X.Batches=ul;X.Uploads=Nr;X.Responses=jr;X.Realtime=Lr;X.Conversations=Ir;X.Evals=Er;X.Containers=Ar;function Uy(){const e=D([]),t=D(null),n=Yt("isLoading",!1),s=D(null);Yt("chatHistory",e);const{aiSettings:r,enabledPrompts:o}=nr(),i=G(()=>e.value.some(R=>R.messages.some(S=>S.isStreaming))),a=()=>{let R=!1;e.value.forEach(S=>{S.messages.forEach(T=>{T.isStreaming&&(R=!0,T.isStreaming=!1,T.content.trim()||(T.content="请求被中断"))})}),R&&(n.value=!1)},l=`<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>示例页面</title>
</head>
<body>
    <div class="container">
        <h1>欢迎使用AI代码编辑器</h1>
        <p>这是一个示例HTML页面，您可以在左侧与AI对话来生成或修改代码。</p>
    </div>
</body>
</html>`,u=G(()=>e.value.length===0?[{id:-1,title:"新对话",messages:[],createdAt:new Date,currentCode:l,codeHistory:[{code:l,timestamp:Date.now(),title:"初始代码"}],currentHistoryIndex:0}]:e.value),f=G(()=>t.value!==null?t.value:e.value.length===0?-1:null),d=G(()=>t.value===null?[]:e.value.find(S=>S.id===t.value)?.messages||[]),b=()=>{const R=e.value.length>0?Math.max(0,...e.value.map(Z=>Z.id))+1:1,S={id:R,title:"新对话",messages:[],createdAt:new Date,currentCode:l,codeHistory:[{code:l,timestamp:Date.now(),title:"初始代码"}],currentHistoryIndex:0},T=e.value.find(Z=>Z.title==="新对话");return T&&e.value.splice(e.value.indexOf(T),1),e.value.unshift(S),t.value=R,S},h=R=>{R===-1?t.value=null:t.value=R},_=(R,S=[])=>{let T=e.value.find(O=>O.id===t.value);T||(T=b());const Z={id:Date.now().toString(),role:"user",content:R,images:S,timestamp:new Date};return T.messages.push(Z),T.messages.length===1&&(T.title=R.slice(0,30)+(R.length>30?"...":"")),Z},g=()=>{const R=e.value.find(T=>T.id===t.value);if(!R)return console.error("Cannot add assistant message without an active chat."),null;const S={id:Date.now().toString()+"_ai",role:"assistant",content:"",timestamp:new Date,isStreaming:!0};return R.messages.push(S),S},A=(R,S,T=!1)=>{const Z=e.value.find(O=>O.id===t.value);if(Z){const O=Z.messages.find(j=>j.id===R);O&&(O.content=S,T&&(O.isStreaming=!1))}};return{displayedChatHistory:u,activeChatId:f,currentMessages:d,isLoading:n,hasStreamingMessage:i,createNewChat:b,selectChat:h,addUserMessage:_,sendAIRequest:async(R,S,T,Z)=>{n.value=!0,s.value=new AbortController;try{const O={apiKey:r.value.apiKey,baseURL:r.value.baseUrl,dangerouslyAllowBrowser:!0},j=new X(O),q=[{type:"text",text:R}];S.length>0&&S.forEach(w=>{q.push({type:"image_url",image_url:{url:w}})});const k=g(),p=[];o.value.forEach(w=>{p.push({role:w.role,content:w.content})}),T&&T.trim()&&p.push({role:"user",content:`当前编辑器中的代码：
\`\`\`
${T}
\`\`\``}),p.push({role:"user",content:q});const y=await j.chat.completions.create({model:"gemini-2.5-flash",messages:p,stream:!0},{signal:s.value.signal});let P="";for await(const w of y){const E=w.choices[0]?.delta?.content||"";E&&(P+=E,A(k.id,P),Z&&Z(P))}A(k.id,P,!0)}catch(O){if(O.name==="AbortError"){console.log("AI请求被用户取消");const k=e.value.find(p=>p.id===t.value);if(k){const p=k.messages.findIndex(y=>y.isStreaming);p!==-1&&k.messages.splice(p,1)}return}console.error("AI请求失败:",O);const j={id:Date.now().toString()+"_error",role:"assistant",content:"抱歉，AI请求失败了，请稍后重试。错误信息："+O.message,timestamp:new Date},q=e.value.find(k=>k.id===t.value);if(q){const k=q.messages.findIndex(p=>p.isStreaming);k!==-1&&q.messages.splice(k,1),q.messages.push(j)}}finally{n.value=!1,s.value=null}},stopStreaming:()=>{s.value&&s.value.abort(),e.value.forEach(R=>{R.messages.forEach(S=>{S.isStreaming&&(S.isStreaming=!1,S.content.trim()||(S.content="请求被用户终止"))})}),n.value=!1,s.value=null},clearCurrentChat:()=>{const R=e.value.find(S=>S.id===t.value);R&&(R.messages=[],R.title="新对话")},deleteChat:R=>{const S=e.value.findIndex(T=>T.id===R);S!==-1&&(e.value.splice(S,1),t.value===R&&(e.value.length>0?t.value=e.value[0].id:t.value=null))},deleteMessage:R=>{const S=e.value.find(T=>T.id===t.value);if(S){const T=S.messages.findIndex(Z=>Z.id===R);T!==-1&&S.messages.splice(T,1)}},retryMessage:(R,S,T=[])=>{const Z=e.value.find(O=>O.id===t.value);if(Z){const O=Z.messages.findIndex(j=>j.id===R);if(O!==-1)return Z.messages.splice(O),{shouldResend:!0,message:S,images:T}}return{shouldResend:!1}},updateCurrentCode:(R,S)=>{const T=e.value.find(Z=>Z.id===R);T&&(T.currentCode=S)},getCurrentCode:R=>e.value.find(T=>T.id===R)?.currentCode||l,getCurrentChatHistoryManager:R=>{const S=e.value.find(T=>T.id===R);return S?{history:G({get:()=>S.codeHistory,set:T=>{S.codeHistory=T}}),currentHistoryIndex:G({get:()=>S.currentHistoryIndex,set:T=>{S.currentHistoryIndex=T}}),canUndo:G(()=>S.currentHistoryIndex>0),canRedo:G(()=>S.currentHistoryIndex<S.codeHistory.length-1),selectHistoryItem:T=>{T>=0&&T<S.codeHistory.length&&(S.currentHistoryIndex=T,S.currentCode=S.codeHistory[T].code)}}:null},checkAndCleanupStreamingMessages:a}}function Wy(e){const t=e?.currentCode||D(`<!DOCTYPE html>
<html lang="zh-CN">
<head>  
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>示例页面</title>
</head>
<body>
    <div class="container">
        <h1>欢迎使用AI代码编辑器</h1>
        <p>这是一个示例HTML页面，您可以在左侧与AI对话来生成或修改代码。</p>
    </div>
</body>
</html>`),n=D(!1),s=D("index.html"),r=p=>{const y=p.match(/<title[^>]*>([^<]*)<\/title>/i);if(y&&y[1])return y[1].trim();const P=p.match(/<h1[^>]*>([^<]*)<\/h1>/i);return P&&P[1]?P[1].trim():"代码版本"},o=e?.history||D([{title:r(t.value),code:t.value,timestamp:Date.now()}]),i=e?.currentHistoryIndex||D(0),a=50,l=G(()=>i.value>0),u=G(()=>i.value<o.value.length-1),f=(p,y)=>{if(o.value[i.value]?.code===p)return;i.value<o.value.length-1&&(o.value=o.value.slice(0,i.value+1));const P={code:p,timestamp:Date.now(),title:y||r(p)};o.value.push(P),i.value=o.value.length-1,o.value.length>a&&(o.value.shift(),i.value--)},d=G(()=>{const p=t.value.toLowerCase();return p.includes("<html")||p.includes("<!doctype html")}),b=()=>{!n.value&&!d.value||(n.value=!n.value)},h=D(""),_=D(!1),g=D(""),A=50,$=p=>{if(/-------\s*SEARCH[\s\S]*?=======([\s\S]*?)\+\+\+\+\+\+\+\s*REPLACE/.test(p)){console.log("检测到差异格式代码，准备应用差异:",p);const P=new CustomEvent("applyCodeDiff",{detail:{diffContent:p}});return window.dispatchEvent(P),!0}return!1},C=D(0),z=D(new Set),Y=p=>{const y=p.substring(C.value);if(C.value=p.length,!!y){if(g.value+=y,g.value.length>A&&(g.value=g.value.substring(g.value.length-A)),!_.value){const P=g.value.match(/```(\w+)?/);if(P){_.value=!0,h.value="",console.log("检测到代码块开始");const w=p.indexOf(P[0]);if(w!==-1){const E=p.substring(w),L=E.substring(3).match(/```/);if(L){const W=E.substring(0,L.index+6);ne(W),_.value=!1,h.value="",g.value="",console.log("代码块在同一次更新中完成")}else h.value=E}g.value="";return}}if(_.value)if(g.value.includes("```")){const P=g.value.indexOf("```"),w=y.substring(0,y.length-(g.value.length-P-3)),E=h.value+w;console.log("检测到代码块结束，完整代码块长度:",E.length),ne(E),_.value=!1,h.value="",g.value="";return}else h.value+=y}},ne=p=>{console.log("处理完整代码块:",{length:p.length,fullCodeBlock:p});const y=p.match(/^```(\w+)?[\r\n]?([\s\S]*?)[\r\n]?```$/m);if(y){const P=y[1]||"",w=y[2]||"";console.log("解析出代码块:",{language:P,length:w.length}),$(w)||(P==="html"||P===""||w.includes("<!DOCTYPE")||w.includes("<html"))&&J(w.trim())}else console.warn("无法解析代码块格式:",p)},ae=()=>{_.value=!1,h.value="",g.value="",C.value=0,z.value.clear(),console.log("流式监听器状态已重置")},J=p=>{const y=btoa(encodeURIComponent(p)).substring(0,50);if(z.value.has(y))return console.log("HTML内容已处理过，跳过重复处理"),!1;if(p.includes("<html")||p.includes("<!DOCTYPE")){const P=p;return t.value!==P&&(t.value=P,f(P),z.value.add(y),console.log("更新了完整HTML文档")),!0}else if(p.includes("<")&&p.includes(">")){const P=`<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI生成的页面</title>
</head>
<body>
${p}
</body>
</html>`;return t.value!==P&&(t.value=P,f(P),z.value.add(y),console.log("更新了包装后的HTML文档")),!0}return!1},ee=(p,y)=>{if(console.log("应用代码到编辑器:",{language:y,codeLength:p.length}),$(p)){console.log("应用了差异格式代码");return}y==="html"||y===""||p.includes("<!DOCTYPE")||p.includes("<html")?J(p.trim()):y==="css"?R(p.trim()):y==="javascript"||y==="js"?S(p.trim()):p.includes("<")&&p.includes(">")?J(p.trim()):console.log("无法识别的代码类型，跳过应用")},se=p=>{Y(p)},R=p=>{let y=t.value;const P=y,w=/<style[^>]*>([\s\S]*?)<\/style>/i;if(w.test(y))y=y.replace(w,"<style>\\n"+p+"\\n</style>");else{const E=/<\/head>/i;E.test(y)&&(y=y.replace(E,"    <style>\\n"+p+"\\n    </style>\\n</head>"))}y!==P&&(t.value=y,f(y))},S=p=>{let y=t.value;const P=y,w=/<script[^>]*>([\s\S]*?)<\/script>/i;if(w.test(y))y=y.replace(w,"<script>\\n"+p+"\\n<\/script>");else{const E="</body>";y.includes(E)&&(y=y.replace(E,"    <script>\\n"+p+"\\n    <\/script>\\n"+E))}y!==P&&(t.value=y,f(y))},T=()=>{if(l.value){const p=i.value-1;i.value=p,t.value=o.value[p].code}},Z=()=>{if(u.value){const p=i.value+1;i.value=p,t.value=o.value[p].code}},O=()=>{window.alert("历史记录功能将在未来版本中实现")},j=p=>{p>=0&&p<o.value.length&&(i.value=p,t.value=o.value[p].code)},q=G(()=>i.value+1),k=G(()=>o.value.length);return{currentCode:t,isPreviewMode:n,editorTitle:s,isHtmlContent:d,canUndo:l,canRedo:u,togglePreview:b,extractHtmlFromMarkdown:se,updateCssInHtml:R,updateJsInHtml:S,handleUndo:T,handleRedo:Z,showHistory:O,addToHistory:f,history:o,currentHistoryIndex:i,currentVersion:q,totalHistoryCount:k,selectHistoryItem:j,generateHistoryTitle:r,monitorStreamContent:Y,detectAndApplyDiff:$,handleCompleteCodeBlock:ne,resetStreamMonitor:ae,isInCodeBlock:_,codeBlockBuffer:h,detectionBuffer:g,applyCodeFromMarkdown:ee}}function wn(){return{previewIcon:`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
    </svg>`,codeIcon:`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
    </svg>`,copyIcon:`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
    </svg>`,checkIcon:`<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
    </svg>`}}const Es=e=>e.replace(/[&<>'"]/g,t=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[t]||t);function zy(){let e=null,t=null;return{renderMarkdown:a=>{try{const l=new hs.Renderer,u=wn();return l.code=({text:f,lang:d})=>{const b=d||"text",h=b.toLowerCase()==="html";let _;if(b&&b!=="text"&&Wr.getLanguage(b))try{_=Wr.highlight(f,{language:b}).value}catch(g){console.warn("代码高亮失败:",g),_=Es(f)}else _=Es(f);return`<div class="code-block mb-4">
          <div class="code-header bg-gray-100 text-gray-700 px-4 py-2 flex items-center justify-between border border-gray-200 rounded-t-md">
            <div class="flex items-center gap-2">
              <button onclick="toggleCodeFold(this)" class="fold-btn text-gray-500 hover:text-gray-700 transition-colors" title="折叠/展开代码">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor">
                  <path d="M4.5 3L7.5 6L4.5 9" stroke="currentColor" stroke-width="1.5" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </button>
              <span class="text-sm font-medium uppercase">${b}</span>
            </div>
            <div class="flex items-center gap-1">
              ${h?`<button onclick="previewCode(this, '${b}')" class="code-action-btn p-1.5 rounded text-gray-500 hover:text-gray-700 hover:bg-gray-200 transition-all" title="在编辑器中预览">
                ${u.previewIcon}
              </button>`:""}
              <button onclick="applyCode(this, '${b}')" class="code-action-btn p-1.5 rounded text-gray-500 hover:text-gray-700 hover:bg-gray-200 transition-all" title="应用到编辑器">
                ${u.codeIcon}
              </button>
              <button onclick="copyCode(this)" class="code-action-btn p-1.5 rounded text-gray-500 hover:text-gray-700 hover:bg-gray-200 transition-all" title="复制代码">
                ${u.copyIcon}
              </button>
            </div>
          </div>
          <div class="code-content">
            <pre class="bg-gray-50 text-gray-800 p-0! border border-t-0 border-gray-200 rounded-b-md overflow-x-auto max-h-[500px] overflow-y-auto"><code class="hljs language-${b}">${_}</code></pre>
          </div>
        </div>`},l.codespan=({text:f})=>`<code class="bg-gray-100 text-red-600 px-2 py-1 rounded text-sm font-mono">${Es(f)}</code>`,hs.setOptions({renderer:l,breaks:!0,gfm:!0}),hs(a)}catch(l){return console.error("Markdown渲染错误:",l),a.replace(/\n/g,"<br>")}},formatTime:a=>{const l=new Date,u=typeof a=="string"?new Date(a):a,f=l.getTime()-u.getTime(),d=Math.floor(f/6e4),b=Math.floor(f/36e5);return d<1?"刚刚":d<60?`${d}分钟前`:b<24?`${b}小时前`:u.toLocaleDateString("zh-CN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},setupCopyCodeFunction:()=>{window.copyCode=function(a){const u=a.closest(".code-block")?.querySelector("code")?.textContent;if(!u)return;const f=wn();if(navigator.clipboard)navigator.clipboard.writeText(u).then(()=>{const d=a.innerHTML;a.innerHTML=f.checkIcon,a.style.color="#10b981",setTimeout(()=>{a.innerHTML=d,a.style.color=""},2e3)}).catch(d=>{console.error("复制失败:",d)});else{const d=document.createElement("textarea");d.value=u,document.body.appendChild(d),d.select(),document.execCommand("copy"),document.body.removeChild(d);const b=a.innerHTML;a.innerHTML="✓",a.style.color="#10b981",setTimeout(()=>{a.innerHTML=b,a.style.color=""},2e3)}},window.previewCode=function(a,l){const f=a.closest(".code-block")?.querySelector("code")?.textContent;if(f&&e){e(f,l);const d=wn(),b=a.innerHTML;a.innerHTML=d.checkIcon,a.style.color="#10b981",setTimeout(()=>{a.innerHTML=b,a.style.color=""},1500)}},window.applyCode=function(a,l){const f=a.closest(".code-block")?.querySelector("code")?.textContent;if(f&&t){t(f,l);const d=wn(),b=a.innerHTML;a.innerHTML=d.checkIcon,a.style.color="#10b981",setTimeout(()=>{a.innerHTML=b,a.style.color=""},2e3)}},window.toggleCodeFold=function(a){const u=a.closest(".code-block")?.querySelector(".code-content"),f=a.querySelector("svg");u&&f&&(u.style.display==="none"?(u.style.display="block",f.style.transform="rotate(90deg)"):(u.style.display="none",f.style.transform="rotate(0deg)"))}},setCodePreviewHandler:a=>{e=a},setCodeApplyHandler:a=>{t=a}}}function Vy(){const e=D(!1),t=D(window.innerWidth),n=G(()=>t.value<768),s=()=>{e.value=!e.value},r=()=>{t.value=window.innerWidth,n.value&&!e.value&&(e.value=!0)};return Qe(()=>{window.addEventListener("resize",r),n.value&&(e.value=!0)}),sn(()=>{window.removeEventListener("resize",r)}),{sidebarCollapsed:e,toggleSidebar:s,isMobile:n}}function Jy(e="gemini-2.5-flash"){const t=D(e),n=D([{label:"Gemini 2.5 Flash",value:"gemini-2.5-flash"},{label:"Gemini 2.5 Pro",value:"gemini-2.5-pro"},{label:"Gemini 1.5 Pro",value:"gemini-1.5-pro"},{label:"GPT-4o",value:"gpt-4o"},{label:"GPT-4o Mini",value:"gpt-4o-mini"}]);return{selectedModel:t,availableModels:n,selectModel:o=>{t.value=o,console.log("模型切换为:",o)},getModelLabel:o=>{const i=n.value.find(a=>a.value===o);return i?i.label:"Gemini 2.5 Flash"}}}const Ky={class:"w-full h-screen flex bg-gray-50"},Qy={class:"flex-1 flex flex-col overflow-hidden"},Xy={class:"flex flex-1 min-w-0 overflow-hidden"},Gy=me({__name:"App",setup(e){const{displayedChatHistory:t,activeChatId:n,currentMessages:s,isLoading:r,createNewChat:o,selectChat:i,addUserMessage:a,sendAIRequest:l,stopStreaming:u,clearCurrentChat:f,deleteChat:d,deleteMessage:b,retryMessage:h,updateCurrentCode:_,getCurrentCode:g,getCurrentChatHistoryManager:A,checkAndCleanupStreamingMessages:$}=Uy(),C=D(""),z=G({get:()=>{if(n.value===null)return[];const V=A(n.value);return V?V.history.value:[]},set:V=>{if(n.value!==null){const oe=A(n.value);oe&&(oe.history.value=V)}}}),Y=G({get:()=>{if(n.value===null)return 0;const V=A(n.value);return V?V.currentHistoryIndex.value:0},set:V=>{if(n.value!==null){const oe=A(n.value);oe&&(oe.currentHistoryIndex.value=V)}}}),{isPreviewMode:ne,editorTitle:ae,extractHtmlFromMarkdown:J,updateCssInHtml:ee,updateJsInHtml:se,resetStreamMonitor:R,history:S,currentHistoryIndex:T,canUndo:Z,canRedo:O,handleUndo:j,handleRedo:q,selectHistoryItem:k,addToHistory:p,applyCodeFromMarkdown:y}=Wy({history:z,currentHistoryIndex:Y,currentCode:C}),{renderMarkdown:P,formatTime:w,setupCopyCodeFunction:E,setCodePreviewHandler:L,setCodeApplyHandler:W}=zy(),{sidebarCollapsed:ce,toggleSidebar:re}=Vy(),{selectedModel:fe,selectModel:qe}=Jy(),Oe=D(),ct=D(),Lt=V=>{window.confirm("确定要删除这个对话吗？")&&d(V)},Be=async V=>{!V.message.trim()&&V.images.length===0||(R(),a(V.message,V.images),Oe.value?.scrollToBottom(),await l(V.message,V.images,C.value,oe=>{J(oe);const ke=oe.match(/```css\s*([\s\S]*?)```/i);ke&&ke[1]&&ee(ke[1].trim());const Ge=oe.match(/```javascript\s*([\s\S]*?)```/i);Ge&&Ge[1]&&se(Ge[1].trim()),Oe.value?.scrollToBottom()}))},Dt=()=>{u()},Nl=V=>{b(V.id)},Bl=async V=>{const oe=s.value,ke=oe.findIndex(Ge=>Ge.id===V.id);if(ke>0){const Ge=oe[ke-1];if(Ge.role==="user"){const ls=h(V.id,Ge.content,Ge.images||[]);ls.shouldResend&&(R(),await l(ls.message,ls.images,C.value,us=>{J(us);const cs=us.match(/```css\s*([\s\S]*?)```/i);cs&&cs[1]&&ee(cs[1].trim());const ds=us.match(/```javascript\s*([\s\S]*?)```/i);ds&&ds[1]&&se(ds[1].trim()),Oe.value?.scrollToBottom()}))}}},Fr=V=>{const{diffContent:oe}=V.detail;if(console.log("收到差异应用事件:",oe),ct.value)try{const ke=ct.value.editorRef;ke&&ke.applyDiff?(ke.applyDiff(oe),console.log("差异应用成功")):console.warn("无法访问编辑器的 applyDiff 方法")}catch(ke){console.error("应用差异时出错:",ke)}};return window.addEventListener("diffModeEnded",V=>{const{finalCode:oe}=V.detail;console.log("差异模式结束，保存代码到历史记录:",oe)}),Ts("keydown",V=>{V.key==="Tab"&&(V.preventDefault(),V.stopPropagation(),re())}),Qe(()=>{$(),E(),L((V,oe)=>{oe.toLowerCase()==="html"&&(C.value=V,ne.value||(ne.value=!ne.value))}),W((V,oe)=>{console.log("应用代码被调用:",{code:V.substring(0,100),lang:oe}),y(V,oe)}),i(t.value[0].id),window.addEventListener("applyCodeDiff",Fr)}),Ke(n,V=>{V!==null?C.value=g(V):C.value=""},{immediate:!0}),Ke(C,V=>{V&&n.value!==null&&_(n.value,V)}),sn(()=>{window.removeEventListener("applyCodeDiff",Fr),window.removeEventListener("diffModeEnded",V=>{const{finalCode:oe}=V.detail;console.log("清理监听器 - 差异模式结束:",oe)})}),(V,oe)=>(v(),x("div",Ky,[H(bf,{collapsed:I(ce),"chat-history":I(t),"current-chat-id":I(n),onToggle:I(re),onNewChat:I(o),onSelectChat:I(i),onDeleteChat:Lt},null,8,["collapsed","chat-history","current-chat-id","onToggle","onNewChat","onSelectChat"]),c("div",Qy,[H(sf,{title:"AI Chat & Code Editor"}),c("div",Xy,[H(gp,{ref_key:"chatWindowRef",ref:Oe,messages:I(s),"is-loading":I(r),"selected-model":I(fe),"render-markdown":I(P),"format-time":I(w),onSendMessage:Be,onStopStreaming:Dt,onDeleteMessage:Nl,onRetryMessage:Bl,onModelChange:I(qe),onClearChat:I(f)},null,8,["messages","is-loading","selected-model","render-markdown","format-time","onModelChange","onClearChat"]),H(Pb,{ref_key:"codeEditorRef",ref:ct,title:I(ae),"current-code":C.value,"onUpdate:currentCode":oe[0]||(oe[0]=ke=>C.value=ke),"is-preview-mode":I(ne),"can-undo":I(Z),"can-redo":I(O),history:I(S),"current-history-index":I(T),addToHistory:I(p),onTogglePreview:oe[1]||(oe[1]=ke=>ne.value=!I(ne)),onUndo:I(j),onRedo:I(q),onHistory:oe[2]||(oe[2]=ke=>console.log("显示历史")),onHistorySelect:I(k)},null,8,["title","current-code","is-preview-mode","can-undo","can-redo","history","current-history-index","addToHistory","onUndo","onRedo","onHistorySelect"])])])]))}}),Yy=Xe(Gy,[["__scopeId","data-v-bd0c46df"]]);Gl(Yy).mount("#app");
